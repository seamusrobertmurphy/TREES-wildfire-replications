<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2&nbsp; Burn Area – IPCC Fire Emissions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../references/index.html" rel="next">
<link href="../01-burn-area/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dcd723bd3e2d8e65306aa707aebc1039.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1d21bedf07900770407f0b9fb3305521.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="2&nbsp; Burn Area – IPCC Fire Emissions">
<meta property="og:description" content="">
<meta property="og:site_name" content="IPCC Fire Emissions">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../02-veg-classes/index.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Burn Area</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">IPCC Fire Emissions</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-burn-area/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Burn Area</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-veg-classes/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Burn Area</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><strong>On this page</strong></h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
<li><a href="#sec-veg-ipcc-categories" id="toc-sec-veg-ipcc-categories" class="nav-link" data-scroll-target="#sec-veg-ipcc-categories"><span class="header-section-number">2.0.1</span> IPCC Vegetation Categories</a></li>
  <li><a href="#sec-veg-decision-tree" id="toc-sec-veg-decision-tree" class="nav-link" data-scroll-target="#sec-veg-decision-tree"><span class="header-section-number">2.0.2</span> Classification Decision Tree</a></li>
  <li><a href="#sec-veg-reporting" id="toc-sec-veg-reporting" class="nav-link" data-scroll-target="#sec-veg-reporting"><span class="header-section-number">2.0.3</span> Vegetation Reporting Requirements</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-modis" id="toc-sec-veg-modis" class="nav-link" data-scroll-target="#sec-veg-modis"><span class="header-section-number">2.1</span> MODIS Land Cover Classification</a>
  <ul class="collapse">
<li><a href="#sec-veg-igbp" id="toc-sec-veg-igbp" class="nav-link" data-scroll-target="#sec-veg-igbp"><span class="header-section-number">2.1.1</span> MCD12Q1 IGBP Classification Scheme</a></li>
  <li><a href="#igbp-burnable-classes" id="toc-igbp-burnable-classes" class="nav-link" data-scroll-target="#igbp-burnable-classes"><span class="header-section-number">2.1.2</span> IGBP Burnable Classes</a></li>
  <li><a href="#sec-veg-gee-access" id="toc-sec-veg-gee-access" class="nav-link" data-scroll-target="#sec-veg-gee-access"><span class="header-section-number">2.1.3</span> Earth Engine: MCD12Q1</a></li>
  <li><a href="#sec-veg-lc-uncertainty" id="toc-sec-veg-lc-uncertainty" class="nav-link" data-scroll-target="#sec-veg-lc-uncertainty"><span class="header-section-number">2.1.4</span> Land Cover Validation and Uncertainty</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-forest" id="toc-sec-veg-forest" class="nav-link" data-scroll-target="#sec-veg-forest"><span class="header-section-number">2.2</span> Forest Fire Classification</a>
  <ul class="collapse">
<li><a href="#sec-veg-forest-identify" id="toc-sec-veg-forest-identify" class="nav-link" data-scroll-target="#sec-veg-forest-identify"><span class="header-section-number">2.2.1</span> Forest Type Identification</a></li>
  <li><a href="#sec-veg-humid-tropical" id="toc-sec-veg-humid-tropical" class="nav-link" data-scroll-target="#sec-veg-humid-tropical"><span class="header-section-number">2.2.2</span> Humid Tropical Forest Delineation</a></li>
  <li><a href="#sec-veg-forest-area" id="toc-sec-veg-forest-area" class="nav-link" data-scroll-target="#sec-veg-forest-area"><span class="header-section-number">2.2.3</span> Forest Fire Area Calculation</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-savanna" id="toc-sec-veg-savanna" class="nav-link" data-scroll-target="#sec-veg-savanna"><span class="header-section-number">2.3</span> Savanna Fire Classification</a>
  <ul class="collapse">
<li><a href="#sec-veg-savanna-types" id="toc-sec-veg-savanna-types" class="nav-link" data-scroll-target="#sec-veg-savanna-types"><span class="header-section-number">2.3.1</span> Grassland and Woody Vegetation Types</a></li>
  <li><a href="#sec-veg-climate-stratification" id="toc-sec-veg-climate-stratification" class="nav-link" data-scroll-target="#sec-veg-climate-stratification"><span class="header-section-number">2.3.2</span> Climate Zone Stratification</a></li>
  <li><a href="#sec-veg-seasonal" id="toc-sec-veg-seasonal" class="nav-link" data-scroll-target="#sec-veg-seasonal"><span class="header-section-number">2.3.3</span> Seasonal Burn Patterns</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-organic" id="toc-sec-veg-organic" class="nav-link" data-scroll-target="#sec-veg-organic"><span class="header-section-number">2.4</span> Organic Soil Fire Classification</a>
  <ul class="collapse">
<li><a href="#sec-veg-histosols" id="toc-sec-veg-histosols" class="nav-link" data-scroll-target="#sec-veg-histosols"><span class="header-section-number">2.4.1</span> Histosols Identification</a></li>
  <li><a href="#sec-veg-organic-regional" id="toc-sec-veg-organic-regional" class="nav-link" data-scroll-target="#sec-veg-organic-regional"><span class="header-section-number">2.4.2</span> Regional Constraints</a></li>
  <li><a href="#sec-veg-organic-uncertainty" id="toc-sec-veg-organic-uncertainty" class="nav-link" data-scroll-target="#sec-veg-organic-uncertainty"><span class="header-section-number">2.4.3</span> Uncertainty in Organic Soil Classification</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-validation" id="toc-sec-veg-validation" class="nav-link" data-scroll-target="#sec-veg-validation"><span class="header-section-number">2.5</span> Multi-Source Validation of Vegetation Classification</a>
  <ul class="collapse">
<li><a href="#sec-veg-glad-height" id="toc-sec-veg-glad-height" class="nav-link" data-scroll-target="#sec-veg-glad-height"><span class="header-section-number">2.5.1</span> GLAD Forest Height for Forest/Non-Forest Validation</a></li>
  <li><a href="#sec-veg-esri-validation" id="toc-sec-veg-esri-validation" class="nav-link" data-scroll-target="#sec-veg-esri-validation"><span class="header-section-number">2.5.2</span> ESRI Land Cover for High-Resolution Validation</a></li>
  <li><a href="#sec-veg-eutrees-validation" id="toc-sec-veg-eutrees-validation" class="nav-link" data-scroll-target="#sec-veg-eutrees-validation"><span class="header-section-number">2.5.3</span> EU-Trees4F Species Distribution</a></li>
  <li><a href="#sec-veg-chorological" id="toc-sec-veg-chorological" class="nav-link" data-scroll-target="#sec-veg-chorological"><span class="header-section-number">2.5.4</span> Chorological Maps for Forest Type Verification</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-workflow" id="toc-sec-veg-workflow" class="nav-link" data-scroll-target="#sec-veg-workflow"><span class="header-section-number">2.6</span> Complete Vegetation Classification Workflow</a>
  <ul class="collapse">
<li><a href="#sec-veg-pipeline" id="toc-sec-veg-pipeline" class="nav-link" data-scroll-target="#sec-veg-pipeline"><span class="header-section-number">2.6.1</span> Integrated Processing Pipeline</a></li>
  <li><a href="#sec-veg-output" id="toc-sec-veg-output" class="nav-link" data-scroll-target="#sec-veg-output"><span class="header-section-number">2.6.2</span> Output Format for Chapter 3</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-qc" id="toc-sec-veg-qc" class="nav-link" data-scroll-target="#sec-veg-qc"><span class="header-section-number">2.7</span> Quality Control and Uncertainty</a>
  <ul class="collapse">
<li><a href="#sec-veg-uncertainty-assess" id="toc-sec-veg-uncertainty-assess" class="nav-link" data-scroll-target="#sec-veg-uncertainty-assess"><span class="header-section-number">2.7.1</span> Classification Uncertainty Assessment</a></li>
  <li><a href="#sec-veg-qc-checklist" id="toc-sec-veg-qc-checklist" class="nav-link" data-scroll-target="#sec-veg-qc-checklist"><span class="header-section-number">2.7.2</span> QC Checklist</a></li>
  </ul>
</li>
  <li>
<a href="#sec-veg-summary" id="toc-sec-veg-summary" class="nav-link" data-scroll-target="#sec-veg-summary"><span class="header-section-number">2.8</span> Chapter Summary and Next Steps</a>
  <ul class="collapse">
<li><a href="#sec-veg-takeaways" id="toc-sec-veg-takeaways" class="nav-link" data-scroll-target="#sec-veg-takeaways"><span class="header-section-number">2.8.1</span> Key Takeaways</a></li>
  <li><a href="#sec-veg-to-chapter3" id="toc-sec-veg-to-chapter3" class="nav-link" data-scroll-target="#sec-veg-to-chapter3"><span class="header-section-number">2.8.2</span> Progression to Chapter 3</a></li>
  </ul>
</li>
  <li><a href="#sec-veg-references" id="toc-sec-veg-references" class="nav-link" data-scroll-target="#sec-veg-references"><span class="header-section-number">2.9</span> References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications/edit/main/02-veg-classes/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Burn Area</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="overview">Overview</h2>
<p>This chapter describes the classification of burned areas into IPCC-compliant vegetation categories using MODIS Land Cover (MCD12Q1) and auxiliary datasets. The classification determines which emission factors and fuel consumption values apply to each burned pixel, directly impacting greenhouse gas emission estimates.</p>
<hr>
<section id="sec-veg-ipcc-categories" class="level3" data-number="2.0.1"><h3 data-number="2.0.1" class="anchored" data-anchor-id="sec-veg-ipcc-categories">
<span class="header-section-number">2.0.1</span> IPCC Vegetation Categories</h3>
<p>FAOSTAT implements three primary fire categories aligned with IPCC 2006 Guidelines <span class="citation" data-cites="intergovernmental2006chapter">(<a href="../references/index.html#ref-intergovernmental2006chapter" role="doc-biblioref">Climate Change, 2006</a>)</span>:</p>
<p>1. Forest Fires:</p>
<ul>
<li>Humid Tropical Forest: Fires in tropical moist ecological zones</li>
<li>Other Forest: All remaining forest types (boreal, temperate, tropical dry)</li>
</ul>
<p>2. Savanna Fires (Grassland):</p>
<ul>
<li>Grassland</li>
<li>Savanna</li>
<li>Woody Savanna</li>
<li>Open Shrubland</li>
<li>Closed Shrubland</li>
</ul>
<p>3. Fires in Organic Soils:</p>
<ul>
<li>Peatland fires (Histosols classification)</li>
<li>Independent of overlying vegetation</li>
</ul></section><section id="sec-veg-decision-tree" class="level3" data-number="2.0.2"><h3 data-number="2.0.2" class="anchored" data-anchor-id="sec-veg-decision-tree">
<span class="header-section-number">2.0.2</span> Classification Decision Tree</h3>
</section><section id="sec-veg-reporting" class="level3" data-number="2.0.3"><h3 data-number="2.0.3" class="anchored" data-anchor-id="sec-veg-reporting">
<span class="header-section-number">2.0.3</span> Vegetation Reporting Requirements</h3>
<p>Following IPCC guidelines:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Vegetation Type</th>
<th>CO₂</th>
<th>CH₄</th>
<th>N₂O</th>
<th>Rationale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Forest Fires</td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
<td>CO₂ in carbon stock changes</td>
</tr>
<tr class="even">
<td>Savanna Fires</td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
<td>Assumes annual CO₂ balance</td>
</tr>
<tr class="odd">
<td>Organic Soil Fires</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>Per Wetlands Supplement</td>
</tr>
</tbody>
</table>
<p>Key principle: CO₂ from non-stand-replacing fires assumed balanced by regrowth within one year (IPCC 2019, Section 2.4).</p>
<hr></section></section><section id="sec-veg-modis" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="sec-veg-modis">
<span class="header-section-number">2.1</span> MODIS Land Cover Classification</h2>
<section id="sec-veg-igbp" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="sec-veg-igbp">
<span class="header-section-number">2.1.1</span> MCD12Q1 IGBP Classification Scheme</h3>
<section id="sec-veg-mcd12q1-overview" class="level4" data-number="2.1.1.1"><h4 data-number="2.1.1.1" class="anchored" data-anchor-id="sec-veg-mcd12q1-overview">
<span class="header-section-number">2.1.1.1</span> Product Overview</h4>
<ul>
<li>GEE Asset: <code>MODIS/061/MCD12Q1</code>
</li>
<li>Spatial Resolution: 500m</li>
<li>Temporal Resolution: Annual (2001-present)</li>
<li>Classification System: Land Cover Type 1 - IGBP (International Geosphere-Biosphere Programme)
<ul>
<li>Algorithm: Supervised classification using Random Forest trained on reference sites</li>
<li>Overall Accuracy: ~75% globally <span class="citation" data-cites="sulla2018user">(<a href="../references/index.html#ref-sulla2018user" role="doc-biblioref">Sulla-Menashe et al., 2018</a>)</span>
</li>
</ul>
</li>
</ul></section></section><section id="igbp-burnable-classes" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="igbp-burnable-classes">
<span class="header-section-number">2.1.2</span> IGBP Burnable Classes</h3>
<p>Forest Classes (1-5):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 20%">
<col style="width: 40%">
</colgroup>
<thead><tr class="header">
<th>Class</th>
<th>Name</th>
<th>IPCC Category</th>
<th>Fuel Consumption (t ha⁻¹)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Evergreen Needleleaf Forests</td>
<td>Other Forest</td>
<td>41.0 (mean)</td>
</tr>
<tr class="even">
<td>2</td>
<td>Evergreen Broadleaf Forests</td>
<td>Humid Tropical Forest</td>
<td>119.6 (mean)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Deciduous Needleleaf Forests</td>
<td>Other Forest</td>
<td>41.0 (mean)</td>
</tr>
<tr class="even">
<td>4</td>
<td>Deciduous Broadleaf Forests</td>
<td>Other/Tropical (zone-dependent)</td>
<td>69.4-119.6</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Mixed Forests</td>
<td>Other Forest</td>
<td>50.4 (mean)</td>
</tr>
</tbody>
</table>
<p>Grassland/Savanna Classes (6-10):</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Class</th>
<th>Name</th>
<th>IPCC Category</th>
<th>Fuel Consumption (t ha⁻¹)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>Closed Shrublands</td>
<td>Savanna (Shrubland)</td>
<td>14.3 (mean)</td>
</tr>
<tr class="even">
<td>7</td>
<td>Open Shrublands</td>
<td>Savanna (Shrubland)</td>
<td>14.3 (mean)</td>
</tr>
<tr class="odd">
<td>8</td>
<td>Woody Savannas</td>
<td>Savanna (Woody)</td>
<td>2.6-4.6 (season)</td>
</tr>
<tr class="even">
<td>9</td>
<td>Savannas</td>
<td>Savanna</td>
<td>2.1-10.0 (season)</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Grasslands</td>
<td>Savanna (Grassland)</td>
<td>2.1-10.0 (season)</td>
</tr>
</tbody>
</table>
<p>Excluded Classes:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Class</th>
<th>Name</th>
<th>Reason for Exclusion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Water</td>
<td>Not burnable</td>
</tr>
<tr class="even">
<td>11</td>
<td>Permanent Wetlands</td>
<td>Handled separately if Histosol</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Croplands</td>
<td>Agricultural fires (separate category)</td>
</tr>
<tr class="even">
<td>13</td>
<td>Urban and Built-up</td>
<td>Fire prevention/suppression active</td>
</tr>
<tr class="odd">
<td>14</td>
<td>Cropland/Natural Vegetation Mosaics</td>
<td>Ambiguous, often excluded</td>
</tr>
<tr class="even">
<td>15</td>
<td>Permanent Snow and Ice</td>
<td>Not burnable</td>
</tr>
<tr class="odd">
<td>16</td>
<td>Barren</td>
<td>Insufficient fuel</td>
</tr>
<tr class="even">
<td>17</td>
<td>Unclassified</td>
<td>No data</td>
</tr>
</tbody>
</table></section><section id="sec-veg-gee-access" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="sec-veg-gee-access">
<span class="header-section-number">2.1.3</span> Earth Engine: MCD12Q1</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee/">rgee</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load land cover collection</span></span>
<span><span class="va">landCover</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">ImageCollection</span><span class="op">(</span><span class="st">"MODIS/061/MCD12Q1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select IGBP classification (Type 1)</span></span>
<span><span class="va">igbp</span> <span class="op">&lt;-</span> <span class="va">landCover</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"LC_Type1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get land cover for specific year (example: 2023)</span></span>
<span><span class="va">lc_2023</span> <span class="op">&lt;-</span> <span class="va">igbp</span><span class="op">$</span></span>
<span>  <span class="fu">filterDate</span><span class="op">(</span><span class="st">"2023-01-01"</span>, <span class="st">"2023-12-31"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">first</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">lc_vis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">'05450a'</span>, <span class="st">'086a10'</span>, <span class="st">'54a708'</span>, <span class="st">'78d203'</span>, <span class="st">'009900'</span>,  <span class="co"># Forests 1-5</span></span>
<span>    <span class="st">'c6b044'</span>, <span class="st">'dcd159'</span>, <span class="st">'dade48'</span>, <span class="st">'fbff13'</span>, <span class="st">'b6ff05'</span>,  <span class="co"># Savanna/Grass 6-10</span></span>
<span>    <span class="st">'c24f44'</span>, <span class="st">'a5a5a5'</span>, <span class="st">'ff6d4c'</span>, <span class="st">'69fff8'</span>, <span class="st">'f9ffa4'</span>,  <span class="co"># Other 11-15</span></span>
<span>    <span class="st">'1c0dff'</span>, <span class="st">'ffffff'</span>                                   <span class="co"># Barren/Unclass 16-17</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="va">lc_vis</span>, <span class="st">"IGBP Land Cover 2023"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-lc-uncertainty" class="level3" data-number="2.1.4"><h3 data-number="2.1.4" class="anchored" data-anchor-id="sec-veg-lc-uncertainty">
<span class="header-section-number">2.1.4</span> Land Cover Validation and Uncertainty</h3>
<p>Known Classification Issues:</p>
<ol type="1">
<li>Woody Savanna vs.&nbsp;Open Forest: Confusion in transition zones</li>
<li>Grassland vs.&nbsp;Cropland: Agricultural areas misclassified</li>
<li>Seasonal Deciduous Forests: May shift between forest/savanna</li>
<li>Temporal Lag: Land use changes not immediately reflected</li>
</ol>
<p>Regional Accuracy (Sulla-Menashe &amp; Friedl, 2022):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 26%">
<col style="width: 25%">
<col style="width: 26%">
</colgroup>
<thead><tr class="header">
<th>Region</th>
<th>Overall Accuracy</th>
<th>Forest Accuracy</th>
<th>Savanna Accuracy</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Africa</td>
<td>73%</td>
<td>68%</td>
<td>78%</td>
</tr>
<tr class="even">
<td>South America</td>
<td>77%</td>
<td>82%</td>
<td>71%</td>
</tr>
<tr class="odd">
<td>Europe</td>
<td>79%</td>
<td>86%</td>
<td>65%</td>
</tr>
<tr class="even">
<td>Asia</td>
<td>74%</td>
<td>75%</td>
<td>73%</td>
</tr>
<tr class="odd">
<td>North America</td>
<td>81%</td>
<td>88%</td>
<td>74%</td>
</tr>
</tbody>
</table>
<hr></section></section><section id="sec-veg-forest" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="sec-veg-forest">
<span class="header-section-number">2.2</span> Forest Fire Classification</h2>
<section id="sec-veg-forest-identify" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="sec-veg-forest-identify">
<span class="header-section-number">2.2.1</span> Forest Type Identification</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define forest classes (IGBP 1-5)</span></span>
<span><span class="va">FOREST_CLASSES</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to extract forest mask</span></span>
<span><span class="va">extractForest</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lc_image</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lc</span> <span class="op">&lt;-</span> <span class="va">lc_image</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"LC_Type1"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create forest mask</span></span>
<span>  <span class="va">forest_mask</span> <span class="op">&lt;-</span> <span class="va">lc</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span>  <span class="co"># Evergreen Needleleaf</span></span>
<span>    <span class="fu">Or</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span>           <span class="co"># Evergreen Broadleaf</span></span>
<span>    <span class="fu">Or</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span>           <span class="co"># Deciduous Needleleaf</span></span>
<span>    <span class="fu">Or</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">$</span>           <span class="co"># Deciduous Broadleaf</span></span>
<span>    <span class="fu">Or</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>            <span class="co"># Mixed Forests</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">forest_mask</span><span class="op">$</span><span class="fu">rename</span><span class="op">(</span><span class="st">"forest_mask"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to land cover</span></span>
<span><span class="va">forest_mask_2023</span> <span class="op">&lt;-</span> <span class="fu">extractForest</span><span class="op">(</span><span class="va">lc_2023</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay with burned area (from Chapter 1)</span></span>
<span><span class="co"># Assuming annual_burned_2023 is available from Chapter 1</span></span>
<span><span class="va">forest_fires_2023</span> <span class="op">&lt;-</span> <span class="va">annual_burned_2023</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">forest_mask_2023</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span></span>
<span>  <span class="va">forest_fires_2023</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Forest Fires 2023"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-humid-tropical" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="sec-veg-humid-tropical">
<span class="header-section-number">2.2.2</span> Humid Tropical Forest Delineation</h3>
<section id="sec-veg-fao-ecozones" class="level4" data-number="2.2.2.1"><h4 data-number="2.2.2.1" class="anchored" data-anchor-id="sec-veg-fao-ecozones">
<span class="header-section-number">2.2.2.1</span> FAO-FRA Global Ecological Zones</h4>
<p>Dataset: FAO-FRA Global Ecological Zones 2010 Update</p>
<p>Tropical Moist Zones (for Humid Tropical Forest):</p>
<ul>
<li>Tropical rainforest</li>
<li>Tropical moist deciduous forest</li>
<li>Tropical mountain systems (in moist zones)</li>
</ul>
<p>Implementation:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Note: FAO-FRA zones not directly in GEE</span></span>
<span><span class="co"># Alternative 1: Use climate proxy (precipitation + temperature)</span></span>
<span><span class="co"># Alternative 2: Upload FAO zones as asset</span></span>
<span></span>
<span><span class="co"># METHOD 1: Climate-based proxy</span></span>
<span><span class="co"># Load WorldClim precipitation</span></span>
<span><span class="va">precip</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio12"</span><span class="op">)</span>  <span class="co"># Annual precip</span></span>
<span></span>
<span><span class="co"># Load temperature</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio01"</span><span class="op">)</span>  <span class="co"># Annual mean temp</span></span>
<span></span>
<span><span class="co"># Define tropical moist criteria (simplified)</span></span>
<span><span class="co"># Tropical: Mean annual temp &gt; 18°C</span></span>
<span><span class="co"># Moist: Annual precip &gt; 1500mm</span></span>
<span><span class="va">tropical</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">180</span><span class="op">)</span>  <span class="co"># WorldClim temp in °C * 10</span></span>
<span><span class="va">moist</span> <span class="op">&lt;-</span> <span class="va">precip</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">1500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">humid_tropical_mask</span> <span class="op">&lt;-</span> <span class="va">tropical</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">moist</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with forest mask</span></span>
<span><span class="va">humid_tropical_forest</span> <span class="op">&lt;-</span> <span class="va">forest_mask_2023</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">humid_tropical_mask</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Other forest = all forests NOT in humid tropical zones</span></span>
<span><span class="va">other_forest</span> <span class="op">&lt;-</span> <span class="va">forest_mask_2023</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">humid_tropical_mask</span><span class="op">$</span><span class="fu">Not</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay with burned areas</span></span>
<span><span class="va">htf_fires_2023</span> <span class="op">&lt;-</span> <span class="va">annual_burned_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">humid_tropical_forest</span><span class="op">)</span></span>
<span><span class="va">other_fires_2023</span> <span class="op">&lt;-</span> <span class="va">annual_burned_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">other_forest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">htf_fires_2023</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span>, <span class="st">"Humid Tropical Fires"</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">other_fires_2023</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>, <span class="st">"Other Forest Fires"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># If FAO-FRA zones uploaded as asset</span></span>
<span><span class="co"># (User would need to upload this manually)</span></span>
<span></span>
<span><span class="co"># Load FAO zones (example path)</span></span>
<span><span class="va">fao_zones</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">FeatureCollection</span><span class="op">(</span><span class="st">"users/your_username/FAO_FRA_EcoZones"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to tropical moist zones</span></span>
<span><span class="va">tropical_moist_zones</span> <span class="op">&lt;-</span> <span class="va">fao_zones</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span></span>
<span>  <span class="va">ee</span><span class="op">$</span><span class="va">Filter</span><span class="op">$</span><span class="fu">inList</span><span class="op">(</span><span class="st">"GEZ_NAME"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Tropical rainforest"</span>,</span>
<span>    <span class="st">"Tropical moist deciduous forest"</span>,</span>
<span>    <span class="st">"Tropical mountain systems"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rasterize to match MODIS resolution</span></span>
<span><span class="va">tropical_moist_raster</span> <span class="op">&lt;-</span> <span class="va">tropical_moist_zones</span><span class="op">$</span></span>
<span>  <span class="fu">reduceToImage</span><span class="op">(</span></span>
<span>    properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"GEZ_CODE"</span><span class="op">)</span>,</span>
<span>    reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">first</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">reproject</span><span class="op">(</span>crs <span class="op">=</span> <span class="va">lc_2023</span><span class="op">$</span><span class="fu">projection</span><span class="op">(</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create mask</span></span>
<span><span class="va">humid_tropical_mask_fao</span> <span class="op">&lt;-</span> <span class="va">tropical_moist_raster</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply to forest fires</span></span>
<span><span class="va">htf_fires_fao</span> <span class="op">&lt;-</span> <span class="va">annual_burned_2023</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">forest_mask_2023</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">humid_tropical_mask_fao</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-veg-forest-area" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="sec-veg-forest-area">
<span class="header-section-number">2.2.3</span> Forest Fire Area Calculation</h3>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define area of interest (from Chapter 1)</span></span>
<span><span class="co"># Assuming 'aoi' is defined (e.g., country boundary)</span></span>
<span></span>
<span><span class="co"># Function to calculate area</span></span>
<span><span class="va">calculateForestFireArea</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fire_image</span>, <span class="va">mask</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">area_ha</span> <span class="op">&lt;-</span> <span class="va">fire_image</span><span class="op">$</span></span>
<span>    <span class="fu">updateMask</span><span class="op">(</span><span class="va">mask</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">multiply</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">pixelArea</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">divide</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">reduceRegion</span><span class="op">(</span></span>
<span>      reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      geometry <span class="op">=</span> <span class="va">aoi</span>,</span>
<span>      scale <span class="op">=</span> <span class="fl">500</span>,</span>
<span>      maxPixels <span class="op">=</span> <span class="fl">1e9</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="fu">Feature</span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    fire_type <span class="op">=</span> <span class="va">name</span>,</span>
<span>    area_ha <span class="op">=</span> <span class="va">area_ha</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"burned"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate areas</span></span>
<span><span class="va">htf_area</span> <span class="op">&lt;-</span> <span class="fu">calculateForestFireArea</span><span class="op">(</span></span>
<span>  <span class="va">annual_burned_2023</span>, </span>
<span>  <span class="va">humid_tropical_forest</span>,</span>
<span>  <span class="st">"Humid Tropical Forest"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">other_forest_area</span> <span class="op">&lt;-</span> <span class="fu">calculateForestFireArea</span><span class="op">(</span></span>
<span>  <span class="va">annual_burned_2023</span>,</span>
<span>  <span class="va">other_forest</span>,</span>
<span>  <span class="st">"Other Forest"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine results</span></span>
<span><span class="va">forest_fire_stats</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">FeatureCollection</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="va">htf_area</span>,</span>
<span>  <span class="va">other_forest_area</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export or retrieve</span></span>
<span><span class="va">forest_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_as_sf.html">ee_as_sf</a></span><span class="op">(</span><span class="va">forest_fire_stats</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">forest_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section></section><section id="sec-veg-savanna" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="sec-veg-savanna">
<span class="header-section-number">2.3</span> Savanna Fire Classification</h2>
<section id="sec-veg-savanna-types" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="sec-veg-savanna-types">
<span class="header-section-number">2.3.1</span> Grassland and Woody Vegetation Types</h3>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define savanna/grassland classes</span></span>
<span><span class="va">SAVANNA_CLASSES</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  grassland <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  savanna <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  woody_savanna <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  open_shrubland <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  closed_shrubland <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract each vegetation type</span></span>
<span><span class="va">extractSavannaType</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lc_image</span>, <span class="va">class_value</span>, <span class="va">class_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mask</span> <span class="op">&lt;-</span> <span class="va">lc_image</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"LC_Type1"</span><span class="op">)</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="va">class_value</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mask</span><span class="op">$</span><span class="fu">rename</span><span class="op">(</span><span class="va">class_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create masks for each type</span></span>
<span><span class="va">grassland_mask</span> <span class="op">&lt;-</span> <span class="fu">extractSavannaType</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="fl">10</span>, <span class="st">"grassland"</span><span class="op">)</span></span>
<span><span class="va">savanna_mask</span> <span class="op">&lt;-</span> <span class="fu">extractSavannaType</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="fl">9</span>, <span class="st">"savanna"</span><span class="op">)</span></span>
<span><span class="va">woody_savanna_mask</span> <span class="op">&lt;-</span> <span class="fu">extractSavannaType</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="fl">8</span>, <span class="st">"woody_savanna"</span><span class="op">)</span></span>
<span><span class="va">open_shrub_mask</span> <span class="op">&lt;-</span> <span class="fu">extractSavannaType</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="fl">7</span>, <span class="st">"open_shrubland"</span><span class="op">)</span></span>
<span><span class="va">closed_shrub_mask</span> <span class="op">&lt;-</span> <span class="fu">extractSavannaType</span><span class="op">(</span><span class="va">lc_2023</span>, <span class="fl">6</span>, <span class="st">"closed_shrubland"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combined savanna mask (all types)</span></span>
<span><span class="va">savanna_all_mask</span> <span class="op">&lt;-</span> <span class="va">grassland_mask</span><span class="op">$</span></span>
<span>  <span class="fu">Or</span><span class="op">(</span><span class="va">savanna_mask</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">Or</span><span class="op">(</span><span class="va">woody_savanna_mask</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">Or</span><span class="op">(</span><span class="va">open_shrub_mask</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">Or</span><span class="op">(</span><span class="va">closed_shrub_mask</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay with burned areas</span></span>
<span><span class="va">savanna_fires_2023</span> <span class="op">&lt;-</span> <span class="va">annual_burned_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">savanna_all_mask</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span></span>
<span>  <span class="va">savanna_fires_2023</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Savanna Fires 2023"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-climate-stratification" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="sec-veg-climate-stratification">
<span class="header-section-number">2.3.2</span> Climate Zone Stratification</h3>
<p>Rationale: Fuel consumption varies by climate (IPCC Table 2.4)</p>
<p>IPCC Climate Zones:</p>
<ul>
<li>Boreal (Cold)</li>
<li>Temperate (Warm/Cool)</li>
<li>Tropical (Wet/Moist/Dry/Montane)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load JRC Climate Zones (IPCC-based)</span></span>
<span><span class="co"># Note: May need to upload as asset if not in GEE catalog</span></span>
<span></span>
<span><span class="co"># Alternative: Use temperature/precipitation proxies</span></span>
<span><span class="co"># Load WorldClim data</span></span>
<span><span class="va">bio01</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio01"</span><span class="op">)</span>  <span class="co"># Annual mean temp</span></span>
<span><span class="va">bio12</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio12"</span><span class="op">)</span>  <span class="co"># Annual precip</span></span>
<span></span>
<span><span class="co"># Define climate zones (simplified)</span></span>
<span><span class="co"># Tropical: MAT &gt; 18°C</span></span>
<span><span class="va">tropical_zone</span> <span class="op">&lt;-</span> <span class="va">bio01</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">180</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boreal: MAT &lt; 0°C</span></span>
<span><span class="va">boreal_zone</span> <span class="op">&lt;-</span> <span class="va">bio01</span><span class="op">$</span><span class="fu">lt</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Temperate: Everything else</span></span>
<span><span class="va">temperate_zone</span> <span class="op">&lt;-</span> <span class="va">bio01</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">bio01</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply to savanna fires</span></span>
<span><span class="va">savanna_tropical</span> <span class="op">&lt;-</span> <span class="va">savanna_fires_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">tropical_zone</span><span class="op">)</span></span>
<span><span class="va">savanna_temperate</span> <span class="op">&lt;-</span> <span class="va">savanna_fires_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">temperate_zone</span><span class="op">)</span></span>
<span><span class="va">savanna_boreal</span> <span class="op">&lt;-</span> <span class="va">savanna_fires_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">boreal_zone</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize climate-stratified fires</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">savanna_tropical</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, <span class="st">"Tropical Savanna Fires"</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">savanna_temperate</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>, <span class="st">"Temperate Savanna Fires"</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">savanna_boreal</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>, <span class="st">"Boreal Savanna Fires"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-seasonal" class="level3" data-number="2.3.3"><h3 data-number="2.3.3" class="anchored" data-anchor-id="sec-veg-seasonal">
<span class="header-section-number">2.3.3</span> Seasonal Burn Patterns</h3>
<p>Importance: Fuel consumption differs between early/late dry season (IPCC Table 2.4)</p>
<ul>
<li>Early dry season: Lower fuel consumption (2.6 t ha⁻¹ savanna woodland)</li>
<li>Late dry season: Higher fuel consumption (4.6 t ha⁻¹ savanna woodland)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract burn month from burn date</span></span>
<span><span class="va">extractBurnMonth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mcd64_image</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">burn_date</span> <span class="op">&lt;-</span> <span class="va">mcd64_image</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"BurnDate"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Get image date (represents the month)</span></span>
<span>  <span class="va">img_date</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Date</span><span class="op">(</span><span class="va">mcd64_image</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"system:time_start"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">month</span> <span class="op">&lt;-</span> <span class="va">img_date</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"month"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create month band</span></span>
<span>  <span class="va">month_band</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">constant</span><span class="op">(</span><span class="va">month</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">updateMask</span><span class="op">(</span><span class="va">burn_date</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">rename</span><span class="op">(</span><span class="st">"burn_month"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">burn_date</span><span class="op">$</span><span class="fu">addBands</span><span class="op">(</span><span class="va">month_band</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to monthly collection (from Chapter 1)</span></span>
<span><span class="va">mcd64_with_months</span> <span class="op">&lt;-</span> <span class="va">mcd64_faostat</span><span class="op">$</span>  <span class="co"># From Chapter 1</span></span>
<span>  <span class="fu">filterDate</span><span class="op">(</span><span class="st">"2023-01-01"</span>, <span class="st">"2023-12-31"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">extractBurnMonth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract months as separate images</span></span>
<span><span class="va">month_composite</span> <span class="op">&lt;-</span> <span class="va">mcd64_with_months</span><span class="op">$</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="st">"burn_month"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">max</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Takes the latest month if pixel burned multiple times</span></span>
<span></span>
<span><span class="co"># Define seasons (example for Southern Hemisphere savanna)</span></span>
<span><span class="co"># Early dry season: May-July (months 5-7)</span></span>
<span><span class="co"># Late dry season: August-October (months 8-10)</span></span>
<span></span>
<span><span class="va">early_season</span> <span class="op">&lt;-</span> <span class="va">month_composite</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">month_composite</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">late_season</span> <span class="op">&lt;-</span> <span class="va">month_composite</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">month_composite</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply to savanna fires</span></span>
<span><span class="va">savanna_early</span> <span class="op">&lt;-</span> <span class="va">savanna_fires_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">early_season</span><span class="op">)</span></span>
<span><span class="va">savanna_late</span> <span class="op">&lt;-</span> <span class="va">savanna_fires_2023</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">late_season</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate areas</span></span>
<span><span class="va">early_area</span> <span class="op">&lt;-</span> <span class="va">savanna_early</span><span class="op">$</span></span>
<span>  <span class="fu">multiply</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">pixelArea</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">divide</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">reduceRegion</span><span class="op">(</span>reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span>, geometry <span class="op">=</span> <span class="va">aoi</span>, scale <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">late_area</span> <span class="op">&lt;-</span> <span class="va">savanna_late</span><span class="op">$</span></span>
<span>  <span class="fu">multiply</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">pixelArea</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">divide</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">reduceRegion</span><span class="op">(</span>reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span>, geometry <span class="op">=</span> <span class="va">aoi</span>, scale <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Early season:"</span>, <span class="va">early_area</span><span class="op">$</span><span class="fu">getInfo</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">burned</span>, <span class="st">"ha"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Late season:"</span>, <span class="va">late_area</span><span class="op">$</span><span class="fu">getInfo</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">burned</span>, <span class="st">"ha"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section></section><section id="sec-veg-organic" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="sec-veg-organic">
<span class="header-section-number">2.4</span> Organic Soil Fire Classification</h2>
<section id="sec-veg-histosols" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="sec-veg-histosols">
<span class="header-section-number">2.4.1</span> Histosols Identification</h3>
<ul>
<li>Dataset: Harmonized World Soil Database (HWSD v1.2)</li>
<li>Histosols: Organic soils with &gt; 20-30% organic matter by weight</li>
<li>Detection Challenge: Fires in organic soils independent of surface land cover</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: HWSD not directly in GEE</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Two approaches:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Upload HWSD as asset</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use existing peatland datasets in GEE</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># APPROACH 1: Using Global Peatland Dataset</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (Example: Several peatland datasets exist in GEE catalog)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for peatland/wetland datasets</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example using a hypothetical peatland layer</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Actual implementation depends on available datasets</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For FAOSTAT methodology: Upload HWSD Histosols layer</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (User action required)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># APPROACH 2: Simplified proxy using permanent wetlands + tropical</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>wetlands_mask <span class="ot">&lt;-</span> lc_2023<span class="sc">$</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">11</span>)  <span class="co"># Permanent wetlands</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on Southeast Asia (where validated)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Southeast Asia bounding box</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>sea_bbox <span class="ot">&lt;-</span> ee<span class="sc">$</span>Geometry<span class="sc">$</span><span class="fu">Rectangle</span>([<span class="dv">95</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">141</span>, <span class="dv">20</span>])</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Peatland proxy: Wetlands in SE Asia lowlands</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>elevation <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"USGS/SRTMGL1_003"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>lowlands <span class="ot">&lt;-</span> elevation<span class="sc">$</span><span class="fu">lt</span>(<span class="dv">100</span>)  <span class="co"># &lt; 100m elevation</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>organic_soil_mask <span class="ot">&lt;-</span> wetlands_mask<span class="sc">$</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">And</span>(lowlands)<span class="sc">$</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clip</span>(sea_bbox)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned areas</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>organic_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(organic_soil_mask)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  organic_fires_2023,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"brown"</span>),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organic Soil Fires 2023 (SE Asia)"</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-organic-regional" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="sec-veg-organic-regional">
<span class="header-section-number">2.4.2</span> Regional Constraints</h3>
<p>FAOSTAT approach (per methodology guide):</p>
<blockquote class="blockquote">
<p>“Due to the current lack of evidence for other regions of the world, we set to 0 all the country values outside Southeastern Asia.”</p>
</blockquote>
<p>Southeast Asian Countries (non-zero organic soil fires):</p>
<ul>
<li>Indonesia</li>
<li>Malaysia</li>
<li>Brunei Darussalam</li>
<li>(Potentially: Philippines, Thailand, Vietnam - check FAOSTAT regional definition)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load country boundaries</span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">FeatureCollection</span><span class="op">(</span><span class="st">"FAO/GAUL/2015/level0"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Southeast Asia countries</span></span>
<span><span class="va">SEA_COUNTRIES</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Indonesia"</span>,</span>
<span>  <span class="st">"Malaysia"</span>,</span>
<span>  <span class="st">"Brunei Darussalam"</span></span>
<span>  <span class="co"># Add others as per FAOSTAT definition</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to SE Asia</span></span>
<span><span class="va">sea_countries</span> <span class="op">&lt;-</span> <span class="va">countries</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span></span>
<span>  <span class="va">ee</span><span class="op">$</span><span class="va">Filter</span><span class="op">$</span><span class="fu">inList</span><span class="op">(</span><span class="st">"ADM0_NAME"</span>, <span class="va">SEA_COUNTRIES</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clip organic fires to SE Asia only</span></span>
<span><span class="va">organic_fires_sea</span> <span class="op">&lt;-</span> <span class="va">organic_fires_2023</span><span class="op">$</span><span class="fu">clip</span><span class="op">(</span><span class="va">sea_countries</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All organic fires outside SE Asia = 0 (per FAOSTAT)</span></span>
<span><span class="co"># (Achieved by clipping to SE Asia only)</span></span>
<span></span>
<span><span class="co"># Calculate area</span></span>
<span><span class="va">organic_area_sea</span> <span class="op">&lt;-</span> <span class="va">organic_fires_sea</span><span class="op">$</span></span>
<span>  <span class="fu">multiply</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">pixelArea</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">divide</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">reduceRegions</span><span class="op">(</span></span>
<span>    collection <span class="op">=</span> <span class="va">sea_countries</span>,</span>
<span>    reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">500</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Results</span></span>
<span><span class="va">organic_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_as_sf.html">ee_as_sf</a></span><span class="op">(</span><span class="va">organic_area_sea</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">ADM0_NAME</span>, <span class="va">sum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>country <span class="op">=</span> <span class="va">ADM0_NAME</span>, area_ha <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">organic_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-organic-uncertainty" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="sec-veg-organic-uncertainty">
<span class="header-section-number">2.4.3</span> Uncertainty in Organic Soil Classification</h3>
<p>High uncertainty sources (IPCC 2014 Wetlands Supplement):</p>
<ol type="1">
<li>Detection limitations:</li>
</ol>
<ul>
<li>Smoldering fires difficult to detect via optical remote sensing</li>
<li>Dense canopy obscures ground fires</li>
</ul>
<ol start="2" type="1">
<li>Soil classification uncertainty:</li>
</ol>
<ul>
<li>HWSD spatial resolution (~1km) coarser than fire detection (500m)</li>
<li>Organic soil depth variable within pixels</li>
<li>Drainage status unknown (drained vs.&nbsp;undrained)</li>
</ul>
<ol start="3" type="1">
<li>Fire depth uncertainty:</li>
</ol>
<ul>
<li>Surface burn vs.&nbsp;deep peat burn</li>
<li>Fuel consumption highly variable: 41 ± 1.4 t ha⁻¹ (IPCC Table 2.6)</li>
</ul>
<p>FAOSTAT approach: Conservative reporting (SE Asia only) until more validation data available</p>
<hr></section></section><section id="sec-veg-validation" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="sec-veg-validation">
<span class="header-section-number">2.5</span> Multi-Source Validation of Vegetation Classification</h2>
<section id="sec-veg-glad-height" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="sec-veg-glad-height">
<span class="header-section-number">2.5.1</span> GLAD Forest Height for Forest/Non-Forest Validation</h3>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cidree.github.io/forestdata/">forestdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download GLAD forest height (example: Portugal)</span></span>
<span><span class="va">glad_height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cidree.github.io/forestdata/reference/fd_forest_glad.html">fd_forest_glad</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="op">-</span><span class="fl">7.8</span>,</span>
<span>  lat <span class="op">=</span> <span class="fl">42.7</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"height"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2020</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Forest threshold: &gt; 5m height (per IPCC definition)</span></span>
<span><span class="va">glad_forest_mask</span> <span class="op">&lt;-</span> <span class="va">glad_height</span> <span class="op">&gt;</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Resample MODIS to GLAD resolution (30m) for comparison</span></span>
<span><span class="co"># (Or aggregate GLAD to MODIS 500m)</span></span>
<span><span class="va">glad_forest_500m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/aggregate.html">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="va">glad_forest_mask</span>,</span>
<span>  fact <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html">round</a></span><span class="op">(</span><span class="fl">500</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span>,  <span class="co"># ~17x aggregation</span></span>
<span>  fun <span class="op">=</span> <span class="va">mean</span>  <span class="co"># Proportion of 30m pixels that are forest</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export MODIS forest from GEE for comparison</span></span>
<span><span class="va">modis_forest_mask_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_as_rast.html">ee_as_rast</a></span><span class="op">(</span></span>
<span>  <span class="va">forest_mask_2023</span>,</span>
<span>  region <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Geometry</span><span class="op">$</span><span class="fu">Point</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7.8</span>, <span class="fl">42.7</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="fu">buffer</span><span class="op">(</span><span class="fl">50000</span><span class="op">)</span>,  <span class="co"># 50km radius</span></span>
<span>  scale <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare classifications</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="co"># Ensure same extent and resolution</span></span>
<span><span class="va">glad_crop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html">crop</a></span><span class="op">(</span><span class="va">glad_forest_500m</span>, <span class="va">modis_forest_mask_r</span><span class="op">)</span></span>
<span><span class="va">modis_crop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html">crop</a></span><span class="op">(</span><span class="va">modis_forest_mask_r</span>, <span class="va">glad_forest_500m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confusion matrix</span></span>
<span><span class="va">confusion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">modis_crop</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  reference <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">glad_crop</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># &gt;50% forest in aggregated pixel</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">confusion</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Kappa statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Cohen's Kappa:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html">round</a></span><span class="op">(</span><span class="va">confusion</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="st">"Kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-esri-validation" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="sec-veg-esri-validation">
<span class="header-section-number">2.5.2</span> ESRI Land Cover for High-Resolution Validation</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cidree.github.io/forestdata/">forestdata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download ESRI land cover (10m resolution)</span></span>
<span><span class="va">esri_lc_2023</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cidree.github.io/forestdata/reference/fd_landcover_esri.html">fd_landcover_esri</a></span><span class="op">(</span>utm_code <span class="op">=</span> <span class="st">"29N"</span>, year <span class="op">=</span> <span class="fl">2023</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ESRI legend (verify from documentation):</span></span>
<span><span class="co"># 1 = Water</span></span>
<span><span class="co"># 2 = Trees</span></span>
<span><span class="co"># 3 = Grass</span></span>
<span><span class="co"># 4 = Flooded Vegetation</span></span>
<span><span class="co"># 5 = Crops</span></span>
<span><span class="co"># 6 = Scrub/Shrub</span></span>
<span><span class="co"># 7 = Built Area</span></span>
<span><span class="co"># 8 = Bare Ground</span></span>
<span><span class="co"># 9 = Snow/Ice</span></span>
<span><span class="co"># 10 = Clouds</span></span>
<span></span>
<span><span class="co"># Extract forest (Trees class)</span></span>
<span><span class="va">esri_forest</span> <span class="op">&lt;-</span> <span class="va">esri_lc_2023</span> <span class="op">==</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Extract savanna (Grass + Scrub/Shrub)</span></span>
<span><span class="va">esri_savanna</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">esri_lc_2023</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">esri_lc_2023</span> <span class="op">==</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggregate to MODIS resolution</span></span>
<span><span class="va">esri_forest_500m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/aggregate.html">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="va">esri_forest</span>,</span>
<span>  fact <span class="op">=</span> <span class="fl">50</span>,  <span class="co"># 10m to 500m</span></span>
<span>  fun <span class="op">=</span> <span class="va">mean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">esri_savanna_500m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/aggregate.html">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="va">esri_savanna</span>,</span>
<span>  fact <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">mean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate agreement with MODIS</span></span>
<span><span class="co"># (Code similar to GLAD validation above)</span></span>
<span></span>
<span><span class="co"># Overlay with burned areas</span></span>
<span><span class="co"># Areas of disagreement may indicate:</span></span>
<span><span class="co"># - MODIS misclassification</span></span>
<span><span class="co"># - ESRI misclassification</span></span>
<span><span class="co"># - Actual mixed pixels (forest edge, mosaic)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-eutrees-validation" class="level3" data-number="2.5.3"><h3 data-number="2.5.3" class="anchored" data-anchor-id="sec-veg-eutrees-validation">
<span class="header-section-number">2.5.3</span> EU-Trees4F Species Distribution</h3>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cidree.github.io/forestdata/">forestdata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download species distribution for key European forest types</span></span>
<span><span class="co"># Example: Pinus pinaster (Maritime Pine) - fire-prone species</span></span>
<span></span>
<span><span class="va">pinus_pinaster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cidree.github.io/forestdata/reference/fd_forest_eutrees4f.html">fd_forest_eutrees4f</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="st">"Pinus pinaster"</span>,</span>
<span>  period <span class="op">=</span> <span class="st">"2005"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"prob"</span>,</span>
<span>  distrib <span class="op">=</span> <span class="st">"nat"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># High probability areas should align with "Other Forest" classification</span></span>
<span><span class="co"># (Pinus pinaster = Evergreen Needleleaf in Portugal/Spain)</span></span>
<span></span>
<span><span class="co"># Overlay with MODIS forest fires</span></span>
<span><span class="co"># Expect fires in areas with:</span></span>
<span><span class="co"># - High Pinus pinaster probability</span></span>
<span><span class="co"># - MODIS Evergreen Needleleaf classification (class 1)</span></span>
<span><span class="co"># - Mediterranean climate zone</span></span>
<span></span>
<span><span class="co"># This validates:</span></span>
<span><span class="co"># 1. MODIS correctly classifies needleleaf forests</span></span>
<span><span class="co"># 2. These forests are burning (expected for fire-adapted species)</span></span>
<span><span class="co"># 3. Climate stratification is appropriate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-chorological" class="level3" data-number="2.5.4"><h3 data-number="2.5.4" class="anchored" data-anchor-id="sec-veg-chorological">
<span class="header-section-number">2.5.4</span> Chorological Maps for Forest Type Verification</h3>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cidree.github.io/forestdata/">forestdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download chorological maps for dominant European tree species</span></span>
<span><span class="va">quercus_suber</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cidree.github.io/forestdata/reference/fd_forest_chorological.html">fd_forest_chorological</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="st">"Quercus suber"</span>,  <span class="co"># Cork Oak</span></span>
<span>  range <span class="op">=</span> <span class="st">"nat"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pinus_pinaster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cidree.github.io/forestdata/reference/fd_forest_chorological.html">fd_forest_chorological</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="st">"Pinus pinaster"</span>,  <span class="co"># Maritime Pine</span></span>
<span>  range <span class="op">=</span> <span class="st">"nat"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot species ranges</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">quercus_suber</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"green"</span>, main <span class="op">=</span> <span class="st">"Cork Oak Native Range"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pinus_pinaster</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"blue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay with MODIS forest classification</span></span>
<span><span class="co"># Cork Oak (broadleaf evergreen) should align with IGBP class 2</span></span>
<span><span class="co"># Maritime Pine (needleleaf evergreen) should align with IGBP class 1</span></span>
<span></span>
<span><span class="co"># Extract MODIS classification within species ranges</span></span>
<span><span class="co"># (Requires converting MODIS to vector or resampling species to raster)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section></section><section id="sec-veg-workflow" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="sec-veg-workflow">
<span class="header-section-number">2.6</span> Complete Vegetation Classification Workflow</h2>
<section id="sec-veg-pipeline" class="level3" data-number="2.6.1"><h3 data-number="2.6.1" class="anchored" data-anchor-id="sec-veg-pipeline">
<span class="header-section-number">2.6.1</span> Integrated Processing Pipeline</h3>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ============================================================</span></span>
<span><span class="co"># IPCC Tier 1 Vegetation Classification Pipeline</span></span>
<span><span class="co"># Integrates: MCD64A1 + MCD12Q1 + FAO Zones + HWSD</span></span>
<span><span class="co"># ============================================================</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee/">rgee</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. LOAD INPUTS ----------------------------------------------</span></span>
<span><span class="co"># Burned area (from Chapter 1)</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fl">2023</span></span>
<span><span class="va">mcd64</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">ImageCollection</span><span class="op">(</span><span class="st">"MODIS/061/MCD64A1"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">filterDate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Land cover</span></span>
<span><span class="va">lc</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">ImageCollection</span><span class="op">(</span><span class="st">"MODIS/061/MCD12Q1"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">filterDate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-12-31"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">first</span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="st">"LC_Type1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Country boundary</span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">FeatureCollection</span><span class="op">(</span><span class="st">"FAO/GAUL/2015/level0"</span><span class="op">)</span></span>
<span><span class="va">country_name</span> <span class="op">&lt;-</span> <span class="st">"Portugal"</span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="va">countries</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Filter</span><span class="op">$</span><span class="fu">eq</span><span class="op">(</span><span class="st">"ADM0_NAME"</span>, <span class="va">country_name</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. PROCESS BURNED AREA --------------------------------------</span></span>
<span><span class="co"># Quality filter and annual aggregation (from Chapter 1)</span></span>
<span><span class="va">filterQuality</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mask</span> <span class="op">&lt;-</span> <span class="va">img</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"Burn_Date_Uncertainty"</span><span class="op">)</span><span class="op">$</span><span class="fu">lt</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">And</span><span class="op">(</span><span class="va">img</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"BurnDate"</span><span class="op">)</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">img</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">mask</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">annual_burn</span> <span class="op">&lt;-</span> <span class="va">mcd64</span><span class="op">$</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">filterQuality</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="st">"BurnDate"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">max</span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">selfMask</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. CLASSIFY VEGETATION TYPES --------------------------------</span></span>
<span></span>
<span><span class="co"># 3a. Forest Fires</span></span>
<span><span class="va">forest_mask</span> <span class="op">&lt;-</span> <span class="va">lc</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Humid Tropical Forest (using climate proxy)</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio01"</span><span class="op">)</span></span>
<span><span class="va">precip</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">Image</span><span class="op">(</span><span class="st">"WORLDCLIM/V1/BIO"</span><span class="op">)</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"bio12"</span><span class="op">)</span></span>
<span><span class="va">humid_tropical</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">180</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">precip</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="fl">1500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">htf_fires</span> <span class="op">&lt;-</span> <span class="va">annual_burn</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">forest_mask</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">humid_tropical</span><span class="op">)</span></span>
<span></span>
<span><span class="va">other_forest_fires</span> <span class="op">&lt;-</span> <span class="va">annual_burn</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">forest_mask</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">updateMask</span><span class="op">(</span><span class="va">humid_tropical</span><span class="op">$</span><span class="fu">Not</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3b. Savanna Fires</span></span>
<span><span class="va">savanna_mask</span> <span class="op">&lt;-</span> <span class="va">lc</span><span class="op">$</span><span class="fu">gte</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">$</span><span class="fu">And</span><span class="op">(</span><span class="va">lc</span><span class="op">$</span><span class="fu">lte</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">savanna_fires</span> <span class="op">&lt;-</span> <span class="va">annual_burn</span><span class="op">$</span><span class="fu">updateMask</span><span class="op">(</span><span class="va">savanna_mask</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3c. Organic Soil Fires (SE Asia only in FAOSTAT)</span></span>
<span><span class="co"># Skip if not in SE Asia, or implement if needed</span></span>
<span></span>
<span><span class="co"># 4. CALCULATE AREAS ------------------------------------------</span></span>
<span><span class="va">calculateArea</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">image</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">area</span> <span class="op">&lt;-</span> <span class="va">image</span><span class="op">$</span></span>
<span>    <span class="fu">multiply</span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="va">Image</span><span class="op">$</span><span class="fu">pixelArea</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">divide</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">reduceRegion</span><span class="op">(</span></span>
<span>      reducer <span class="op">=</span> <span class="va">ee</span><span class="op">$</span><span class="va">Reducer</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      geometry <span class="op">=</span> <span class="va">aoi</span>,</span>
<span>      scale <span class="op">=</span> <span class="fl">500</span>,</span>
<span>      maxPixels <span class="op">=</span> <span class="fl">1e9</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ee</span><span class="op">$</span><span class="fu">Feature</span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    fire_type <span class="op">=</span> <span class="va">name</span>,</span>
<span>    area_ha <span class="op">=</span> <span class="va">area</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="st">"burned"</span><span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="va">year</span>,</span>
<span>    country <span class="op">=</span> <span class="va">country_name</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">FeatureCollection</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">calculateArea</span><span class="op">(</span><span class="va">htf_fires</span>, <span class="st">"Humid_Tropical_Forest"</span><span class="op">)</span>,</span>
<span>  <span class="fu">calculateArea</span><span class="op">(</span><span class="va">other_forest_fires</span>, <span class="st">"Other_Forest"</span><span class="op">)</span>,</span>
<span>  <span class="fu">calculateArea</span><span class="op">(</span><span class="va">savanna_fires</span>, <span class="st">"Savanna"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. EXPORT RESULTS -------------------------------------------</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_as_sf.html">ee_as_sf</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save to file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span></span>
<span>  <span class="va">results_df</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">country_name</span>, <span class="st">"_VegetationClassification_"</span>, <span class="va">year</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 6. VISUALIZE ------------------------------------------------</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">centerObject</span><span class="op">(</span><span class="va">aoi</span>, zoom <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">htf_fires</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span>, <span class="st">"Humid Tropical Forest Fires"</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">other_forest_fires</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>, <span class="st">"Other Forest Fires"</span><span class="op">)</span></span>
<span><span class="va">Map</span><span class="op">$</span><span class="fu">addLayer</span><span class="op">(</span><span class="va">savanna_fires</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span>, <span class="st">"Savanna Fires"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-veg-output" class="level3" data-number="2.6.2"><h3 data-number="2.6.2" class="anchored" data-anchor-id="sec-veg-output">
<span class="header-section-number">2.6.2</span> Output Format for Chapter 3</h3>
<p>Required outputs for fuel biomass calculation (Chapter 3):</p>
<hr></section></section><section id="sec-veg-qc" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="sec-veg-qc">
<span class="header-section-number">2.7</span> Quality Control and Uncertainty</h2>
<section id="sec-veg-uncertainty-assess" class="level3" data-number="2.7.1"><h3 data-number="2.7.1" class="anchored" data-anchor-id="sec-veg-uncertainty-assess">
<span class="header-section-number">2.7.1</span> Classification Uncertainty Assessment</h3>
<p>Sources of uncertainty:</p>
<ol type="1">
<li>Land cover classification error: ±10-15% (MCD12Q1 validation)</li>
<li>Burned area overlay error: ±2-5% (geometric registration)</li>
<li>Ecological zone delineation: ±5-10% (climate proxy vs. official zones)</li>
<li>Temporal mismatch: Land cover annual vs.&nbsp;monthly burns</li>
</ol>
<p>Total uncertainty (quadrature): <span class="math display">\[
U_{classification}^2 = U_{landcover}^2 + U_{overlay}^2 + U_{ecozone}^2
\]</span></p>
<p>Typical result: ±15-20% uncertainty in vegetation type assignment</p>
</section><section id="sec-veg-qc-checklist" class="level3" data-number="2.7.2"><h3 data-number="2.7.2" class="anchored" data-anchor-id="sec-veg-qc-checklist">
<span class="header-section-number">2.7.2</span> QC Checklist</h3>
<p>Pre-classification:</p>
<ul>
<li>Burned area and land cover from same year</li>
<li>Land cover projection matches burned area</li>
<li>All forest classes (1-5) included in forest mask</li>
<li>All savanna classes (6-10) included in savanna mask</li>
</ul>
<p>Classification:</p>
<ul>
<li>Mutually exclusive categories (no pixel in multiple categories)</li>
<li>Complete coverage (all burned pixels classified)</li>
<li>Climate zones applied correctly</li>
<li>Organic soils restricted to validated regions</li>
</ul>
<p>Post-classification:</p>
<ul>
<li>Area totals match Chapter 1 burned area</li>
<li>No negative or unrealistic values</li>
<li>Results comparable to previous years (if available)</li>
<li>Validation with independent data completed</li>
</ul>
<hr></section></section><section id="sec-veg-summary" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="sec-veg-summary">
<span class="header-section-number">2.8</span> Chapter Summary and Next Steps</h2>
<section id="sec-veg-takeaways" class="level3" data-number="2.8.1"><h3 data-number="2.8.1" class="anchored" data-anchor-id="sec-veg-takeaways">
<span class="header-section-number">2.8.1</span> Key Takeaways</h3>
<ol type="1">
<li>MODIS MCD12Q1 IGBP classification provides globally consistent vegetation types</li>
<li>Three IPCC fire categories: Forest (Humid Tropical + Other), Savanna, Organic Soils</li>
<li>Climate stratification required for accurate fuel consumption assignment</li>
<li>Validation using forestdata products (GLAD, ESRI, EU-Trees4F) reduces uncertainty</li>
<li>Uncertainty ~±15-20% in vegetation classification acceptable for Tier 1</li>
</ol></section><section id="sec-veg-to-chapter3" class="level3" data-number="2.8.2"><h3 data-number="2.8.2" class="anchored" data-anchor-id="sec-veg-to-chapter3">
<span class="header-section-number">2.8.2</span> Progression to Chapter 3</h3>
<p>Chapter 3: Fuel Biomass Consumption will use vegetation classifications to:</p>
<ol type="1">
<li>Assign IPCC default fuel consumption values (Table 2.4) by vegetation type</li>
<li>Apply climate-dependent stratification</li>
<li>Calculate total burned biomass: <span class="math inline">\(A \times M_B\)</span> (Activity Data × Fuel Biomass)</li>
<li>Prepare for emission factor application (Chapter 4)</li>
</ol>
<p>Critical linkage: Each vegetation type carries forward:</p>
<ul>
<li>Area burned (hectares) by vegetation type</li>
<li>Climate zone (for fuel consumption stratification)</li>
<li>Seasonal information (early/late dry season for savannas)</li>
<li>Geographic location (for validation and reporting)</li>
</ul>
<hr></section></section><section id="sec-veg-references" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="sec-veg-references">
<span class="header-section-number">2.9</span> References</h2>
<p>FAO (2012). Global ecological zones for FAO forest reporting: 2010 Update. <em>Forest Resources Assessment Working Paper 179</em>. FAO, Rome, Italy.</p>
<p>IPCC (2006). 2006 IPCC Guidelines for National Greenhouse Gas Inventories, Volume 4: Agriculture, Forestry and Other Land Use. IGES, Japan.</p>
<p>IPCC (2014). 2013 Supplement to the 2006 IPCC Guidelines for National Greenhouse Gas Inventories: Wetlands. IPCC, Switzerland.</p>
<p>Loveland, T.R., &amp; Belward, A.S. (1997). The IGBP-DIS global 1km land cover data set, DISCover: First results. <em>International Journal of Remote Sensing</em>, 18(15), 3289-3295.</p>
<p>Sulla-Menashe, D., &amp; Friedl, M.A.&nbsp;(2022). User Guide to Collection 6 MODIS Land Cover (MCD12Q1 and MCD12C1) Product. NASA LP DAAC.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-intergovernmental2006chapter" class="csl-entry" role="listitem">
Climate Change, I. P. on. (2006). <em>Chapter 2: Generic methodologies applicable to multiple land-use categories. Guidelines for national greenhouse gas inventories volume 4. Agriculture, forestry and other land use</em>.
</div>
<div id="ref-sulla2018user" class="csl-entry" role="listitem">
Sulla-Menashe, D., Friedl, M. A., et al. (2018). User guide to collection 6 MODIS land cover (MCD12Q1 and MCD12C1) product. <em>Usgs: Reston, Va, Usa</em>, <em>1</em>, 18.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/seamusrobertmurphy\.quarto\.pub\/TREES-wildfire-replications");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../01-burn-area/index.html" class="pagination-link" aria-label="Burn Area">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Burn Area</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../references/index.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">References</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Burn Area"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "**On this page**"</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: pygments</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 60</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> knitr</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ../references/references.bib</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> ../references/apa.csl</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="an">citeproc:</span><span class="co"> true</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview {.unnumbered}</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>This chapter describes the classification of burned areas</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>into IPCC-compliant vegetation categories using MODIS Land</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>Cover (MCD12Q1) and auxiliary datasets. The classification</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>determines which emission factors and fuel consumption</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>values apply to each burned pixel, directly impacting</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>greenhouse gas emission estimates.</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="fu">### IPCC Vegetation Categories {#sec-veg-ipcc-categories}</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>FAOSTAT implements three primary fire categories aligned</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>with IPCC 2006 Guidelines <span class="co">[</span><span class="ot">@intergovernmental2006chapter</span><span class="co">]</span>:</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Forest Fires:</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Humid Tropical Forest: Fires in tropical moist</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    ecological zones</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Other Forest: All remaining forest types (boreal,</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    temperate, tropical dry)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> Savanna Fires (Grassland):</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grassland</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Savanna</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Woody Savanna</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Open Shrubland</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Closed Shrubland</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>3<span class="sc">\.</span> Fires in Organic Soils:</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Peatland fires (Histosols classification)</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independent of overlying vegetation</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification Decision Tree {#sec-veg-decision-tree}</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-decision-tree</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Conceptual decision tree (not executable code)</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="co"># For each burned pixel:</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   ├─ Is pixel on Histosol? </span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   └─ YES → Organic Soil Fire</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   └─ NO → Continue</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="co">#   ├─ Is land cover = Forest (Classes 1-5)?</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   ├─ YES → Is pixel in Tropical Moist zone?</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   │   ├─ YES → Humid Tropical Forest Fire</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   │   └─ NO → Other Forest Fire</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   └─ NO → Continue</span></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   ├─ Is land cover = Grassland/Savanna/Shrubland (Classes 6-10)?</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a><span class="co">#   │   └─ YES → Savanna Fire</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a><span class="co">#   └─ ELSE → Not classified (excluded from analysis)</span></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vegetation Reporting Requirements {#sec-veg-reporting}</span></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>Following IPCC guidelines:</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Vegetation Type    <span class="pp">|</span> CO₂ <span class="pp">|</span> CH₄ <span class="pp">|</span> N₂O <span class="pp">|</span> Rationale                   <span class="pp">|</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------------|-----|-----|-----|-----------------------------|</span></span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Forest Fires       <span class="pp">|</span> ❌  <span class="pp">|</span> ✅  <span class="pp">|</span> ✅  <span class="pp">|</span> CO₂ in carbon stock changes <span class="pp">|</span></span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Savanna Fires      <span class="pp">|</span> ❌  <span class="pp">|</span> ✅  <span class="pp">|</span> ✅  <span class="pp">|</span> Assumes annual CO₂ balance  <span class="pp">|</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Organic Soil Fires <span class="pp">|</span> ✅  <span class="pp">|</span> ✅  <span class="pp">|</span> ❌  <span class="pp">|</span> Per Wetlands Supplement     <span class="pp">|</span></span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>Key principle: CO₂ from non-stand-replacing fires assumed</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>balanced by regrowth within one year (IPCC 2019, Section</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>2.4).</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## MODIS Land Cover Classification {#sec-veg-modis}</span></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a><span class="fu">### MCD12Q1 IGBP Classification Scheme {#sec-veg-igbp}</span></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Product Overview {#sec-veg-mcd12q1-overview}</span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GEE Asset: <span class="in">`MODIS/061/MCD12Q1`</span></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spatial Resolution: 500m</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal Resolution: Annual (2001-present)</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Classification System: Land Cover Type 1 - IGBP</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>    (International Geosphere-Biosphere Programme)</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Algorithm: Supervised classification using Random</span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>        Forest trained on reference sites</span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overall Accuracy: \~75% globally <span class="co">[</span><span class="ot">@sulla2018user</span><span class="co">]</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a><span class="fu">### IGBP Burnable Classes</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>Forest Classes (1-5):</span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Class <span class="pp">|</span> Name <span class="pp">|</span> IPCC Category <span class="pp">|</span> Fuel Consumption (t ha⁻¹) <span class="pp">|</span></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------|------------|-------------|-------------------------|</span></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 <span class="pp">|</span> Evergreen Needleleaf Forests <span class="pp">|</span> Other Forest <span class="pp">|</span> 41.0 (mean) <span class="pp">|</span></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> Evergreen Broadleaf Forests <span class="pp">|</span> Humid Tropical Forest <span class="pp">|</span> 119.6 (mean) <span class="pp">|</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> Deciduous Needleleaf Forests <span class="pp">|</span> Other Forest <span class="pp">|</span> 41.0 (mean) <span class="pp">|</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> Deciduous Broadleaf Forests <span class="pp">|</span> Other/Tropical (zone-dependent) <span class="pp">|</span> 69.4-119.6 <span class="pp">|</span></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5 <span class="pp">|</span> Mixed Forests <span class="pp">|</span> Other Forest <span class="pp">|</span> 50.4 (mean) <span class="pp">|</span></span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>Grassland/Savanna Classes (6-10):</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Class <span class="pp">|</span> Name <span class="pp">|</span> IPCC Category <span class="pp">|</span> Fuel Consumption (t ha⁻¹) <span class="pp">|</span></span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a><span class="pp">|----|----|----|----|</span></span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 6 <span class="pp">|</span> Closed Shrublands <span class="pp">|</span> Savanna (Shrubland) <span class="pp">|</span> 14.3 (mean) <span class="pp">|</span></span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 7 <span class="pp">|</span> Open Shrublands <span class="pp">|</span> Savanna (Shrubland) <span class="pp">|</span> 14.3 (mean) <span class="pp">|</span></span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 8 <span class="pp">|</span> Woody Savannas <span class="pp">|</span> Savanna (Woody) <span class="pp">|</span> 2.6-4.6 (season) <span class="pp">|</span></span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 9 <span class="pp">|</span> Savannas <span class="pp">|</span> Savanna <span class="pp">|</span> 2.1-10.0 (season) <span class="pp">|</span></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 10 <span class="pp">|</span> Grasslands <span class="pp">|</span> Savanna (Grassland) <span class="pp">|</span> 2.1-10.0 (season) <span class="pp">|</span></span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>Excluded Classes:</span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Class <span class="pp">|</span> Name <span class="pp">|</span> Reason for Exclusion <span class="pp">|</span></span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a><span class="pp">|----|----|----|</span></span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0 <span class="pp">|</span> Water <span class="pp">|</span> Not burnable <span class="pp">|</span></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 11 <span class="pp">|</span> Permanent Wetlands <span class="pp">|</span> Handled separately if Histosol <span class="pp">|</span></span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 12 <span class="pp">|</span> Croplands <span class="pp">|</span> Agricultural fires (separate category) <span class="pp">|</span></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 13 <span class="pp">|</span> Urban and Built-up <span class="pp">|</span> Fire prevention/suppression active <span class="pp">|</span></span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 14 <span class="pp">|</span> Cropland/Natural Vegetation Mosaics <span class="pp">|</span> Ambiguous, often excluded <span class="pp">|</span></span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 15 <span class="pp">|</span> Permanent Snow and Ice <span class="pp">|</span> Not burnable <span class="pp">|</span></span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 16 <span class="pp">|</span> Barren <span class="pp">|</span> Insufficient fuel <span class="pp">|</span></span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 17 <span class="pp">|</span> Unclassified <span class="pp">|</span> No data <span class="pp">|</span></span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Earth Engine: MCD12Q1 {#sec-veg-gee-access}</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-mcd12q1-access</span></span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Load MODIS Land Cover"</span></span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgee)</span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a><span class="fu">ee_Initialize</span>()</span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Load land cover collection</span></span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>landCover <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">"MODIS/061/MCD12Q1"</span>)</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Select IGBP classification (Type 1)</span></span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>igbp <span class="ot">&lt;-</span> landCover<span class="sc">$</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)</span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Get land cover for specific year (example: 2023)</span></span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>lc_2023 <span class="ot">&lt;-</span> igbp<span class="sc">$</span></span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="st">"2023-01-01"</span>, <span class="st">"2023-12-31"</span>)<span class="sc">$</span></span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">first</span>()</span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>lc_vis <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="dv">1</span>,</span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="dv">17</span>,</span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(</span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">'05450a'</span>, <span class="st">'086a10'</span>, <span class="st">'54a708'</span>, <span class="st">'78d203'</span>, <span class="st">'009900'</span>,  <span class="co"># Forests 1-5</span></span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">'c6b044'</span>, <span class="st">'dcd159'</span>, <span class="st">'dade48'</span>, <span class="st">'fbff13'</span>, <span class="st">'b6ff05'</span>,  <span class="co"># Savanna/Grass 6-10</span></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">'c24f44'</span>, <span class="st">'a5a5a5'</span>, <span class="st">'ff6d4c'</span>, <span class="st">'69fff8'</span>, <span class="st">'f9ffa4'</span>,  <span class="co"># Other 11-15</span></span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1c0dff'</span>, <span class="st">'ffffff'</span>                                   <span class="co"># Barren/Unclass 16-17</span></span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(lc_2023, lc_vis, <span class="st">"IGBP Land Cover 2023"</span>)</span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a><span class="fu">### Land Cover Validation and Uncertainty {#sec-veg-lc-uncertainty}</span></span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>Known Classification Issues:</span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Woody Savanna vs. Open Forest: Confusion in transition</span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>    zones</span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Grassland vs. Cropland: Agricultural areas misclassified</span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Seasonal Deciduous Forests: May shift between</span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a>    forest/savanna</span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Temporal Lag: Land use changes not immediately reflected</span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a>Regional Accuracy (Sulla-Menashe &amp; Friedl, 2022):</span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Region        <span class="pp">|</span> Overall Accuracy <span class="pp">|</span> Forest Accuracy <span class="pp">|</span> Savanna Accuracy <span class="pp">|</span></span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------|------------------|-----------------|------------------|</span></span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Africa        <span class="pp">|</span> 73%              <span class="pp">|</span> 68%             <span class="pp">|</span> 78%              <span class="pp">|</span></span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> South America <span class="pp">|</span> 77%              <span class="pp">|</span> 82%             <span class="pp">|</span> 71%              <span class="pp">|</span></span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Europe        <span class="pp">|</span> 79%              <span class="pp">|</span> 86%             <span class="pp">|</span> 65%              <span class="pp">|</span></span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Asia          <span class="pp">|</span> 74%              <span class="pp">|</span> 75%             <span class="pp">|</span> 73%              <span class="pp">|</span></span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> North America <span class="pp">|</span> 81%              <span class="pp">|</span> 88%             <span class="pp">|</span> 74%              <span class="pp">|</span></span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Forest Fire Classification {#sec-veg-forest}</span></span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forest Type Identification {#sec-veg-forest-identify}</span></span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-forest-classification</span></span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Classify forest fires"</span></span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Define forest classes (IGBP 1-5)</span></span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a>FOREST_CLASSES <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to extract forest mask</span></span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a>extractForest <span class="ot">&lt;-</span> <span class="cf">function</span>(lc_image) {</span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a>  lc <span class="ot">&lt;-</span> lc_image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)</span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create forest mask</span></span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a>  forest_mask <span class="ot">&lt;-</span> lc<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">1</span>)<span class="sc">$</span>  <span class="co"># Evergreen Needleleaf</span></span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Or</span>(lc<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">2</span>))<span class="sc">$</span>           <span class="co"># Evergreen Broadleaf</span></span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Or</span>(lc<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">3</span>))<span class="sc">$</span>           <span class="co"># Deciduous Needleleaf</span></span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Or</span>(lc<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">4</span>))<span class="sc">$</span>           <span class="co"># Deciduous Broadleaf</span></span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Or</span>(lc<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">5</span>))            <span class="co"># Mixed Forests</span></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(forest_mask<span class="sc">$</span><span class="fu">rename</span>(<span class="st">"forest_mask"</span>))</span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to land cover</span></span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a>forest_mask_2023 <span class="ot">&lt;-</span> <span class="fu">extractForest</span>(lc_2023)</span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned area (from Chapter 1)</span></span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming annual_burned_2023 is available from Chapter 1</span></span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a>forest_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span></span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(forest_mask_2023)</span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(</span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a>  forest_fires_2023,</span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"red"</span>),</span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Forest Fires 2023"</span></span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Humid Tropical Forest Delineation {#sec-veg-humid-tropical}</span></span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FAO-FRA Global Ecological Zones {#sec-veg-fao-ecozones}</span></span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a>Dataset: FAO-FRA Global Ecological Zones 2010 Update</span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a>Tropical Moist Zones (for Humid Tropical Forest):</span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tropical rainforest</span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tropical moist deciduous forest</span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tropical mountain systems (in moist zones)</span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>Implementation:</span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-humid-tropical</span></span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Identify Humid Tropical Forest fires"</span></span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: FAO-FRA zones not directly in GEE</span></span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative 1: Use climate proxy (precipitation + temperature)</span></span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative 2: Upload FAO zones as asset</span></span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a><span class="co"># METHOD 1: Climate-based proxy</span></span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Load WorldClim precipitation</span></span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a>precip <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio12"</span>)  <span class="co"># Annual precip</span></span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Load temperature</span></span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio01"</span>)  <span class="co"># Annual mean temp</span></span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Define tropical moist criteria (simplified)</span></span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Tropical: Mean annual temp &gt; 18°C</span></span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Moist: Annual precip &gt; 1500mm</span></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a>tropical <span class="ot">&lt;-</span> temp<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">180</span>)  <span class="co"># WorldClim temp in °C * 10</span></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>moist <span class="ot">&lt;-</span> precip<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">1500</span>)</span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>humid_tropical_mask <span class="ot">&lt;-</span> tropical<span class="sc">$</span><span class="fu">And</span>(moist)</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with forest mask</span></span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>humid_tropical_forest <span class="ot">&lt;-</span> forest_mask_2023<span class="sc">$</span><span class="fu">And</span>(humid_tropical_mask)</span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a><span class="co"># Other forest = all forests NOT in humid tropical zones</span></span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a>other_forest <span class="ot">&lt;-</span> forest_mask_2023<span class="sc">$</span><span class="fu">And</span>(humid_tropical_mask<span class="sc">$</span><span class="fu">Not</span>())</span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned areas</span></span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>htf_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span><span class="fu">updateMask</span>(humid_tropical_forest)</span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>other_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span><span class="fu">updateMask</span>(other_forest)</span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(htf_fires_2023, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"darkred"</span>), <span class="st">"Humid Tropical Fires"</span>)</span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(other_fires_2023, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"orange"</span>), <span class="st">"Other Forest Fires"</span>)</span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-fao-zones-asset</span></span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Using FAO-FRA zones as GEE asset (if available)"</span></span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a><span class="co"># If FAO-FRA zones uploaded as asset</span></span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a><span class="co"># (User would need to upload this manually)</span></span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Load FAO zones (example path)</span></span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>fao_zones <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">FeatureCollection</span>(<span class="st">"users/your_username/FAO_FRA_EcoZones"</span>)</span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to tropical moist zones</span></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>tropical_moist_zones <span class="ot">&lt;-</span> fao_zones<span class="sc">$</span><span class="fu">filter</span>(</span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>  ee<span class="sc">$</span>Filter<span class="sc">$</span><span class="fu">inList</span>(<span class="st">"GEZ_NAME"</span>, <span class="fu">list</span>(</span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tropical rainforest"</span>,</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tropical moist deciduous forest"</span>,</span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tropical mountain systems"</span></span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Rasterize to match MODIS resolution</span></span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a>tropical_moist_raster <span class="ot">&lt;-</span> tropical_moist_zones<span class="sc">$</span></span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduceToImage</span>(</span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">properties =</span> <span class="fu">list</span>(<span class="st">"GEZ_CODE"</span>),</span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">first</span>()</span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reproject</span>(<span class="at">crs =</span> lc_2023<span class="sc">$</span><span class="fu">projection</span>(), <span class="at">scale =</span> <span class="dv">500</span>)</span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mask</span></span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a>humid_tropical_mask_fao <span class="ot">&lt;-</span> tropical_moist_raster<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">0</span>)</span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to forest fires</span></span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a>htf_fires_fao <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span></span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(forest_mask_2023)<span class="sc">$</span></span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(humid_tropical_mask_fao)</span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forest Fire Area Calculation {#sec-veg-forest-area}</span></span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-353"><a href="#cb16-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-354"><a href="#cb16-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-355"><a href="#cb16-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-forest-area-calc</span></span>
<span id="cb16-356"><a href="#cb16-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Calculate forest fire areas by type"</span></span>
<span id="cb16-357"><a href="#cb16-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-358"><a href="#cb16-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Define area of interest (from Chapter 1)</span></span>
<span id="cb16-359"><a href="#cb16-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'aoi' is defined (e.g., country boundary)</span></span>
<span id="cb16-360"><a href="#cb16-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-361"><a href="#cb16-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate area</span></span>
<span id="cb16-362"><a href="#cb16-362" aria-hidden="true" tabindex="-1"></a>calculateForestFireArea <span class="ot">&lt;-</span> <span class="cf">function</span>(fire_image, mask, name) {</span>
<span id="cb16-363"><a href="#cb16-363" aria-hidden="true" tabindex="-1"></a>  area_ha <span class="ot">&lt;-</span> fire_image<span class="sc">$</span></span>
<span id="cb16-364"><a href="#cb16-364" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateMask</span>(mask)<span class="sc">$</span></span>
<span id="cb16-365"><a href="#cb16-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">multiply</span>(ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">pixelArea</span>()<span class="sc">$</span><span class="fu">divide</span>(<span class="dv">10000</span>))<span class="sc">$</span></span>
<span id="cb16-366"><a href="#cb16-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduceRegion</span>(</span>
<span id="cb16-367"><a href="#cb16-367" aria-hidden="true" tabindex="-1"></a>      <span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">sum</span>(),</span>
<span id="cb16-368"><a href="#cb16-368" aria-hidden="true" tabindex="-1"></a>      <span class="at">geometry =</span> aoi,</span>
<span id="cb16-369"><a href="#cb16-369" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="dv">500</span>,</span>
<span id="cb16-370"><a href="#cb16-370" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxPixels =</span> <span class="fl">1e9</span></span>
<span id="cb16-371"><a href="#cb16-371" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-372"><a href="#cb16-372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-373"><a href="#cb16-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ee<span class="sc">$</span><span class="fu">Feature</span>(<span class="cn">NULL</span>, <span class="fu">list</span>(</span>
<span id="cb16-374"><a href="#cb16-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_type =</span> name,</span>
<span id="cb16-375"><a href="#cb16-375" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_ha =</span> area_ha<span class="sc">$</span><span class="fu">get</span>(<span class="st">"burned"</span>)</span>
<span id="cb16-376"><a href="#cb16-376" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb16-377"><a href="#cb16-377" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-378"><a href="#cb16-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-379"><a href="#cb16-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate areas</span></span>
<span id="cb16-380"><a href="#cb16-380" aria-hidden="true" tabindex="-1"></a>htf_area <span class="ot">&lt;-</span> <span class="fu">calculateForestFireArea</span>(</span>
<span id="cb16-381"><a href="#cb16-381" aria-hidden="true" tabindex="-1"></a>  annual_burned_2023, </span>
<span id="cb16-382"><a href="#cb16-382" aria-hidden="true" tabindex="-1"></a>  humid_tropical_forest,</span>
<span id="cb16-383"><a href="#cb16-383" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Humid Tropical Forest"</span></span>
<span id="cb16-384"><a href="#cb16-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-385"><a href="#cb16-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-386"><a href="#cb16-386" aria-hidden="true" tabindex="-1"></a>other_forest_area <span class="ot">&lt;-</span> <span class="fu">calculateForestFireArea</span>(</span>
<span id="cb16-387"><a href="#cb16-387" aria-hidden="true" tabindex="-1"></a>  annual_burned_2023,</span>
<span id="cb16-388"><a href="#cb16-388" aria-hidden="true" tabindex="-1"></a>  other_forest,</span>
<span id="cb16-389"><a href="#cb16-389" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other Forest"</span></span>
<span id="cb16-390"><a href="#cb16-390" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-391"><a href="#cb16-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-392"><a href="#cb16-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb16-393"><a href="#cb16-393" aria-hidden="true" tabindex="-1"></a>forest_fire_stats <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">FeatureCollection</span>(<span class="fu">list</span>(</span>
<span id="cb16-394"><a href="#cb16-394" aria-hidden="true" tabindex="-1"></a>  htf_area,</span>
<span id="cb16-395"><a href="#cb16-395" aria-hidden="true" tabindex="-1"></a>  other_forest_area</span>
<span id="cb16-396"><a href="#cb16-396" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb16-397"><a href="#cb16-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-398"><a href="#cb16-398" aria-hidden="true" tabindex="-1"></a><span class="co"># Export or retrieve</span></span>
<span id="cb16-399"><a href="#cb16-399" aria-hidden="true" tabindex="-1"></a>forest_results <span class="ot">&lt;-</span> <span class="fu">ee_as_sf</span>(forest_fire_stats) <span class="sc">%&gt;%</span></span>
<span id="cb16-400"><a href="#cb16-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-401"><a href="#cb16-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb16-402"><a href="#cb16-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-403"><a href="#cb16-403" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(forest_results)</span>
<span id="cb16-404"><a href="#cb16-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-405"><a href="#cb16-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-406"><a href="#cb16-406" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-407"><a href="#cb16-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-408"><a href="#cb16-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Savanna Fire Classification {#sec-veg-savanna}</span></span>
<span id="cb16-409"><a href="#cb16-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-410"><a href="#cb16-410" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grassland and Woody Vegetation Types {#sec-veg-savanna-types}</span></span>
<span id="cb16-411"><a href="#cb16-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-414"><a href="#cb16-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-415"><a href="#cb16-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-416"><a href="#cb16-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-savanna-classification</span></span>
<span id="cb16-417"><a href="#cb16-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Classify savanna fires by vegetation type"</span></span>
<span id="cb16-418"><a href="#cb16-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-419"><a href="#cb16-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Define savanna/grassland classes</span></span>
<span id="cb16-420"><a href="#cb16-420" aria-hidden="true" tabindex="-1"></a>SAVANNA_CLASSES <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-421"><a href="#cb16-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">grassland =</span> <span class="dv">10</span>,</span>
<span id="cb16-422"><a href="#cb16-422" aria-hidden="true" tabindex="-1"></a>  <span class="at">savanna =</span> <span class="dv">9</span>,</span>
<span id="cb16-423"><a href="#cb16-423" aria-hidden="true" tabindex="-1"></a>  <span class="at">woody_savanna =</span> <span class="dv">8</span>,</span>
<span id="cb16-424"><a href="#cb16-424" aria-hidden="true" tabindex="-1"></a>  <span class="at">open_shrubland =</span> <span class="dv">7</span>,</span>
<span id="cb16-425"><a href="#cb16-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">closed_shrubland =</span> <span class="dv">6</span></span>
<span id="cb16-426"><a href="#cb16-426" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-427"><a href="#cb16-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-428"><a href="#cb16-428" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract each vegetation type</span></span>
<span id="cb16-429"><a href="#cb16-429" aria-hidden="true" tabindex="-1"></a>extractSavannaType <span class="ot">&lt;-</span> <span class="cf">function</span>(lc_image, class_value, class_name) {</span>
<span id="cb16-430"><a href="#cb16-430" aria-hidden="true" tabindex="-1"></a>  mask <span class="ot">&lt;-</span> lc_image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)<span class="sc">$</span><span class="fu">eq</span>(class_value)</span>
<span id="cb16-431"><a href="#cb16-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mask<span class="sc">$</span><span class="fu">rename</span>(class_name))</span>
<span id="cb16-432"><a href="#cb16-432" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-433"><a href="#cb16-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-434"><a href="#cb16-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Create masks for each type</span></span>
<span id="cb16-435"><a href="#cb16-435" aria-hidden="true" tabindex="-1"></a>grassland_mask <span class="ot">&lt;-</span> <span class="fu">extractSavannaType</span>(lc_2023, <span class="dv">10</span>, <span class="st">"grassland"</span>)</span>
<span id="cb16-436"><a href="#cb16-436" aria-hidden="true" tabindex="-1"></a>savanna_mask <span class="ot">&lt;-</span> <span class="fu">extractSavannaType</span>(lc_2023, <span class="dv">9</span>, <span class="st">"savanna"</span>)</span>
<span id="cb16-437"><a href="#cb16-437" aria-hidden="true" tabindex="-1"></a>woody_savanna_mask <span class="ot">&lt;-</span> <span class="fu">extractSavannaType</span>(lc_2023, <span class="dv">8</span>, <span class="st">"woody_savanna"</span>)</span>
<span id="cb16-438"><a href="#cb16-438" aria-hidden="true" tabindex="-1"></a>open_shrub_mask <span class="ot">&lt;-</span> <span class="fu">extractSavannaType</span>(lc_2023, <span class="dv">7</span>, <span class="st">"open_shrubland"</span>)</span>
<span id="cb16-439"><a href="#cb16-439" aria-hidden="true" tabindex="-1"></a>closed_shrub_mask <span class="ot">&lt;-</span> <span class="fu">extractSavannaType</span>(lc_2023, <span class="dv">6</span>, <span class="st">"closed_shrubland"</span>)</span>
<span id="cb16-440"><a href="#cb16-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-441"><a href="#cb16-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined savanna mask (all types)</span></span>
<span id="cb16-442"><a href="#cb16-442" aria-hidden="true" tabindex="-1"></a>savanna_all_mask <span class="ot">&lt;-</span> grassland_mask<span class="sc">$</span></span>
<span id="cb16-443"><a href="#cb16-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Or</span>(savanna_mask)<span class="sc">$</span></span>
<span id="cb16-444"><a href="#cb16-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Or</span>(woody_savanna_mask)<span class="sc">$</span></span>
<span id="cb16-445"><a href="#cb16-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Or</span>(open_shrub_mask)<span class="sc">$</span></span>
<span id="cb16-446"><a href="#cb16-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Or</span>(closed_shrub_mask)</span>
<span id="cb16-447"><a href="#cb16-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-448"><a href="#cb16-448" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned areas</span></span>
<span id="cb16-449"><a href="#cb16-449" aria-hidden="true" tabindex="-1"></a>savanna_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span><span class="fu">updateMask</span>(savanna_all_mask)</span>
<span id="cb16-450"><a href="#cb16-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-451"><a href="#cb16-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb16-452"><a href="#cb16-452" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(</span>
<span id="cb16-453"><a href="#cb16-453" aria-hidden="true" tabindex="-1"></a>  savanna_fires_2023,</span>
<span id="cb16-454"><a href="#cb16-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"yellow"</span>),</span>
<span id="cb16-455"><a href="#cb16-455" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Savanna Fires 2023"</span></span>
<span id="cb16-456"><a href="#cb16-456" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-457"><a href="#cb16-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-458"><a href="#cb16-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-459"><a href="#cb16-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Climate Zone Stratification {#sec-veg-climate-stratification}</span></span>
<span id="cb16-460"><a href="#cb16-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-461"><a href="#cb16-461" aria-hidden="true" tabindex="-1"></a>Rationale: Fuel consumption varies by climate (IPCC Table</span>
<span id="cb16-462"><a href="#cb16-462" aria-hidden="true" tabindex="-1"></a>2.4)</span>
<span id="cb16-463"><a href="#cb16-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-464"><a href="#cb16-464" aria-hidden="true" tabindex="-1"></a>IPCC Climate Zones:</span>
<span id="cb16-465"><a href="#cb16-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-466"><a href="#cb16-466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boreal (Cold)</span>
<span id="cb16-467"><a href="#cb16-467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temperate (Warm/Cool)</span>
<span id="cb16-468"><a href="#cb16-468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tropical (Wet/Moist/Dry/Montane)</span>
<span id="cb16-469"><a href="#cb16-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-472"><a href="#cb16-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-473"><a href="#cb16-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-474"><a href="#cb16-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-climate-zones</span></span>
<span id="cb16-475"><a href="#cb16-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Apply IPCC climate zone stratification"</span></span>
<span id="cb16-476"><a href="#cb16-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-477"><a href="#cb16-477" aria-hidden="true" tabindex="-1"></a><span class="co"># Load JRC Climate Zones (IPCC-based)</span></span>
<span id="cb16-478"><a href="#cb16-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: May need to upload as asset if not in GEE catalog</span></span>
<span id="cb16-479"><a href="#cb16-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-480"><a href="#cb16-480" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: Use temperature/precipitation proxies</span></span>
<span id="cb16-481"><a href="#cb16-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Load WorldClim data</span></span>
<span id="cb16-482"><a href="#cb16-482" aria-hidden="true" tabindex="-1"></a>bio01 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio01"</span>)  <span class="co"># Annual mean temp</span></span>
<span id="cb16-483"><a href="#cb16-483" aria-hidden="true" tabindex="-1"></a>bio12 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio12"</span>)  <span class="co"># Annual precip</span></span>
<span id="cb16-484"><a href="#cb16-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-485"><a href="#cb16-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Define climate zones (simplified)</span></span>
<span id="cb16-486"><a href="#cb16-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Tropical: MAT &gt; 18°C</span></span>
<span id="cb16-487"><a href="#cb16-487" aria-hidden="true" tabindex="-1"></a>tropical_zone <span class="ot">&lt;-</span> bio01<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">180</span>)</span>
<span id="cb16-488"><a href="#cb16-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-489"><a href="#cb16-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Boreal: MAT &lt; 0°C</span></span>
<span id="cb16-490"><a href="#cb16-490" aria-hidden="true" tabindex="-1"></a>boreal_zone <span class="ot">&lt;-</span> bio01<span class="sc">$</span><span class="fu">lt</span>(<span class="dv">0</span>)</span>
<span id="cb16-491"><a href="#cb16-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-492"><a href="#cb16-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperate: Everything else</span></span>
<span id="cb16-493"><a href="#cb16-493" aria-hidden="true" tabindex="-1"></a>temperate_zone <span class="ot">&lt;-</span> bio01<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">0</span>)<span class="sc">$</span><span class="fu">And</span>(bio01<span class="sc">$</span><span class="fu">lte</span>(<span class="dv">180</span>))</span>
<span id="cb16-494"><a href="#cb16-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-495"><a href="#cb16-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to savanna fires</span></span>
<span id="cb16-496"><a href="#cb16-496" aria-hidden="true" tabindex="-1"></a>savanna_tropical <span class="ot">&lt;-</span> savanna_fires_2023<span class="sc">$</span><span class="fu">updateMask</span>(tropical_zone)</span>
<span id="cb16-497"><a href="#cb16-497" aria-hidden="true" tabindex="-1"></a>savanna_temperate <span class="ot">&lt;-</span> savanna_fires_2023<span class="sc">$</span><span class="fu">updateMask</span>(temperate_zone)</span>
<span id="cb16-498"><a href="#cb16-498" aria-hidden="true" tabindex="-1"></a>savanna_boreal <span class="ot">&lt;-</span> savanna_fires_2023<span class="sc">$</span><span class="fu">updateMask</span>(boreal_zone)</span>
<span id="cb16-499"><a href="#cb16-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-500"><a href="#cb16-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize climate-stratified fires</span></span>
<span id="cb16-501"><a href="#cb16-501" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(savanna_tropical, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"red"</span>), <span class="st">"Tropical Savanna Fires"</span>)</span>
<span id="cb16-502"><a href="#cb16-502" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(savanna_temperate, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"orange"</span>), <span class="st">"Temperate Savanna Fires"</span>)</span>
<span id="cb16-503"><a href="#cb16-503" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(savanna_boreal, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"blue"</span>), <span class="st">"Boreal Savanna Fires"</span>)</span>
<span id="cb16-504"><a href="#cb16-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-505"><a href="#cb16-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-506"><a href="#cb16-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seasonal Burn Patterns {#sec-veg-seasonal}</span></span>
<span id="cb16-507"><a href="#cb16-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-508"><a href="#cb16-508" aria-hidden="true" tabindex="-1"></a>Importance: Fuel consumption differs between early/late dry</span>
<span id="cb16-509"><a href="#cb16-509" aria-hidden="true" tabindex="-1"></a>season (IPCC Table 2.4)</span>
<span id="cb16-510"><a href="#cb16-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-511"><a href="#cb16-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Early dry season: Lower fuel consumption (2.6 t ha⁻¹</span>
<span id="cb16-512"><a href="#cb16-512" aria-hidden="true" tabindex="-1"></a>    savanna woodland)</span>
<span id="cb16-513"><a href="#cb16-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Late dry season: Higher fuel consumption (4.6 t ha⁻¹</span>
<span id="cb16-514"><a href="#cb16-514" aria-hidden="true" tabindex="-1"></a>    savanna woodland)</span>
<span id="cb16-515"><a href="#cb16-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-518"><a href="#cb16-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-519"><a href="#cb16-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-520"><a href="#cb16-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-seasonal-analysis</span></span>
<span id="cb16-521"><a href="#cb16-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Analyze seasonal fire patterns"</span></span>
<span id="cb16-522"><a href="#cb16-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-523"><a href="#cb16-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract burn month from burn date</span></span>
<span id="cb16-524"><a href="#cb16-524" aria-hidden="true" tabindex="-1"></a>extractBurnMonth <span class="ot">&lt;-</span> <span class="cf">function</span>(mcd64_image) {</span>
<span id="cb16-525"><a href="#cb16-525" aria-hidden="true" tabindex="-1"></a>  burn_date <span class="ot">&lt;-</span> mcd64_image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"BurnDate"</span>)</span>
<span id="cb16-526"><a href="#cb16-526" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-527"><a href="#cb16-527" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get image date (represents the month)</span></span>
<span id="cb16-528"><a href="#cb16-528" aria-hidden="true" tabindex="-1"></a>  img_date <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Date</span>(mcd64_image<span class="sc">$</span><span class="fu">get</span>(<span class="st">"system:time_start"</span>))</span>
<span id="cb16-529"><a href="#cb16-529" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> img_date<span class="sc">$</span><span class="fu">get</span>(<span class="st">"month"</span>)</span>
<span id="cb16-530"><a href="#cb16-530" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-531"><a href="#cb16-531" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create month band</span></span>
<span id="cb16-532"><a href="#cb16-532" aria-hidden="true" tabindex="-1"></a>  month_band <span class="ot">&lt;-</span> ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">constant</span>(month)<span class="sc">$</span></span>
<span id="cb16-533"><a href="#cb16-533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateMask</span>(burn_date<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">0</span>))<span class="sc">$</span></span>
<span id="cb16-534"><a href="#cb16-534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">"burn_month"</span>)</span>
<span id="cb16-535"><a href="#cb16-535" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-536"><a href="#cb16-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(burn_date<span class="sc">$</span><span class="fu">addBands</span>(month_band))</span>
<span id="cb16-537"><a href="#cb16-537" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-538"><a href="#cb16-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-539"><a href="#cb16-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to monthly collection (from Chapter 1)</span></span>
<span id="cb16-540"><a href="#cb16-540" aria-hidden="true" tabindex="-1"></a>mcd64_with_months <span class="ot">&lt;-</span> mcd64_faostat<span class="sc">$</span>  <span class="co"># From Chapter 1</span></span>
<span id="cb16-541"><a href="#cb16-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="st">"2023-01-01"</span>, <span class="st">"2023-12-31"</span>)<span class="sc">$</span></span>
<span id="cb16-542"><a href="#cb16-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(extractBurnMonth)</span>
<span id="cb16-543"><a href="#cb16-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-544"><a href="#cb16-544" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract months as separate images</span></span>
<span id="cb16-545"><a href="#cb16-545" aria-hidden="true" tabindex="-1"></a>month_composite <span class="ot">&lt;-</span> mcd64_with_months<span class="sc">$</span></span>
<span id="cb16-546"><a href="#cb16-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"burn_month"</span>)<span class="sc">$</span></span>
<span id="cb16-547"><a href="#cb16-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>()  <span class="co"># Takes the latest month if pixel burned multiple times</span></span>
<span id="cb16-548"><a href="#cb16-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-549"><a href="#cb16-549" aria-hidden="true" tabindex="-1"></a><span class="co"># Define seasons (example for Southern Hemisphere savanna)</span></span>
<span id="cb16-550"><a href="#cb16-550" aria-hidden="true" tabindex="-1"></a><span class="co"># Early dry season: May-July (months 5-7)</span></span>
<span id="cb16-551"><a href="#cb16-551" aria-hidden="true" tabindex="-1"></a><span class="co"># Late dry season: August-October (months 8-10)</span></span>
<span id="cb16-552"><a href="#cb16-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-553"><a href="#cb16-553" aria-hidden="true" tabindex="-1"></a>early_season <span class="ot">&lt;-</span> month_composite<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">5</span>)<span class="sc">$</span><span class="fu">And</span>(month_composite<span class="sc">$</span><span class="fu">lte</span>(<span class="dv">7</span>))</span>
<span id="cb16-554"><a href="#cb16-554" aria-hidden="true" tabindex="-1"></a>late_season <span class="ot">&lt;-</span> month_composite<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">8</span>)<span class="sc">$</span><span class="fu">And</span>(month_composite<span class="sc">$</span><span class="fu">lte</span>(<span class="dv">10</span>))</span>
<span id="cb16-555"><a href="#cb16-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-556"><a href="#cb16-556" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to savanna fires</span></span>
<span id="cb16-557"><a href="#cb16-557" aria-hidden="true" tabindex="-1"></a>savanna_early <span class="ot">&lt;-</span> savanna_fires_2023<span class="sc">$</span><span class="fu">updateMask</span>(early_season)</span>
<span id="cb16-558"><a href="#cb16-558" aria-hidden="true" tabindex="-1"></a>savanna_late <span class="ot">&lt;-</span> savanna_fires_2023<span class="sc">$</span><span class="fu">updateMask</span>(late_season)</span>
<span id="cb16-559"><a href="#cb16-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-560"><a href="#cb16-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate areas</span></span>
<span id="cb16-561"><a href="#cb16-561" aria-hidden="true" tabindex="-1"></a>early_area <span class="ot">&lt;-</span> savanna_early<span class="sc">$</span></span>
<span id="cb16-562"><a href="#cb16-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multiply</span>(ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">pixelArea</span>()<span class="sc">$</span><span class="fu">divide</span>(<span class="dv">10000</span>))<span class="sc">$</span></span>
<span id="cb16-563"><a href="#cb16-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduceRegion</span>(<span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">sum</span>(), <span class="at">geometry =</span> aoi, <span class="at">scale =</span> <span class="dv">500</span>)</span>
<span id="cb16-564"><a href="#cb16-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-565"><a href="#cb16-565" aria-hidden="true" tabindex="-1"></a>late_area <span class="ot">&lt;-</span> savanna_late<span class="sc">$</span></span>
<span id="cb16-566"><a href="#cb16-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multiply</span>(ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">pixelArea</span>()<span class="sc">$</span><span class="fu">divide</span>(<span class="dv">10000</span>))<span class="sc">$</span></span>
<span id="cb16-567"><a href="#cb16-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduceRegion</span>(<span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">sum</span>(), <span class="at">geometry =</span> aoi, <span class="at">scale =</span> <span class="dv">500</span>)</span>
<span id="cb16-568"><a href="#cb16-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-569"><a href="#cb16-569" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Early season:"</span>, early_area<span class="sc">$</span><span class="fu">getInfo</span>()<span class="sc">$</span>burned, <span class="st">"ha"</span>))</span>
<span id="cb16-570"><a href="#cb16-570" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Late season:"</span>, late_area<span class="sc">$</span><span class="fu">getInfo</span>()<span class="sc">$</span>burned, <span class="st">"ha"</span>))</span>
<span id="cb16-571"><a href="#cb16-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-572"><a href="#cb16-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-573"><a href="#cb16-573" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-574"><a href="#cb16-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-575"><a href="#cb16-575" aria-hidden="true" tabindex="-1"></a><span class="fu">## Organic Soil Fire Classification {#sec-veg-organic}</span></span>
<span id="cb16-576"><a href="#cb16-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-577"><a href="#cb16-577" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histosols Identification {#sec-veg-histosols}</span></span>
<span id="cb16-578"><a href="#cb16-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-579"><a href="#cb16-579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dataset: Harmonized World Soil Database (HWSD v1.2)</span>
<span id="cb16-580"><a href="#cb16-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Histosols: Organic soils with <span class="sc">\&gt;</span> 20-30% organic matter</span>
<span id="cb16-581"><a href="#cb16-581" aria-hidden="true" tabindex="-1"></a>    by weight</span>
<span id="cb16-582"><a href="#cb16-582" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Detection Challenge: Fires in organic soils independent</span>
<span id="cb16-583"><a href="#cb16-583" aria-hidden="true" tabindex="-1"></a>    of surface land cover</span>
<span id="cb16-584"><a href="#cb16-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-587"><a href="#cb16-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-588"><a href="#cb16-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-589"><a href="#cb16-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-histosols-access</span></span>
<span id="cb16-590"><a href="#cb16-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Identify organic soil fires"</span></span>
<span id="cb16-591"><a href="#cb16-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-592"><a href="#cb16-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: HWSD not directly in GEE</span></span>
<span id="cb16-593"><a href="#cb16-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Two approaches:</span></span>
<span id="cb16-594"><a href="#cb16-594" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Upload HWSD as asset</span></span>
<span id="cb16-595"><a href="#cb16-595" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use existing peatland datasets in GEE</span></span>
<span id="cb16-596"><a href="#cb16-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-597"><a href="#cb16-597" aria-hidden="true" tabindex="-1"></a><span class="co"># APPROACH 1: Using Global Peatland Dataset</span></span>
<span id="cb16-598"><a href="#cb16-598" aria-hidden="true" tabindex="-1"></a><span class="co"># (Example: Several peatland datasets exist in GEE catalog)</span></span>
<span id="cb16-599"><a href="#cb16-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-600"><a href="#cb16-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for peatland/wetland datasets</span></span>
<span id="cb16-601"><a href="#cb16-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Example using a hypothetical peatland layer</span></span>
<span id="cb16-602"><a href="#cb16-602" aria-hidden="true" tabindex="-1"></a><span class="co"># Actual implementation depends on available datasets</span></span>
<span id="cb16-603"><a href="#cb16-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-604"><a href="#cb16-604" aria-hidden="true" tabindex="-1"></a><span class="co"># For FAOSTAT methodology: Upload HWSD Histosols layer</span></span>
<span id="cb16-605"><a href="#cb16-605" aria-hidden="true" tabindex="-1"></a><span class="co"># (User action required)</span></span>
<span id="cb16-606"><a href="#cb16-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-607"><a href="#cb16-607" aria-hidden="true" tabindex="-1"></a><span class="co"># APPROACH 2: Simplified proxy using permanent wetlands + tropical</span></span>
<span id="cb16-608"><a href="#cb16-608" aria-hidden="true" tabindex="-1"></a>wetlands_mask <span class="ot">&lt;-</span> lc_2023<span class="sc">$</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">11</span>)  <span class="co"># Permanent wetlands</span></span>
<span id="cb16-609"><a href="#cb16-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-610"><a href="#cb16-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on Southeast Asia (where validated)</span></span>
<span id="cb16-611"><a href="#cb16-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Southeast Asia bounding box</span></span>
<span id="cb16-612"><a href="#cb16-612" aria-hidden="true" tabindex="-1"></a>sea_bbox <span class="ot">&lt;-</span> ee<span class="sc">$</span>Geometry<span class="sc">$</span><span class="fu">Rectangle</span>([<span class="dv">95</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">141</span>, <span class="dv">20</span>])</span>
<span id="cb16-613"><a href="#cb16-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-614"><a href="#cb16-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Peatland proxy: Wetlands in SE Asia lowlands</span></span>
<span id="cb16-615"><a href="#cb16-615" aria-hidden="true" tabindex="-1"></a>elevation <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"USGS/SRTMGL1_003"</span>)</span>
<span id="cb16-616"><a href="#cb16-616" aria-hidden="true" tabindex="-1"></a>lowlands <span class="ot">&lt;-</span> elevation<span class="sc">$</span><span class="fu">lt</span>(<span class="dv">100</span>)  <span class="co"># &lt; 100m elevation</span></span>
<span id="cb16-617"><a href="#cb16-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-618"><a href="#cb16-618" aria-hidden="true" tabindex="-1"></a>organic_soil_mask <span class="ot">&lt;-</span> wetlands_mask<span class="sc">$</span></span>
<span id="cb16-619"><a href="#cb16-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">And</span>(lowlands)<span class="sc">$</span></span>
<span id="cb16-620"><a href="#cb16-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clip</span>(sea_bbox)</span>
<span id="cb16-621"><a href="#cb16-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-622"><a href="#cb16-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned areas</span></span>
<span id="cb16-623"><a href="#cb16-623" aria-hidden="true" tabindex="-1"></a>organic_fires_2023 <span class="ot">&lt;-</span> annual_burned_2023<span class="sc">$</span></span>
<span id="cb16-624"><a href="#cb16-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(organic_soil_mask)</span>
<span id="cb16-625"><a href="#cb16-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-626"><a href="#cb16-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb16-627"><a href="#cb16-627" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(</span>
<span id="cb16-628"><a href="#cb16-628" aria-hidden="true" tabindex="-1"></a>  organic_fires_2023,</span>
<span id="cb16-629"><a href="#cb16-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"brown"</span>),</span>
<span id="cb16-630"><a href="#cb16-630" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organic Soil Fires 2023 (SE Asia)"</span></span>
<span id="cb16-631"><a href="#cb16-631" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-632"><a href="#cb16-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-633"><a href="#cb16-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-634"><a href="#cb16-634" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regional Constraints {#sec-veg-organic-regional}</span></span>
<span id="cb16-635"><a href="#cb16-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-636"><a href="#cb16-636" aria-hidden="true" tabindex="-1"></a>FAOSTAT approach (per methodology guide):</span>
<span id="cb16-637"><a href="#cb16-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-638"><a href="#cb16-638" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "Due to the current lack of evidence for other regions of</span></span>
<span id="cb16-639"><a href="#cb16-639" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the world, we set to 0 all the country values outside</span></span>
<span id="cb16-640"><a href="#cb16-640" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Southeastern Asia."</span></span>
<span id="cb16-641"><a href="#cb16-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-642"><a href="#cb16-642" aria-hidden="true" tabindex="-1"></a>Southeast Asian Countries (non-zero organic soil fires):</span>
<span id="cb16-643"><a href="#cb16-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-644"><a href="#cb16-644" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Indonesia</span>
<span id="cb16-645"><a href="#cb16-645" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Malaysia</span>
<span id="cb16-646"><a href="#cb16-646" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Brunei Darussalam</span>
<span id="cb16-647"><a href="#cb16-647" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>(Potentially: Philippines, Thailand, Vietnam - check</span>
<span id="cb16-648"><a href="#cb16-648" aria-hidden="true" tabindex="-1"></a>    FAOSTAT regional definition)</span>
<span id="cb16-649"><a href="#cb16-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-652"><a href="#cb16-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-653"><a href="#cb16-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-654"><a href="#cb16-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-sea-filter</span></span>
<span id="cb16-655"><a href="#cb16-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Apply Southeast Asia regional filter"</span></span>
<span id="cb16-656"><a href="#cb16-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-657"><a href="#cb16-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Load country boundaries</span></span>
<span id="cb16-658"><a href="#cb16-658" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">FeatureCollection</span>(<span class="st">"FAO/GAUL/2015/level0"</span>)</span>
<span id="cb16-659"><a href="#cb16-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-660"><a href="#cb16-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Southeast Asia countries</span></span>
<span id="cb16-661"><a href="#cb16-661" aria-hidden="true" tabindex="-1"></a>SEA_COUNTRIES <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb16-662"><a href="#cb16-662" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Indonesia"</span>,</span>
<span id="cb16-663"><a href="#cb16-663" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Malaysia"</span>,</span>
<span id="cb16-664"><a href="#cb16-664" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Brunei Darussalam"</span></span>
<span id="cb16-665"><a href="#cb16-665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add others as per FAOSTAT definition</span></span>
<span id="cb16-666"><a href="#cb16-666" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-667"><a href="#cb16-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-668"><a href="#cb16-668" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to SE Asia</span></span>
<span id="cb16-669"><a href="#cb16-669" aria-hidden="true" tabindex="-1"></a>sea_countries <span class="ot">&lt;-</span> countries<span class="sc">$</span><span class="fu">filter</span>(</span>
<span id="cb16-670"><a href="#cb16-670" aria-hidden="true" tabindex="-1"></a>  ee<span class="sc">$</span>Filter<span class="sc">$</span><span class="fu">inList</span>(<span class="st">"ADM0_NAME"</span>, SEA_COUNTRIES)</span>
<span id="cb16-671"><a href="#cb16-671" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-672"><a href="#cb16-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-673"><a href="#cb16-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip organic fires to SE Asia only</span></span>
<span id="cb16-674"><a href="#cb16-674" aria-hidden="true" tabindex="-1"></a>organic_fires_sea <span class="ot">&lt;-</span> organic_fires_2023<span class="sc">$</span><span class="fu">clip</span>(sea_countries)</span>
<span id="cb16-675"><a href="#cb16-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-676"><a href="#cb16-676" aria-hidden="true" tabindex="-1"></a><span class="co"># All organic fires outside SE Asia = 0 (per FAOSTAT)</span></span>
<span id="cb16-677"><a href="#cb16-677" aria-hidden="true" tabindex="-1"></a><span class="co"># (Achieved by clipping to SE Asia only)</span></span>
<span id="cb16-678"><a href="#cb16-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-679"><a href="#cb16-679" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area</span></span>
<span id="cb16-680"><a href="#cb16-680" aria-hidden="true" tabindex="-1"></a>organic_area_sea <span class="ot">&lt;-</span> organic_fires_sea<span class="sc">$</span></span>
<span id="cb16-681"><a href="#cb16-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multiply</span>(ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">pixelArea</span>()<span class="sc">$</span><span class="fu">divide</span>(<span class="dv">10000</span>))<span class="sc">$</span></span>
<span id="cb16-682"><a href="#cb16-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduceRegions</span>(</span>
<span id="cb16-683"><a href="#cb16-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">collection =</span> sea_countries,</span>
<span id="cb16-684"><a href="#cb16-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">sum</span>(),</span>
<span id="cb16-685"><a href="#cb16-685" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">500</span></span>
<span id="cb16-686"><a href="#cb16-686" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-687"><a href="#cb16-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-688"><a href="#cb16-688" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb16-689"><a href="#cb16-689" aria-hidden="true" tabindex="-1"></a>organic_results <span class="ot">&lt;-</span> <span class="fu">ee_as_sf</span>(organic_area_sea) <span class="sc">%&gt;%</span></span>
<span id="cb16-690"><a href="#cb16-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-691"><a href="#cb16-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ADM0_NAME, sum) <span class="sc">%&gt;%</span></span>
<span id="cb16-692"><a href="#cb16-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> ADM0_NAME, <span class="at">area_ha =</span> sum)</span>
<span id="cb16-693"><a href="#cb16-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-694"><a href="#cb16-694" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(organic_results)</span>
<span id="cb16-695"><a href="#cb16-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-696"><a href="#cb16-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-697"><a href="#cb16-697" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainty in Organic Soil Classification {#sec-veg-organic-uncertainty}</span></span>
<span id="cb16-698"><a href="#cb16-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-699"><a href="#cb16-699" aria-hidden="true" tabindex="-1"></a>High uncertainty sources (IPCC 2014 Wetlands Supplement):</span>
<span id="cb16-700"><a href="#cb16-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-701"><a href="#cb16-701" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Detection limitations:</span>
<span id="cb16-702"><a href="#cb16-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-703"><a href="#cb16-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Smoldering fires difficult to detect via optical remote</span>
<span id="cb16-704"><a href="#cb16-704" aria-hidden="true" tabindex="-1"></a>    sensing</span>
<span id="cb16-705"><a href="#cb16-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dense canopy obscures ground fires</span>
<span id="cb16-706"><a href="#cb16-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-707"><a href="#cb16-707" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Soil classification uncertainty:</span>
<span id="cb16-708"><a href="#cb16-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-709"><a href="#cb16-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>HWSD spatial resolution (\~1km) coarser than fire</span>
<span id="cb16-710"><a href="#cb16-710" aria-hidden="true" tabindex="-1"></a>    detection (500m)</span>
<span id="cb16-711"><a href="#cb16-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Organic soil depth variable within pixels</span>
<span id="cb16-712"><a href="#cb16-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Drainage status unknown (drained vs. undrained)</span>
<span id="cb16-713"><a href="#cb16-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-714"><a href="#cb16-714" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Fire depth uncertainty:</span>
<span id="cb16-715"><a href="#cb16-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-716"><a href="#cb16-716" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surface burn vs. deep peat burn</span>
<span id="cb16-717"><a href="#cb16-717" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fuel consumption highly variable: 41 ± 1.4 t ha⁻¹ (IPCC</span>
<span id="cb16-718"><a href="#cb16-718" aria-hidden="true" tabindex="-1"></a>    Table 2.6)</span>
<span id="cb16-719"><a href="#cb16-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-720"><a href="#cb16-720" aria-hidden="true" tabindex="-1"></a>FAOSTAT approach: Conservative reporting (SE Asia only)</span>
<span id="cb16-721"><a href="#cb16-721" aria-hidden="true" tabindex="-1"></a>until more validation data available</span>
<span id="cb16-722"><a href="#cb16-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-723"><a href="#cb16-723" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-724"><a href="#cb16-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-725"><a href="#cb16-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multi-Source Validation of Vegetation Classification {#sec-veg-validation}</span></span>
<span id="cb16-726"><a href="#cb16-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-727"><a href="#cb16-727" aria-hidden="true" tabindex="-1"></a><span class="fu">### GLAD Forest Height for Forest/Non-Forest Validation {#sec-veg-glad-height}</span></span>
<span id="cb16-728"><a href="#cb16-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-731"><a href="#cb16-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-732"><a href="#cb16-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-733"><a href="#cb16-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-glad-height-validation</span></span>
<span id="cb16-734"><a href="#cb16-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Validate forest classification with GLAD height"</span></span>
<span id="cb16-735"><a href="#cb16-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-736"><a href="#cb16-736" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestdata)</span>
<span id="cb16-737"><a href="#cb16-737" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb16-738"><a href="#cb16-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-739"><a href="#cb16-739" aria-hidden="true" tabindex="-1"></a><span class="co"># Download GLAD forest height (example: Portugal)</span></span>
<span id="cb16-740"><a href="#cb16-740" aria-hidden="true" tabindex="-1"></a>glad_height <span class="ot">&lt;-</span> <span class="fu">fd_forest_glad</span>(</span>
<span id="cb16-741"><a href="#cb16-741" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="sc">-</span><span class="fl">7.8</span>,</span>
<span id="cb16-742"><a href="#cb16-742" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="fl">42.7</span>,</span>
<span id="cb16-743"><a href="#cb16-743" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"height"</span>,</span>
<span id="cb16-744"><a href="#cb16-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb16-745"><a href="#cb16-745" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-746"><a href="#cb16-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-747"><a href="#cb16-747" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest threshold: &gt; 5m height (per IPCC definition)</span></span>
<span id="cb16-748"><a href="#cb16-748" aria-hidden="true" tabindex="-1"></a>glad_forest_mask <span class="ot">&lt;-</span> glad_height <span class="sc">&gt;</span> <span class="dv">5</span></span>
<span id="cb16-749"><a href="#cb16-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-750"><a href="#cb16-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample MODIS to GLAD resolution (30m) for comparison</span></span>
<span id="cb16-751"><a href="#cb16-751" aria-hidden="true" tabindex="-1"></a><span class="co"># (Or aggregate GLAD to MODIS 500m)</span></span>
<span id="cb16-752"><a href="#cb16-752" aria-hidden="true" tabindex="-1"></a>glad_forest_500m <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb16-753"><a href="#cb16-753" aria-hidden="true" tabindex="-1"></a>  glad_forest_mask,</span>
<span id="cb16-754"><a href="#cb16-754" aria-hidden="true" tabindex="-1"></a>  <span class="at">fact =</span> <span class="fu">round</span>(<span class="dv">500</span> <span class="sc">/</span> <span class="dv">30</span>),  <span class="co"># ~17x aggregation</span></span>
<span id="cb16-755"><a href="#cb16-755" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> mean  <span class="co"># Proportion of 30m pixels that are forest</span></span>
<span id="cb16-756"><a href="#cb16-756" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-757"><a href="#cb16-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-758"><a href="#cb16-758" aria-hidden="true" tabindex="-1"></a><span class="co"># Export MODIS forest from GEE for comparison</span></span>
<span id="cb16-759"><a href="#cb16-759" aria-hidden="true" tabindex="-1"></a>modis_forest_mask_r <span class="ot">&lt;-</span> <span class="fu">ee_as_rast</span>(</span>
<span id="cb16-760"><a href="#cb16-760" aria-hidden="true" tabindex="-1"></a>  forest_mask_2023,</span>
<span id="cb16-761"><a href="#cb16-761" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> ee<span class="sc">$</span>Geometry<span class="sc">$</span><span class="fu">Point</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">7.8</span>, <span class="fl">42.7</span>))<span class="sc">$</span><span class="fu">buffer</span>(<span class="dv">50000</span>),  <span class="co"># 50km radius</span></span>
<span id="cb16-762"><a href="#cb16-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="dv">500</span></span>
<span id="cb16-763"><a href="#cb16-763" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-764"><a href="#cb16-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-765"><a href="#cb16-765" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare classifications</span></span>
<span id="cb16-766"><a href="#cb16-766" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb16-767"><a href="#cb16-767" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure same extent and resolution</span></span>
<span id="cb16-768"><a href="#cb16-768" aria-hidden="true" tabindex="-1"></a>glad_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(glad_forest_500m, modis_forest_mask_r)</span>
<span id="cb16-769"><a href="#cb16-769" aria-hidden="true" tabindex="-1"></a>modis_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(modis_forest_mask_r, glad_forest_500m)</span>
<span id="cb16-770"><a href="#cb16-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-771"><a href="#cb16-771" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb16-772"><a href="#cb16-772" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(</span>
<span id="cb16-773"><a href="#cb16-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">as.factor</span>(<span class="fu">as.vector</span>(modis_crop <span class="sc">&gt;</span> <span class="dv">0</span>)),</span>
<span id="cb16-774"><a href="#cb16-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> <span class="fu">as.factor</span>(<span class="fu">as.vector</span>(glad_crop <span class="sc">&gt;</span> <span class="fl">0.5</span>))  <span class="co"># &gt;50% forest in aggregated pixel</span></span>
<span id="cb16-775"><a href="#cb16-775" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-776"><a href="#cb16-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-777"><a href="#cb16-777" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion)</span>
<span id="cb16-778"><a href="#cb16-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-779"><a href="#cb16-779" aria-hidden="true" tabindex="-1"></a><span class="co"># Kappa statistic</span></span>
<span id="cb16-780"><a href="#cb16-780" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Cohen's Kappa:"</span>, <span class="fu">round</span>(confusion<span class="sc">$</span>overall[<span class="st">"Kappa"</span>], <span class="dv">3</span>)))</span>
<span id="cb16-781"><a href="#cb16-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-782"><a href="#cb16-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-783"><a href="#cb16-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### ESRI Land Cover for High-Resolution Validation {#sec-veg-esri-validation}</span></span>
<span id="cb16-784"><a href="#cb16-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-787"><a href="#cb16-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-788"><a href="#cb16-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-789"><a href="#cb16-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-esri-lc-validation</span></span>
<span id="cb16-790"><a href="#cb16-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Validate with ESRI 10m land cover"</span></span>
<span id="cb16-791"><a href="#cb16-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-792"><a href="#cb16-792" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestdata)</span>
<span id="cb16-793"><a href="#cb16-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-794"><a href="#cb16-794" aria-hidden="true" tabindex="-1"></a><span class="co"># Download ESRI land cover (10m resolution)</span></span>
<span id="cb16-795"><a href="#cb16-795" aria-hidden="true" tabindex="-1"></a>esri_lc_2023 <span class="ot">&lt;-</span> <span class="fu">fd_landcover_esri</span>(<span class="at">utm_code =</span> <span class="st">"29N"</span>, <span class="at">year =</span> <span class="dv">2023</span>)</span>
<span id="cb16-796"><a href="#cb16-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-797"><a href="#cb16-797" aria-hidden="true" tabindex="-1"></a><span class="co"># ESRI legend (verify from documentation):</span></span>
<span id="cb16-798"><a href="#cb16-798" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = Water</span></span>
<span id="cb16-799"><a href="#cb16-799" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 = Trees</span></span>
<span id="cb16-800"><a href="#cb16-800" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 = Grass</span></span>
<span id="cb16-801"><a href="#cb16-801" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 = Flooded Vegetation</span></span>
<span id="cb16-802"><a href="#cb16-802" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 = Crops</span></span>
<span id="cb16-803"><a href="#cb16-803" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 = Scrub/Shrub</span></span>
<span id="cb16-804"><a href="#cb16-804" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 = Built Area</span></span>
<span id="cb16-805"><a href="#cb16-805" aria-hidden="true" tabindex="-1"></a><span class="co"># 8 = Bare Ground</span></span>
<span id="cb16-806"><a href="#cb16-806" aria-hidden="true" tabindex="-1"></a><span class="co"># 9 = Snow/Ice</span></span>
<span id="cb16-807"><a href="#cb16-807" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 = Clouds</span></span>
<span id="cb16-808"><a href="#cb16-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-809"><a href="#cb16-809" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract forest (Trees class)</span></span>
<span id="cb16-810"><a href="#cb16-810" aria-hidden="true" tabindex="-1"></a>esri_forest <span class="ot">&lt;-</span> esri_lc_2023 <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb16-811"><a href="#cb16-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-812"><a href="#cb16-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract savanna (Grass + Scrub/Shrub)</span></span>
<span id="cb16-813"><a href="#cb16-813" aria-hidden="true" tabindex="-1"></a>esri_savanna <span class="ot">&lt;-</span> (esri_lc_2023 <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|</span> (esri_lc_2023 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb16-814"><a href="#cb16-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-815"><a href="#cb16-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to MODIS resolution</span></span>
<span id="cb16-816"><a href="#cb16-816" aria-hidden="true" tabindex="-1"></a>esri_forest_500m <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb16-817"><a href="#cb16-817" aria-hidden="true" tabindex="-1"></a>  esri_forest,</span>
<span id="cb16-818"><a href="#cb16-818" aria-hidden="true" tabindex="-1"></a>  <span class="at">fact =</span> <span class="dv">50</span>,  <span class="co"># 10m to 500m</span></span>
<span id="cb16-819"><a href="#cb16-819" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> mean</span>
<span id="cb16-820"><a href="#cb16-820" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-821"><a href="#cb16-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-822"><a href="#cb16-822" aria-hidden="true" tabindex="-1"></a>esri_savanna_500m <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb16-823"><a href="#cb16-823" aria-hidden="true" tabindex="-1"></a>  esri_savanna,</span>
<span id="cb16-824"><a href="#cb16-824" aria-hidden="true" tabindex="-1"></a>  <span class="at">fact =</span> <span class="dv">50</span>,</span>
<span id="cb16-825"><a href="#cb16-825" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> mean</span>
<span id="cb16-826"><a href="#cb16-826" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-827"><a href="#cb16-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-828"><a href="#cb16-828" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate agreement with MODIS</span></span>
<span id="cb16-829"><a href="#cb16-829" aria-hidden="true" tabindex="-1"></a><span class="co"># (Code similar to GLAD validation above)</span></span>
<span id="cb16-830"><a href="#cb16-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-831"><a href="#cb16-831" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with burned areas</span></span>
<span id="cb16-832"><a href="#cb16-832" aria-hidden="true" tabindex="-1"></a><span class="co"># Areas of disagreement may indicate:</span></span>
<span id="cb16-833"><a href="#cb16-833" aria-hidden="true" tabindex="-1"></a><span class="co"># - MODIS misclassification</span></span>
<span id="cb16-834"><a href="#cb16-834" aria-hidden="true" tabindex="-1"></a><span class="co"># - ESRI misclassification</span></span>
<span id="cb16-835"><a href="#cb16-835" aria-hidden="true" tabindex="-1"></a><span class="co"># - Actual mixed pixels (forest edge, mosaic)</span></span>
<span id="cb16-836"><a href="#cb16-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-837"><a href="#cb16-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-838"><a href="#cb16-838" aria-hidden="true" tabindex="-1"></a><span class="fu">### EU-Trees4F Species Distribution {#sec-veg-eutrees-validation}</span></span>
<span id="cb16-839"><a href="#cb16-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-842"><a href="#cb16-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-843"><a href="#cb16-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-844"><a href="#cb16-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-eutrees-validation</span></span>
<span id="cb16-845"><a href="#cb16-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Validate European forest types with species data"</span></span>
<span id="cb16-846"><a href="#cb16-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-847"><a href="#cb16-847" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestdata)</span>
<span id="cb16-848"><a href="#cb16-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-849"><a href="#cb16-849" aria-hidden="true" tabindex="-1"></a><span class="co"># Download species distribution for key European forest types</span></span>
<span id="cb16-850"><a href="#cb16-850" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Pinus pinaster (Maritime Pine) - fire-prone species</span></span>
<span id="cb16-851"><a href="#cb16-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-852"><a href="#cb16-852" aria-hidden="true" tabindex="-1"></a>pinus_pinaster <span class="ot">&lt;-</span> <span class="fu">fd_forest_eutrees4f</span>(</span>
<span id="cb16-853"><a href="#cb16-853" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">"Pinus pinaster"</span>,</span>
<span id="cb16-854"><a href="#cb16-854" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="st">"2005"</span>,</span>
<span id="cb16-855"><a href="#cb16-855" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"prob"</span>,</span>
<span id="cb16-856"><a href="#cb16-856" aria-hidden="true" tabindex="-1"></a>  <span class="at">distrib =</span> <span class="st">"nat"</span></span>
<span id="cb16-857"><a href="#cb16-857" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-858"><a href="#cb16-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-859"><a href="#cb16-859" aria-hidden="true" tabindex="-1"></a><span class="co"># High probability areas should align with "Other Forest" classification</span></span>
<span id="cb16-860"><a href="#cb16-860" aria-hidden="true" tabindex="-1"></a><span class="co"># (Pinus pinaster = Evergreen Needleleaf in Portugal/Spain)</span></span>
<span id="cb16-861"><a href="#cb16-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-862"><a href="#cb16-862" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with MODIS forest fires</span></span>
<span id="cb16-863"><a href="#cb16-863" aria-hidden="true" tabindex="-1"></a><span class="co"># Expect fires in areas with:</span></span>
<span id="cb16-864"><a href="#cb16-864" aria-hidden="true" tabindex="-1"></a><span class="co"># - High Pinus pinaster probability</span></span>
<span id="cb16-865"><a href="#cb16-865" aria-hidden="true" tabindex="-1"></a><span class="co"># - MODIS Evergreen Needleleaf classification (class 1)</span></span>
<span id="cb16-866"><a href="#cb16-866" aria-hidden="true" tabindex="-1"></a><span class="co"># - Mediterranean climate zone</span></span>
<span id="cb16-867"><a href="#cb16-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-868"><a href="#cb16-868" aria-hidden="true" tabindex="-1"></a><span class="co"># This validates:</span></span>
<span id="cb16-869"><a href="#cb16-869" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. MODIS correctly classifies needleleaf forests</span></span>
<span id="cb16-870"><a href="#cb16-870" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. These forests are burning (expected for fire-adapted species)</span></span>
<span id="cb16-871"><a href="#cb16-871" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Climate stratification is appropriate</span></span>
<span id="cb16-872"><a href="#cb16-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-873"><a href="#cb16-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-874"><a href="#cb16-874" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chorological Maps for Forest Type Verification {#sec-veg-chorological}</span></span>
<span id="cb16-875"><a href="#cb16-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-878"><a href="#cb16-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-879"><a href="#cb16-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-880"><a href="#cb16-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-chorological-validation</span></span>
<span id="cb16-881"><a href="#cb16-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Use chorological maps to validate forest classifications"</span></span>
<span id="cb16-882"><a href="#cb16-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-883"><a href="#cb16-883" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestdata)</span>
<span id="cb16-884"><a href="#cb16-884" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb16-885"><a href="#cb16-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-886"><a href="#cb16-886" aria-hidden="true" tabindex="-1"></a><span class="co"># Download chorological maps for dominant European tree species</span></span>
<span id="cb16-887"><a href="#cb16-887" aria-hidden="true" tabindex="-1"></a>quercus_suber <span class="ot">&lt;-</span> <span class="fu">fd_forest_chorological</span>(</span>
<span id="cb16-888"><a href="#cb16-888" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">"Quercus suber"</span>,  <span class="co"># Cork Oak</span></span>
<span id="cb16-889"><a href="#cb16-889" aria-hidden="true" tabindex="-1"></a>  <span class="at">range =</span> <span class="st">"nat"</span></span>
<span id="cb16-890"><a href="#cb16-890" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-891"><a href="#cb16-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-892"><a href="#cb16-892" aria-hidden="true" tabindex="-1"></a>pinus_pinaster <span class="ot">&lt;-</span> <span class="fu">fd_forest_chorological</span>(</span>
<span id="cb16-893"><a href="#cb16-893" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">"Pinus pinaster"</span>,  <span class="co"># Maritime Pine</span></span>
<span id="cb16-894"><a href="#cb16-894" aria-hidden="true" tabindex="-1"></a>  <span class="at">range =</span> <span class="st">"nat"</span></span>
<span id="cb16-895"><a href="#cb16-895" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-896"><a href="#cb16-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-897"><a href="#cb16-897" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot species ranges</span></span>
<span id="cb16-898"><a href="#cb16-898" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(quercus_suber<span class="sc">$</span>geometry, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">main =</span> <span class="st">"Cork Oak Native Range"</span>)</span>
<span id="cb16-899"><a href="#cb16-899" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pinus_pinaster<span class="sc">$</span>geometry, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-900"><a href="#cb16-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-901"><a href="#cb16-901" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay with MODIS forest classification</span></span>
<span id="cb16-902"><a href="#cb16-902" aria-hidden="true" tabindex="-1"></a><span class="co"># Cork Oak (broadleaf evergreen) should align with IGBP class 2</span></span>
<span id="cb16-903"><a href="#cb16-903" aria-hidden="true" tabindex="-1"></a><span class="co"># Maritime Pine (needleleaf evergreen) should align with IGBP class 1</span></span>
<span id="cb16-904"><a href="#cb16-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-905"><a href="#cb16-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract MODIS classification within species ranges</span></span>
<span id="cb16-906"><a href="#cb16-906" aria-hidden="true" tabindex="-1"></a><span class="co"># (Requires converting MODIS to vector or resampling species to raster)</span></span>
<span id="cb16-907"><a href="#cb16-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-908"><a href="#cb16-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-909"><a href="#cb16-909" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-910"><a href="#cb16-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-911"><a href="#cb16-911" aria-hidden="true" tabindex="-1"></a><span class="fu">## Complete Vegetation Classification Workflow {#sec-veg-workflow}</span></span>
<span id="cb16-912"><a href="#cb16-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-913"><a href="#cb16-913" aria-hidden="true" tabindex="-1"></a><span class="fu">### Integrated Processing Pipeline {#sec-veg-pipeline}</span></span>
<span id="cb16-914"><a href="#cb16-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-917"><a href="#cb16-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-918"><a href="#cb16-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-919"><a href="#cb16-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-complete-workflow</span></span>
<span id="cb16-920"><a href="#cb16-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "End-to-end vegetation classification"</span></span>
<span id="cb16-921"><a href="#cb16-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-922"><a href="#cb16-922" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb16-923"><a href="#cb16-923" aria-hidden="true" tabindex="-1"></a><span class="co"># IPCC Tier 1 Vegetation Classification Pipeline</span></span>
<span id="cb16-924"><a href="#cb16-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrates: MCD64A1 + MCD12Q1 + FAO Zones + HWSD</span></span>
<span id="cb16-925"><a href="#cb16-925" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb16-926"><a href="#cb16-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-927"><a href="#cb16-927" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgee)</span>
<span id="cb16-928"><a href="#cb16-928" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb16-929"><a href="#cb16-929" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-930"><a href="#cb16-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-931"><a href="#cb16-931" aria-hidden="true" tabindex="-1"></a><span class="fu">ee_Initialize</span>()</span>
<span id="cb16-932"><a href="#cb16-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-933"><a href="#cb16-933" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. LOAD INPUTS ----------------------------------------------</span></span>
<span id="cb16-934"><a href="#cb16-934" aria-hidden="true" tabindex="-1"></a><span class="co"># Burned area (from Chapter 1)</span></span>
<span id="cb16-935"><a href="#cb16-935" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="dv">2023</span></span>
<span id="cb16-936"><a href="#cb16-936" aria-hidden="true" tabindex="-1"></a>mcd64 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">"MODIS/061/MCD64A1"</span>)<span class="sc">$</span></span>
<span id="cb16-937"><a href="#cb16-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>), <span class="fu">paste0</span>(year, <span class="st">"-12-31"</span>))</span>
<span id="cb16-938"><a href="#cb16-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-939"><a href="#cb16-939" aria-hidden="true" tabindex="-1"></a><span class="co"># Land cover</span></span>
<span id="cb16-940"><a href="#cb16-940" aria-hidden="true" tabindex="-1"></a>lc <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">"MODIS/061/MCD12Q1"</span>)<span class="sc">$</span></span>
<span id="cb16-941"><a href="#cb16-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>), <span class="fu">paste0</span>(year, <span class="st">"-12-31"</span>))<span class="sc">$</span></span>
<span id="cb16-942"><a href="#cb16-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">first</span>()<span class="sc">$</span></span>
<span id="cb16-943"><a href="#cb16-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"LC_Type1"</span>)</span>
<span id="cb16-944"><a href="#cb16-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-945"><a href="#cb16-945" aria-hidden="true" tabindex="-1"></a><span class="co"># Country boundary</span></span>
<span id="cb16-946"><a href="#cb16-946" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">FeatureCollection</span>(<span class="st">"FAO/GAUL/2015/level0"</span>)</span>
<span id="cb16-947"><a href="#cb16-947" aria-hidden="true" tabindex="-1"></a>country_name <span class="ot">&lt;-</span> <span class="st">"Portugal"</span></span>
<span id="cb16-948"><a href="#cb16-948" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> countries<span class="sc">$</span><span class="fu">filter</span>(ee<span class="sc">$</span>Filter<span class="sc">$</span><span class="fu">eq</span>(<span class="st">"ADM0_NAME"</span>, country_name))</span>
<span id="cb16-949"><a href="#cb16-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-950"><a href="#cb16-950" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. PROCESS BURNED AREA --------------------------------------</span></span>
<span id="cb16-951"><a href="#cb16-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Quality filter and annual aggregation (from Chapter 1)</span></span>
<span id="cb16-952"><a href="#cb16-952" aria-hidden="true" tabindex="-1"></a>filterQuality <span class="ot">&lt;-</span> <span class="cf">function</span>(img) {</span>
<span id="cb16-953"><a href="#cb16-953" aria-hidden="true" tabindex="-1"></a>  mask <span class="ot">&lt;-</span> img<span class="sc">$</span><span class="fu">select</span>(<span class="st">"Burn_Date_Uncertainty"</span>)<span class="sc">$</span><span class="fu">lt</span>(<span class="dv">20</span>)<span class="sc">$</span></span>
<span id="cb16-954"><a href="#cb16-954" aria-hidden="true" tabindex="-1"></a>    <span class="fu">And</span>(img<span class="sc">$</span><span class="fu">select</span>(<span class="st">"BurnDate"</span>)<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">0</span>))</span>
<span id="cb16-955"><a href="#cb16-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(img<span class="sc">$</span><span class="fu">updateMask</span>(mask))</span>
<span id="cb16-956"><a href="#cb16-956" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-957"><a href="#cb16-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-958"><a href="#cb16-958" aria-hidden="true" tabindex="-1"></a>annual_burn <span class="ot">&lt;-</span> mcd64<span class="sc">$</span></span>
<span id="cb16-959"><a href="#cb16-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(filterQuality)<span class="sc">$</span></span>
<span id="cb16-960"><a href="#cb16-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"BurnDate"</span>)<span class="sc">$</span></span>
<span id="cb16-961"><a href="#cb16-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>()<span class="sc">$</span></span>
<span id="cb16-962"><a href="#cb16-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="dv">0</span>)<span class="sc">$</span></span>
<span id="cb16-963"><a href="#cb16-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selfMask</span>()</span>
<span id="cb16-964"><a href="#cb16-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-965"><a href="#cb16-965" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. CLASSIFY VEGETATION TYPES --------------------------------</span></span>
<span id="cb16-966"><a href="#cb16-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-967"><a href="#cb16-967" aria-hidden="true" tabindex="-1"></a><span class="co"># 3a. Forest Fires</span></span>
<span id="cb16-968"><a href="#cb16-968" aria-hidden="true" tabindex="-1"></a>forest_mask <span class="ot">&lt;-</span> lc<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">1</span>)<span class="sc">$</span><span class="fu">And</span>(lc<span class="sc">$</span><span class="fu">lte</span>(<span class="dv">5</span>))</span>
<span id="cb16-969"><a href="#cb16-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-970"><a href="#cb16-970" aria-hidden="true" tabindex="-1"></a><span class="co"># Humid Tropical Forest (using climate proxy)</span></span>
<span id="cb16-971"><a href="#cb16-971" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio01"</span>)</span>
<span id="cb16-972"><a href="#cb16-972" aria-hidden="true" tabindex="-1"></a>precip <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(<span class="st">"WORLDCLIM/V1/BIO"</span>)<span class="sc">$</span><span class="fu">select</span>(<span class="st">"bio12"</span>)</span>
<span id="cb16-973"><a href="#cb16-973" aria-hidden="true" tabindex="-1"></a>humid_tropical <span class="ot">&lt;-</span> temp<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">180</span>)<span class="sc">$</span><span class="fu">And</span>(precip<span class="sc">$</span><span class="fu">gt</span>(<span class="dv">1500</span>))</span>
<span id="cb16-974"><a href="#cb16-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-975"><a href="#cb16-975" aria-hidden="true" tabindex="-1"></a>htf_fires <span class="ot">&lt;-</span> annual_burn<span class="sc">$</span></span>
<span id="cb16-976"><a href="#cb16-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(forest_mask)<span class="sc">$</span></span>
<span id="cb16-977"><a href="#cb16-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(humid_tropical)</span>
<span id="cb16-978"><a href="#cb16-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-979"><a href="#cb16-979" aria-hidden="true" tabindex="-1"></a>other_forest_fires <span class="ot">&lt;-</span> annual_burn<span class="sc">$</span></span>
<span id="cb16-980"><a href="#cb16-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(forest_mask)<span class="sc">$</span></span>
<span id="cb16-981"><a href="#cb16-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateMask</span>(humid_tropical<span class="sc">$</span><span class="fu">Not</span>())</span>
<span id="cb16-982"><a href="#cb16-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-983"><a href="#cb16-983" aria-hidden="true" tabindex="-1"></a><span class="co"># 3b. Savanna Fires</span></span>
<span id="cb16-984"><a href="#cb16-984" aria-hidden="true" tabindex="-1"></a>savanna_mask <span class="ot">&lt;-</span> lc<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">6</span>)<span class="sc">$</span><span class="fu">And</span>(lc<span class="sc">$</span><span class="fu">lte</span>(<span class="dv">10</span>))</span>
<span id="cb16-985"><a href="#cb16-985" aria-hidden="true" tabindex="-1"></a>savanna_fires <span class="ot">&lt;-</span> annual_burn<span class="sc">$</span><span class="fu">updateMask</span>(savanna_mask)</span>
<span id="cb16-986"><a href="#cb16-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-987"><a href="#cb16-987" aria-hidden="true" tabindex="-1"></a><span class="co"># 3c. Organic Soil Fires (SE Asia only in FAOSTAT)</span></span>
<span id="cb16-988"><a href="#cb16-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Skip if not in SE Asia, or implement if needed</span></span>
<span id="cb16-989"><a href="#cb16-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-990"><a href="#cb16-990" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. CALCULATE AREAS ------------------------------------------</span></span>
<span id="cb16-991"><a href="#cb16-991" aria-hidden="true" tabindex="-1"></a>calculateArea <span class="ot">&lt;-</span> <span class="cf">function</span>(image, name) {</span>
<span id="cb16-992"><a href="#cb16-992" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> image<span class="sc">$</span></span>
<span id="cb16-993"><a href="#cb16-993" aria-hidden="true" tabindex="-1"></a>    <span class="fu">multiply</span>(ee<span class="sc">$</span>Image<span class="sc">$</span><span class="fu">pixelArea</span>()<span class="sc">$</span><span class="fu">divide</span>(<span class="dv">10000</span>))<span class="sc">$</span></span>
<span id="cb16-994"><a href="#cb16-994" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduceRegion</span>(</span>
<span id="cb16-995"><a href="#cb16-995" aria-hidden="true" tabindex="-1"></a>      <span class="at">reducer =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">sum</span>(),</span>
<span id="cb16-996"><a href="#cb16-996" aria-hidden="true" tabindex="-1"></a>      <span class="at">geometry =</span> aoi,</span>
<span id="cb16-997"><a href="#cb16-997" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="dv">500</span>,</span>
<span id="cb16-998"><a href="#cb16-998" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxPixels =</span> <span class="fl">1e9</span></span>
<span id="cb16-999"><a href="#cb16-999" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-1000"><a href="#cb16-1000" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-1001"><a href="#cb16-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ee<span class="sc">$</span><span class="fu">Feature</span>(<span class="cn">NULL</span>, <span class="fu">list</span>(</span>
<span id="cb16-1002"><a href="#cb16-1002" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_type =</span> name,</span>
<span id="cb16-1003"><a href="#cb16-1003" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_ha =</span> area<span class="sc">$</span><span class="fu">get</span>(<span class="st">"burned"</span>),</span>
<span id="cb16-1004"><a href="#cb16-1004" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> year,</span>
<span id="cb16-1005"><a href="#cb16-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> country_name</span>
<span id="cb16-1006"><a href="#cb16-1006" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb16-1007"><a href="#cb16-1007" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-1008"><a href="#cb16-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1009"><a href="#cb16-1009" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">FeatureCollection</span>(<span class="fu">list</span>(</span>
<span id="cb16-1010"><a href="#cb16-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculateArea</span>(htf_fires, <span class="st">"Humid_Tropical_Forest"</span>),</span>
<span id="cb16-1011"><a href="#cb16-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculateArea</span>(other_forest_fires, <span class="st">"Other_Forest"</span>),</span>
<span id="cb16-1012"><a href="#cb16-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculateArea</span>(savanna_fires, <span class="st">"Savanna"</span>)</span>
<span id="cb16-1013"><a href="#cb16-1013" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb16-1014"><a href="#cb16-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1015"><a href="#cb16-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. EXPORT RESULTS -------------------------------------------</span></span>
<span id="cb16-1016"><a href="#cb16-1016" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">ee_as_sf</span>(results) <span class="sc">%&gt;%</span></span>
<span id="cb16-1017"><a href="#cb16-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-1018"><a href="#cb16-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb16-1019"><a href="#cb16-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1020"><a href="#cb16-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_df)</span>
<span id="cb16-1021"><a href="#cb16-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1022"><a href="#cb16-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Save to file</span></span>
<span id="cb16-1023"><a href="#cb16-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb16-1024"><a href="#cb16-1024" aria-hidden="true" tabindex="-1"></a>  results_df,</span>
<span id="cb16-1025"><a href="#cb16-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(country_name, <span class="st">"_VegetationClassification_"</span>, year, <span class="st">".csv"</span>),</span>
<span id="cb16-1026"><a href="#cb16-1026" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb16-1027"><a href="#cb16-1027" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-1028"><a href="#cb16-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1029"><a href="#cb16-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. VISUALIZE ------------------------------------------------</span></span>
<span id="cb16-1030"><a href="#cb16-1030" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(aoi, <span class="at">zoom =</span> <span class="dv">7</span>)</span>
<span id="cb16-1031"><a href="#cb16-1031" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(htf_fires, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"darkred"</span>), <span class="st">"Humid Tropical Forest Fires"</span>)</span>
<span id="cb16-1032"><a href="#cb16-1032" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(other_forest_fires, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"orange"</span>), <span class="st">"Other Forest Fires"</span>)</span>
<span id="cb16-1033"><a href="#cb16-1033" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(savanna_fires, <span class="fu">list</span>(<span class="at">palette =</span> <span class="st">"yellow"</span>), <span class="st">"Savanna Fires"</span>)</span>
<span id="cb16-1034"><a href="#cb16-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-1035"><a href="#cb16-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1036"><a href="#cb16-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">### Output Format for Chapter 3 {#sec-veg-output}</span></span>
<span id="cb16-1037"><a href="#cb16-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1038"><a href="#cb16-1038" aria-hidden="true" tabindex="-1"></a>Required outputs for fuel biomass calculation (Chapter 3):</span>
<span id="cb16-1039"><a href="#cb16-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1042"><a href="#cb16-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-1043"><a href="#cb16-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-1044"><a href="#cb16-1044" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: veg-output-format</span></span>
<span id="cb16-1045"><a href="#cb16-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb16-1046"><a href="#cb16-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1047"><a href="#cb16-1047" aria-hidden="true" tabindex="-1"></a><span class="co"># Example output table structure</span></span>
<span id="cb16-1048"><a href="#cb16-1048" aria-hidden="true" tabindex="-1"></a>output_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-1049"><a href="#cb16-1049" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="st">"Portugal"</span>,</span>
<span id="cb16-1050"><a href="#cb16-1050" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2023</span>,</span>
<span id="cb16-1051"><a href="#cb16-1051" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire_type =</span> <span class="fu">c</span>(<span class="st">"Humid_Tropical_Forest"</span>, <span class="st">"Other_Forest"</span>, <span class="st">"Savanna"</span>),</span>
<span id="cb16-1052"><a href="#cb16-1052" aria-hidden="true" tabindex="-1"></a>  <span class="at">burned_area_ha =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">45230</span>, <span class="dv">12450</span>),  <span class="co"># Example values</span></span>
<span id="cb16-1053"><a href="#cb16-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">lc_class_dominant =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">9</span>),  <span class="co"># IGBP class</span></span>
<span id="cb16-1054"><a href="#cb16-1054" aria-hidden="true" tabindex="-1"></a>  <span class="at">climate_zone =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Temperate"</span>, <span class="st">"Temperate"</span>),</span>
<span id="cb16-1055"><a href="#cb16-1055" aria-hidden="true" tabindex="-1"></a>  <span class="at">fuel_consumption_tDM_ha =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">50.4</span>, <span class="fl">7.0</span>),  <span class="co"># From IPCC Table 2.4</span></span>
<span id="cb16-1056"><a href="#cb16-1056" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="fu">c</span>(</span>
<span id="cb16-1057"><a href="#cb16-1057" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No humid tropical forest in Portugal"</span>,</span>
<span id="cb16-1058"><a href="#cb16-1058" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Primarily Evergreen Needleleaf (Pinus)"</span>,</span>
<span id="cb16-1059"><a href="#cb16-1059" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Savanna vegetation"</span></span>
<span id="cb16-1060"><a href="#cb16-1060" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-1061"><a href="#cb16-1061" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-1062"><a href="#cb16-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1063"><a href="#cb16-1063" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output_table, <span class="at">caption =</span> <span class="st">"Vegetation Classification Output Example"</span>)</span>
<span id="cb16-1064"><a href="#cb16-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-1065"><a href="#cb16-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1066"><a href="#cb16-1066" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-1067"><a href="#cb16-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1068"><a href="#cb16-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quality Control and Uncertainty {#sec-veg-qc}</span></span>
<span id="cb16-1069"><a href="#cb16-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1070"><a href="#cb16-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification Uncertainty Assessment {#sec-veg-uncertainty-assess}</span></span>
<span id="cb16-1071"><a href="#cb16-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1072"><a href="#cb16-1072" aria-hidden="true" tabindex="-1"></a>Sources of uncertainty:</span>
<span id="cb16-1073"><a href="#cb16-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1074"><a href="#cb16-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Land cover classification error: ±10-15% (MCD12Q1</span>
<span id="cb16-1075"><a href="#cb16-1075" aria-hidden="true" tabindex="-1"></a>    validation)</span>
<span id="cb16-1076"><a href="#cb16-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Burned area overlay error: ±2-5% (geometric</span>
<span id="cb16-1077"><a href="#cb16-1077" aria-hidden="true" tabindex="-1"></a>    registration)</span>
<span id="cb16-1078"><a href="#cb16-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Ecological zone delineation: ±5-10% (climate proxy vs.</span>
<span id="cb16-1079"><a href="#cb16-1079" aria-hidden="true" tabindex="-1"></a>    official zones)</span>
<span id="cb16-1080"><a href="#cb16-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Temporal mismatch: Land cover annual vs. monthly burns</span>
<span id="cb16-1081"><a href="#cb16-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1082"><a href="#cb16-1082" aria-hidden="true" tabindex="-1"></a>Total uncertainty (quadrature): $$</span>
<span id="cb16-1083"><a href="#cb16-1083" aria-hidden="true" tabindex="-1"></a>U_{classification}^2 = U_{landcover}^2 + U_{overlay}^2 + U_{ecozone}^2</span>
<span id="cb16-1084"><a href="#cb16-1084" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-1085"><a href="#cb16-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1086"><a href="#cb16-1086" aria-hidden="true" tabindex="-1"></a>Typical result: ±15-20% uncertainty in vegetation type</span>
<span id="cb16-1087"><a href="#cb16-1087" aria-hidden="true" tabindex="-1"></a>assignment</span>
<span id="cb16-1088"><a href="#cb16-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1089"><a href="#cb16-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">### QC Checklist {#sec-veg-qc-checklist}</span></span>
<span id="cb16-1090"><a href="#cb16-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1091"><a href="#cb16-1091" aria-hidden="true" tabindex="-1"></a>Pre-classification:</span>
<span id="cb16-1092"><a href="#cb16-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1093"><a href="#cb16-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Burned area and land cover from same year</span>
<span id="cb16-1094"><a href="#cb16-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Land cover projection matches burned area</span>
<span id="cb16-1095"><a href="#cb16-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>All forest classes (1-5) included in forest mask</span>
<span id="cb16-1096"><a href="#cb16-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>All savanna classes (6-10) included in savanna mask</span>
<span id="cb16-1097"><a href="#cb16-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1098"><a href="#cb16-1098" aria-hidden="true" tabindex="-1"></a>Classification:</span>
<span id="cb16-1099"><a href="#cb16-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1100"><a href="#cb16-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mutually exclusive categories (no pixel in multiple</span>
<span id="cb16-1101"><a href="#cb16-1101" aria-hidden="true" tabindex="-1"></a>    categories)</span>
<span id="cb16-1102"><a href="#cb16-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Complete coverage (all burned pixels classified)</span>
<span id="cb16-1103"><a href="#cb16-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate zones applied correctly</span>
<span id="cb16-1104"><a href="#cb16-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Organic soils restricted to validated regions</span>
<span id="cb16-1105"><a href="#cb16-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1106"><a href="#cb16-1106" aria-hidden="true" tabindex="-1"></a>Post-classification:</span>
<span id="cb16-1107"><a href="#cb16-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1108"><a href="#cb16-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Area totals match Chapter 1 burned area</span>
<span id="cb16-1109"><a href="#cb16-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No negative or unrealistic values</span>
<span id="cb16-1110"><a href="#cb16-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Results comparable to previous years (if available)</span>
<span id="cb16-1111"><a href="#cb16-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Validation with independent data completed</span>
<span id="cb16-1112"><a href="#cb16-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1113"><a href="#cb16-1113" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-1114"><a href="#cb16-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1115"><a href="#cb16-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter Summary and Next Steps {#sec-veg-summary}</span></span>
<span id="cb16-1116"><a href="#cb16-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1117"><a href="#cb16-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways {#sec-veg-takeaways}</span></span>
<span id="cb16-1118"><a href="#cb16-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1119"><a href="#cb16-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>MODIS MCD12Q1 IGBP classification provides globally</span>
<span id="cb16-1120"><a href="#cb16-1120" aria-hidden="true" tabindex="-1"></a>    consistent vegetation types</span>
<span id="cb16-1121"><a href="#cb16-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Three IPCC fire categories: Forest (Humid Tropical +</span>
<span id="cb16-1122"><a href="#cb16-1122" aria-hidden="true" tabindex="-1"></a>    Other), Savanna, Organic Soils</span>
<span id="cb16-1123"><a href="#cb16-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Climate stratification required for accurate fuel</span>
<span id="cb16-1124"><a href="#cb16-1124" aria-hidden="true" tabindex="-1"></a>    consumption assignment</span>
<span id="cb16-1125"><a href="#cb16-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Validation using forestdata products (GLAD, ESRI,</span>
<span id="cb16-1126"><a href="#cb16-1126" aria-hidden="true" tabindex="-1"></a>    EU-Trees4F) reduces uncertainty</span>
<span id="cb16-1127"><a href="#cb16-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Uncertainty \~±15-20% in vegetation classification</span>
<span id="cb16-1128"><a href="#cb16-1128" aria-hidden="true" tabindex="-1"></a>    acceptable for Tier 1</span>
<span id="cb16-1129"><a href="#cb16-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1130"><a href="#cb16-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">### Progression to Chapter 3 {#sec-veg-to-chapter3}</span></span>
<span id="cb16-1131"><a href="#cb16-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1132"><a href="#cb16-1132" aria-hidden="true" tabindex="-1"></a>Chapter 3: Fuel Biomass Consumption will use vegetation</span>
<span id="cb16-1133"><a href="#cb16-1133" aria-hidden="true" tabindex="-1"></a>classifications to:</span>
<span id="cb16-1134"><a href="#cb16-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1135"><a href="#cb16-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Assign IPCC default fuel consumption values (Table 2.4)</span>
<span id="cb16-1136"><a href="#cb16-1136" aria-hidden="true" tabindex="-1"></a>    by vegetation type</span>
<span id="cb16-1137"><a href="#cb16-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Apply climate-dependent stratification</span>
<span id="cb16-1138"><a href="#cb16-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Calculate total burned biomass: $A \times M_B$ (Activity</span>
<span id="cb16-1139"><a href="#cb16-1139" aria-hidden="true" tabindex="-1"></a>    Data × Fuel Biomass)</span>
<span id="cb16-1140"><a href="#cb16-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Prepare for emission factor application (Chapter 4)</span>
<span id="cb16-1141"><a href="#cb16-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1142"><a href="#cb16-1142" aria-hidden="true" tabindex="-1"></a>Critical linkage: Each vegetation type carries forward:</span>
<span id="cb16-1143"><a href="#cb16-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1144"><a href="#cb16-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Area burned (hectares) by vegetation type</span>
<span id="cb16-1145"><a href="#cb16-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate zone (for fuel consumption stratification)</span>
<span id="cb16-1146"><a href="#cb16-1146" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Seasonal information (early/late dry season for</span>
<span id="cb16-1147"><a href="#cb16-1147" aria-hidden="true" tabindex="-1"></a>    savannas)</span>
<span id="cb16-1148"><a href="#cb16-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Geographic location (for validation and reporting)</span>
<span id="cb16-1149"><a href="#cb16-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1150"><a href="#cb16-1150" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------</span>
<span id="cb16-1151"><a href="#cb16-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1152"><a href="#cb16-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {#sec-veg-references}</span></span>
<span id="cb16-1153"><a href="#cb16-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1154"><a href="#cb16-1154" aria-hidden="true" tabindex="-1"></a>FAO (2012). Global ecological zones for FAO forest</span>
<span id="cb16-1155"><a href="#cb16-1155" aria-hidden="true" tabindex="-1"></a>reporting: 2010 Update. *Forest Resources Assessment Working</span>
<span id="cb16-1156"><a href="#cb16-1156" aria-hidden="true" tabindex="-1"></a>Paper 179*. FAO, Rome, Italy.</span>
<span id="cb16-1157"><a href="#cb16-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1158"><a href="#cb16-1158" aria-hidden="true" tabindex="-1"></a>IPCC (2006). 2006 IPCC Guidelines for National Greenhouse</span>
<span id="cb16-1159"><a href="#cb16-1159" aria-hidden="true" tabindex="-1"></a>Gas Inventories, Volume 4: Agriculture, Forestry and Other</span>
<span id="cb16-1160"><a href="#cb16-1160" aria-hidden="true" tabindex="-1"></a>Land Use. IGES, Japan.</span>
<span id="cb16-1161"><a href="#cb16-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1162"><a href="#cb16-1162" aria-hidden="true" tabindex="-1"></a>IPCC (2014). 2013 Supplement to the 2006 IPCC Guidelines for</span>
<span id="cb16-1163"><a href="#cb16-1163" aria-hidden="true" tabindex="-1"></a>National Greenhouse Gas Inventories: Wetlands. IPCC,</span>
<span id="cb16-1164"><a href="#cb16-1164" aria-hidden="true" tabindex="-1"></a>Switzerland.</span>
<span id="cb16-1165"><a href="#cb16-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1166"><a href="#cb16-1166" aria-hidden="true" tabindex="-1"></a>Loveland, T.R., &amp; Belward, A.S. (1997). The IGBP-DIS global</span>
<span id="cb16-1167"><a href="#cb16-1167" aria-hidden="true" tabindex="-1"></a>1km land cover data set, DISCover: First results.</span>
<span id="cb16-1168"><a href="#cb16-1168" aria-hidden="true" tabindex="-1"></a>*International Journal of Remote Sensing*, 18(15),</span>
<span id="cb16-1169"><a href="#cb16-1169" aria-hidden="true" tabindex="-1"></a>3289-3295.</span>
<span id="cb16-1170"><a href="#cb16-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1171"><a href="#cb16-1171" aria-hidden="true" tabindex="-1"></a>Sulla-Menashe, D., &amp; Friedl, M.A. (2022). User Guide to</span>
<span id="cb16-1172"><a href="#cb16-1172" aria-hidden="true" tabindex="-1"></a>Collection 6 MODIS Land Cover (MCD12Q1 and MCD12C1) Product.</span>
<span id="cb16-1173"><a href="#cb16-1173" aria-hidden="true" tabindex="-1"></a>NASA LP DAAC.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications">Source</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications/edit/main/02-veg-classes/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/seamusrobertmurphy/TREES-wildfire-replications/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a href="https://linkedin.com/in/seamusrobertmurphy">LinkedIn</a> | <a href="https://drive.google.com/uc?export=download&amp;id=13YLhsRCAMMHQw-jd2SJdaRJH9udBGytP">Resume</a> | <a href="https://scholar.google.com/citations?hl=en&amp;user=jDGq9I4AAAAJ">Scholar</a></p>
</div>
  </div>
</footer>


</body></html>