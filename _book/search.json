[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IPCC Fire Emissions",
    "section": "",
    "text": "Preface\nThis resource provides comprehensive methodological guidance for deriving IPCC Tier 1 Forest Fire Activity Data, with particular emphasis on burned area estimation following FAOSTAT and IPCC 2019 Refinement protocols. The workflow integrates satellite-based fire detection, land cover classification, fuel consumption modeling, and emission factor application within the Google Earth Engine platform to produce country-level greenhouse gas emission estimates from biomass burning.\nThe methodology presented here addresses key challenges in fire emissions accounting: inter-annual variability in natural disturbances, the managed land proxy approach for anthropogenic attribution, uncertainty quantification across multiple data sources, and the balance between immediate emissions and subsequent carbon removals. Each chapter builds systematically from data acquisition through quality control, providing transparent, reproducible workflows suitable for national greenhouse gas inventory reporting and validation.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#ipcc-tier-1-overview",
    "href": "index.html#ipcc-tier-1-overview",
    "title": "IPCC Fire Emissions",
    "section": "IPCC Tier 1 Overview",
    "text": "IPCC Tier 1 Overview\nThe IPCC Tier 1 approach for estimating greenhouse gas emissions from fires provides a standardized, globally applicable framework based on readily available data and default emission factors. This methodology applies Equation 2.27 from the 2006 IPCC Guidelines for National Greenhouse Gas Inventories (refined in 2019):\n\\[\nL_{fire} = A \\times M_B \\times C_f \\times G_{ef} \\times 10^{-3}\n\\]\nWhere:\n\nLfire = greenhouse gas emissions from fire (tonnes of CH₄, N₂O, or CO₂)\nA = area burnt (ha)\nMB = mass of fuel available for combustion (tonnes ha⁻¹)\nCf = combustion factor (dimensionless, proportion of fuel consumed)\nGef = emission factor (g kg⁻¹ dry matter burnt)\n\nKey Principles\nThe Tier 1 method prioritizes:\n\nConsistency: Uniform application of default parameters enables cross-country comparability\nTransparency: Clear documentation of data sources, assumptions, and limitations\nCompleteness: Coverage of all managed lands where fires occur\nAccuracy: Use of satellite-based activity data with quality filtering (uncertainty &lt; 20%)\nConservativeness: Appropriate treatment of CO₂ emissions based on vegetation type and recovery dynamics\nVegetation-Specific Applications\nForest Fires (Humid Tropical Forest and Other Forest):\n\nOnly non-CO₂ emissions (CH₄, N₂O) are reported\nCO₂ emissions excluded as they are captured in carbon stock change calculations\nApplies to fires in Evergreen, Deciduous, and Mixed Forest land cover types\n\nSavanna Fires (Grassland and woody vegetation):\n\nNon-CO₂ emissions only (CH₄, N₂O)\nAssumes CO₂ balance through annual vegetation regrowth\nCovers Grassland, Savanna, Woody Savanna, and Shrubland types\n\nOrganic Soil Fires (Peatland fires):\n\nReports both CO₂ and CH₄ emissions\nUses IPCC Wetlands Supplement parameters (IPCC, 2014)\n\nCurrently validated for Southeast Asia only\nManaged Land Proxy Approach\nThe methodology adopts the Managed Land Proxy (MLP) as the primary framework for attributing anthropogenic emissions. Under MLP:\n\nAll emissions and removals on managed lands approximate anthropogenic effects\nNatural disturbances (e.g., wildfires) are included in total managed land fluxes\nOptional disaggregation separates anthropogenic activities from natural disturbance impacts\nExpectation that emissions from natural disturbances balance with subsequent removals over time\n\nThe 2019 IPCC Refinement provides enhanced guidance for addressing interannual variability (IAV) caused by:\n\nNatural disturbances (wildfires, insects, windthrow, ice storms)\nClimate variability affecting photosynthesis and respiration\nVariation in human activities (harvesting, land-use change)\n\nCountries experiencing high IAV from natural disturbances may optionally disaggregate these fluxes to better identify trends in anthropogenic emissions and evaluate mitigation actions.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#faostat-fires-domain",
    "href": "index.html#faostat-fires-domain",
    "title": "IPCC Fire Emissions",
    "section": "FAOSTAT Fires Domain",
    "text": "FAOSTAT Fires Domain\nDatabase Overview\nThe FAOSTAT Emissions from Fires domain provides geospatially-computed estimates of CH₄, N₂O, and CO₂ emissions from biomass burning across all countries and territories. The database:\n\nCovers the complete time series 1990–2024\nUpdates annually with new satellite observations\nDisseminates both activity data (hectares burned, tonnes biomass burned) and emission estimates (kt CH₄, N₂O, CO₂)\nProvides regional aggregations for Annex I / non-Annex I country groups\nIntegrates country-reported data from UNFCCC submissions for validation\nMethodological Foundation\nFAOSTAT implements IPCC Tier 1 methodology using:\n\nPixel-level processing in Google Earth Engine (GEE)\nCountry-level aggregation via Global Administrative Unit Layers (EUROSTAT, n.d.)\n\nClimate-dependent fuel consumption values stratified by FAO-FRA Global Ecological Zones\nQuality-filtered satellite observations (uncertainty &lt; 20%)\n\nThe database serves as an official IPCC-recommended tool for National Greenhouse Gas Inventory (NGHGI) QA/QC processes and validation of activity data and emission estimates (IPCC 2019).\nThree Fire Categories\n1. Forest Fires\nEmissions from fires in Forest Land, disaggregated into:\n\nHumid Tropical Forest: Forest pixels overlaid with FAO-FRA tropical zones\nOther Forest: All remaining forest types (boreal, temperate, extra-tropical)\n\nLand cover identification aggregates MODIS IGBP classes:\n\nEvergreen Needleleaf Forest\nEvergreen Broadleaf Forest\nDeciduous Needleleaf Forest\nDeciduous Broadleaf Forest\nMixed Forests\n\n2. Savanna Fires\nEmissions from Grassland and woody vegetation:\n\nGrassland\nSavanna\nWoody Savanna\nOpen Shrubland\nClosed Shrubland\n\n3. Fires in Organic Soils\nEmissions from peat fires identified by overlaying burned area with Histosols class from the Harmonized World Soil Database. Due to high uncertainty and limited validation outside Southeast Asia, emissions are set to zero for all countries except those in Southeast Asia (Indonesia, Malaysia, Brunei Darussalam). Complete global estimates are provided in supplementary files for reference and research purposes.\nUNFCCC Data Integration\nFAOSTAT also disseminates emissions and activity data reported by countries to UNFCCC:\n\nActivity data: Sourced from National GHG Inventories or National Communications\nEmission data: Sourced from UNFCCC data portal or Biennial Update Reports (BURs)\nFormalized via FAO-UNFCCC Memorandum of Understanding\n\nThis integration enables direct comparison between:\n\nTop-down satellite-based FAOSTAT estimates\nBottom-up country-reported NGHGI data\n\nTemporal Gap-Filling\nPrimary Satellite Era (2001–2024): Direct observations from MODIS MCD64A1 Collection 6.1 provide monthly burned area at 500m resolution.\nHistorical Period (1990–2000): Values backfilled using two approaches:\n\n1996–2000: Earlier FAOSTAT estimates (Rossi et al., 2016)\n\n1990–1995: Averaged values from reconstructed time series (1996–2002 mean)\n\nThis approach ensures complete temporal coverage required for UNFCCC reporting while acknowledging higher uncertainty in pre-MODIS years.\nDisseminated Data Products\nActivity Data:\n\nBurned Area (hectares) by vegetation type and country\nBurned Biomass (tonnes dry matter) by vegetation type and country\n\nEmission Estimates:\n\nCH₄ emissions (kilotonnes)\nN₂O emissions (kilotonnes)\nCO₂ emissions (kilotonnes, for organic soils only)\n\nSpatial Aggregations:\n\n203 countries and territories (FAO Tier 1 coverage)\nStandard FAOSTAT regional groupings (Annex I / non-Annex I country groups)\n\nQuality Indicators:\n\nUncertainty metrics (&lt; 20% threshold applied)\nData completeness flags\nGap-filling methodology documentation\nInteroperability and Access\nData Formats:\n\nCSV files for bulk download\nWeb API for programmatic access\nInteractive visualization platform\nGoogle Earth Engine assets for geospatial analysis\n\nCitation and Licensing:\n\nFAO Open Data Licensing Policy\nStandard citation: FAO, 2024. FAOSTAT Climate Change: Agrifood systems emissions, Emissions from Fires, Rome, Italy.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#qaqc-and-validation",
    "href": "index.html#qaqc-and-validation",
    "title": "IPCC Fire Emissions",
    "section": "QA/QC and Validation",
    "text": "QA/QC and Validation\nNational GHG Inventories\nPrimary Use: The IPCC explicitly recommends FAOSTAT as a tool for NGHGI QA/QC processes (IPCC 2019). Countries can:\n\nCross-validate activity data: Compare satellite-derived burned areas against national fire databases\nEvaluate emission factors: Test sensitivity to country-specific vs. default IPCC parameters\n\nIdentify data gaps: Detect missing or inconsistent reporting in national systems\nAssess trends: Evaluate whether reported trends align with satellite observations\nComparison Frameworks\nTop-Down vs. Bottom-Up Reconciliation:\nFAOSTAT (satellite-based, top-down) &lt;&gt; NGHGI (ground-based, bottom-up)\nSystematic differences may indicate:\n\nDetection limitations in satellite products (e.g., small fires, smoldering)\nIncomplete ground reporting\nDifferent definitions of “managed land”\nBiomass consumption parameter uncertainties\n\nMulti-Source Fire Validation:\n\nFire Detection: MODIS active fire products (MCD14ML, MYD14) vs. burned area (MCD64A1)\nLand Cover: MODIS MCD12Q1 vs. national forest inventories\nEmission Factors: IPCC defaults vs. regional measurements from literature1\n\nTier Advancement Pathways\nCountries may use FAOSTAT as a stepping stone to higher-tier methods:\nTier 1 =&gt; Tier 2:\n\nReplace default emission factors with country-specific values\nRefine fuel consumption parameters using field measurements\nImprove combustion factor estimates via burn severity mapping\n\nTier 2 =&gt; Tier 3:\n\nIntegrate process-based models (e.g., FOFEM, CONSUME)\nDevelop national fire monitoring systems\nImplement measurement-based carbon stock change assessments\nMitigation Action Tracking\nFAOSTAT time series enable evaluation of:\n\nPrescribed burning programs\nFire suppression effectiveness\nLand management policy impacts\nClimate change effects on fire regimes\n\nCountries can quantify whether trends in anthropogenic fire emissions diverge from natural disturbance variability, supporting Nationally Determined Contribution (NDC) reporting and verification.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#uncertainty-considerations",
    "href": "index.html#uncertainty-considerations",
    "title": "IPCC Fire Emissions",
    "section": "Uncertainty Considerations",
    "text": "Uncertainty Considerations\nSources of Uncertainty\n1. Activity Data Uncertainty\nSatellite detection limitations:\n\nSmall fires (&lt; 500m): May be missed by MODIS 500m pixels\nCanopy-obscured fires: Difficult to detect in dense forests\nSmoldering fires: Peat fires may not produce strong thermal signatures\nCloud contamination: Persistent cloud cover reduces observation frequency\nRapid vegetation regrowth: Short time lag between fire and regrowth obscures burn scars\n\nMCD64A1 applies quality filters:\n\nOnly pixels with uncertainty &lt; 20% are included\nCommission/omission errors vary by biome\nGlobal burned area may be underestimated by 20-30% (Giglio et al., 2010)\n\n2. Land Classification Uncertainty\nMODIS MCD12Q1 accuracy:\n\nOverall accuracy: ~75% globally\nConfusion between woody savannas and forests\nTemporal lag in land-use change detection\nMixed pixels in heterogeneous landscapes\n\nImpact on emissions: Misclassification affects fuel consumption values (Table 2.4 ranges: 2.6 to 163.6 t ha⁻¹). For instances, Forest vs. Grassland assignment determines whether CO₂ is reported\n3. Fuel Consumption Uncertainty\nIPCC default values (Table 2.4) reflect:\n\nHigh natural variability: Standard errors often 30-50% of mean\nLimited empirical data: Some vegetation types have sparse measurements\nClimate dependency: Values vary by FAO-FRA Ecological Zones, but within-zone heterogeneity remains\n\nExample uncertainties (Mean ± SE):\n\nPrimary Tropical Forest: 119.6 ± (range: 83.9 to 163.6) t ha⁻¹\nSavanna Woodland: 2.6 ± 0.1 (early dry season) to 4.6 ± 1.5 (late dry season) t ha⁻¹\n4. Combustion Factor Uncertainty\nProportion of fuel consumed (Table 2.6):\n\nInfluenced by fire intensity, fuel moisture, weather conditions\nVariability within vegetation types: SD often 0.1-0.2 (for factors ranging 0.2-0.9)\nIncomplete combustion of coarse woody debris vs. near-complete combustion of grasses\n5. Emission Factor Uncertainty\nIPCC defaults (Table 2.5) based on (Andreae & Merlet, 2001):\n\nValues represent global averages across fire types\nStandard deviations: 20-60% of mean values\nInfluenced by combustion efficiency (flaming vs. smoldering)\n\nExample (Savanna fires): - CO₂: 1613 ± 95 g kg⁻¹ - CH₄: 2.3 ± 0.9 g kg⁻¹ - N₂O: 0.21 ± 0.10 g kg⁻¹\nUncertainty Aggregation\nFor IPCC Tier 1, cumulative uncertainty typically:\n\nActivity data: ±30% for burned area\nEmission estimates: ±50% for CH₄ and N₂O, ±30-40% for CO₂\n\nOrganic soil fires have particularly high uncertainty:\n\nRemote sensing detection challenges\nLimited field validation outside Southeast Asia\nDifficulty distinguishing surface fires from subsurface peat combustion\nUnknown proportion of fires on drained vs. undrained peatlands\nUncertainty Reduction\nCountry-Specific Improvements:\n\nIntegrate national fire databases with satellite observations\nConduct field campaigns to measure fuel loads and combustion factors\nDevelop regional emission factors from smoke sampling\nImplement Tier 2/3 methods in high-emission areas\n\nMethodological Enhancements:\n\nMulti-sensor fusion (MODIS + VIIRS + Sentinel)\nSub-pixel burned area algorithms\nBurn severity mapping for combustion factors\nSeasonal stratification of fuel moisture\n\nTransparent Reporting:\n\nDocument all assumptions and parameter choices\nReport uncertainty ranges alongside emission estimates\nConduct sensitivity analyses for key parameters\nCompare with independent data sources where available\nTreatment of Inter-Annual Variability\nHigh IAV from natural disturbances complicates trend analysis:\n\nWildfires can cause 2-3 orders of magnitude annual variation\nObscures anthropogenic emission trends\nChallenges mitigation policy evaluation\n\nOptional Disaggregation Approach (IPCC, 2019)2:\nCountries may separate:\n\nNatural disturbance component: Emissions/removals beyond normal variability (e.g., &gt; 95th percentile)\nAnthropogenic component: Remaining managed land fluxes\n\nThis disaggregation:\n\nImproves clarity of human activity impacts\nMaintains MLP total for official reporting\nRequires documentation of methods and thresholds\nAssumes eventual balance between disturbance emissions and regrowth",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#data-sources",
    "href": "index.html#data-sources",
    "title": "IPCC Fire Emissions",
    "section": "Data Sources",
    "text": "Data Sources\nMCD64A1.061: Burn Areas\nProduct Overview: The MCD64A1 Version 6.1 Burned Area product provides monthly, global gridded burned area at 500m spatial resolution, derived from combined Terra and Aqua MODIS observations.\nKey Features:\n\nTemporal Resolution: Monthly composites, 2001–present\nSpatial Resolution: 500m nominal pixel size\nAlgorithm: Decision tree classifier using surface reflectance time series\nOutput: Burn date encoded as ordinal day of year, with quality indicators\n\nData Layers:\n\nBurn Date (day of year when burn detected)\nBurn Data Uncertainty (percentage uncertainty, 0-100%)\nQuality Assurance flags\n\nFAOSTAT Implementation:\n\nQuality filter applied: Only pixels with uncertainty &lt; 20% are retained\nAggregation: Pixel-level burn dates accumulated to annual country totals\nGEE Asset: MODIS/061/MCD64A1\n\n\nAccess:\n\nNASA LP DAAC: https://lpdaac.usgs.gov/products/mcd64a1v061/\nGoogle Earth Engine: ee.ImageCollection(\"MODIS/061/MCD64A1\")\n\nUser Guide: (Giglio et al., 2024)\n\n\nLimitations:\n\nMay miss small fires (&lt; 500m²)\nReduced accuracy in densely forested areas\nCloud obscuration limits temporal coverage in some regions\nDetection lag in slow-spreading fires\n\nMCD12Q1.061: IGBP Land Cover\nProduct Overview: MCD12Q1 provides annual global land cover classification at 500m resolution using supervised classification of MODIS reflectance data.\nClassification Scheme: FAOSTAT uses Land Cover Type 1 (IGBP 17-class legend):\nForest Types (used for Forest Fire category):\n\nClass 1: Evergreen Needleleaf Forests\nClass 2: Evergreen Broadleaf Forests\nClass 3: Deciduous Needleleaf Forests\nClass 4: Deciduous Broadleaf Forests\nClass 5: Mixed Forests\n\nGrassland/Savanna Types (used for Savanna Fire category):\n\nClass 6: Closed Shrublands\nClass 7: Open Shrublands - Class 8: Woody Savannas\nClass 9: Savannas\nClass 10: Grasslands\nOther Classes: Croplands, Urban, Wetlands, etc. (Classes 11-17)\n\nFAOSTAT Implementation:\n\nAnnual land cover maps matched to fire detection year\nOverlay burned pixels with contemporaneous land cover\nExclude built-up, barren, and water bodies\nGEE Asset: MODIS/061/MCD12Q1\n\n\nAccess:\n\nNASA LP DAAC: https://lpdaac.usgs.gov/products/mcd12q1v061/\nGoogle Earth Engine: ee.ImageCollection(\"MODIS/061/MCD12Q1\")\n\nUser Guide: (Sulla-Menashe et al., 2018)\n\n\nAccuracy:\n\nOverall accuracy: ~75% globally\nHigher accuracy in homogeneous landscapes\nsConfusion common between woody savannas and open forests\n\nFAO Global Administrative Unit Layers (GAUL)\nDataset Overview:\nGAUL provides standardized national and sub-national administrative boundaries for all countries and territories.\nCoverage:\n\n203 countries and 2 territories (FAO Tier 1 coverage)\nMulti-level hierarchy (admin level 0, 1, 2)\nHarmonized with FAOSTAT country classifications\n\nFAOSTAT Implementation:\n\nAdmin Level 0 used for country-level aggregation\nAll pixel-level fire data summed within national boundaries\n\nEnsures consistency with other FAOSTAT domains\nVersion:\n\nGAUL 2015 (last available comprehensive update)\nNote: Some recent boundary changes not reflected\n\nAccess:\n\nFAO GeoNetwork: http://www.fao.org/geonetwork/\nGoogle Earth Engine: FAO/GAUL/2015/level0\n\n\nConsiderations:\n\nDisputed boundaries handled per UN conventions\nSome coastal zone definitions may differ from national claims\nSmall island territories aggregated into parent countries in some cases\n\nFAO Global Ecological Zones\nDataset Overview:\nThe Global Ecological Zones (GEZ) classification provides a climate-vegetation framework for stratifying fuel consumption parameters.\nClassification System Combines:\n\nClimate domains (Polar, Boreal, Temperate, Subtropical, Tropical)\nEcological zones (e.g., Tropical moist forest, Tropical dry forest, Subtropical steppe)\n\nFAOSTAT Implementation:\n\nOverlay burned forest pixels with GEZ to distinguish:\nHumid Tropical Forest: Tropical moist ecological zones\nOther Forest: All remaining forest types\nAssign climate-dependent fuel consumption values from IPCC Table 2.4\n\nAccess:\n\nFAO Forestry: http://www.fao.org/forest-resources-assessment/\nDocument: FAO Global Ecological Zones for FAO forest reporting 2010 Update (FAO, 2012)\n\n\nApplication:\n\nDetermines fuel biomass consumption parameters\nStratifies emission factors where climate-sensitive\nLinks to FAO Forest Resources Assessment (FRA) reporting categories\n\nIPCC Soil Zones Layer\nDataset Overview:\nThe Harmonized World Soil Database (HWSD v1.2) provides global soil type classifications at 30 arc-second (~1 km) resolution.\nHistosols Class:\nOrganic soils characterized by:\n\nHigh organic matter content (&gt; 20-30% by weight)\nFormed in waterlogged conditions\nIncludes peatlands, bogs, fens\n\nFAOSTAT Implementation:\n\nBurned area pixels overlaid with Histosols spatial layer\nFires in organic soils identified independently of land cover (except excluding built-up, barren, water)\nDifferent fuel consumption and emission factors applied (IPCC Wetlands Supplement 2014)\n\nAccess:\n\nFAO Soils Portal: http://www.fao.org/soils-portal/\nIIASA: https://iiasa.ac.at/models-and-data/hwsd\n\nCritical Limitation:\n\nFAOSTAT organic soil fire emissions set to zero outside Southeast Asia due to:\nHigh uncertainty in peat fire detection\nLimited validation data - Difficulty distinguishing drained vs. undrained peatlands\nUncertainty in human influence on fire occurrence\n\nSupplementary file AllFires_OrganicSoils.csv contains global estimates for research purposes.\nIPCC Climate Zones Layer\nDataset Overview:\nIPCC Climate Zones classify global climate into categories used for stratifying biomass growth rates, decomposition rates, and fire parameters.\nClassification:\n\nPolar\nBoreal (Cold)\nTemperate (Warm temperate, Cool temperate)\nTropical (Tropical wet, Tropical moist, Tropical dry, Tropical montane)\n\nSource:\n\nJoint Research Centre (JRC) Climate Zones layer\nBased on IPCC climatic zone definitions (IPCC, 2006)\n\n\nFAOSTAT Implementation:\n\nSavanna fire fuel consumption values vary by climate zone (Table 2.4)\nOrganic soil emission factors stratified by climate (IPCC, n.d.)\n\nLinks IPCC methodology to geographic reality\n\nAccess:\n\nJRC European Soil Data Centre (ESDAC): https://esdac.jrc.ec.europa.eu/\nReference: JRC (2010) Climatic Zone layer\n\nGoogle Earth Engine Setup\nPlatform Overview:\nGoogle Earth Engine is a cloud-based geospatial analysis platform providing:\n\nPetabyte-scale satellite imagery archives\nPlanetary-scale computational infrastructure\nJavaScript and Python APIs\nWeb-based Code Editor\n\nFAOSTAT Workflow Architecture:\n\nData Ingestion: All datasets (MCD64A1, MCD12Q1, GAUL, etc.) available as pre-processed GEE assets\nPixel-Level Processing: Fire algorithm applied to all global pixels\nZonal Statistics: Country-level aggregation via GAUL boundaries\nExport: Results exported as CSV tables for FAOSTAT database\n\nGetting Started:\n\n\nAccount Registration:\n\nSign up at https://earthengine.google.com/signup/\nAcademic/NGO accounts typically approved within 1-2 days\n\n\n\nCode Editor Access:\n\nNavigate to https://code.earthengine.google.com/\nJavaScript environment for interactive analysis\n\n\n\nPython API Setup (optional):\npip install earthengine-api\nearthengine authenticate\n\n\nKey GEE Concepts:\n\n\nImageCollection: Time series of raster images\n\nImage: Single raster dataset\n\nFeatureCollection: Vector dataset (e.g., country boundaries)\n\nReducer: Aggregation functions (sum, mean, etc.)\n\n\n\nFAOSTAT-Relevant GEE Assets:\n// Burned Area\nvar burnedArea = ee.ImageCollection(\"MODIS/061/MCD64A1\");\n\n// Land Cover\nvar landCover = ee.ImageCollection(\"MODIS/061/MCD12Q1\");\n\n// Country Boundaries\nvar countries = ee.FeatureCollection(\"FAO/GAUL/2015/level0\");\nComputational Considerations:\n\nGlobal annual processing requires substantial compute resources\nBatch processing via Earth Engine Tasks for large exports\nMemory and timeout limits apply (user-specific quotas)\nTiling strategies may be needed for very large analyses\n\nResources:\n\nDocumentation: https://developers.google.com/earth-engine/\nCode Archive: https://earthengine.google.com/\nCommunity Tutorials: https://developers.google.com/earth-engine/tutorials/",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#chapter-workflows",
    "href": "index.html#chapter-workflows",
    "title": "IPCC Fire Emissions",
    "section": "Chapter Workflows",
    "text": "Chapter Workflows\nThe following chapters provide detailed, step-by-step guidance for implementing each component of the IPCC Tier 1 burned area and emissions estimation workflow. Each chapter builds upon data and methods from previous sections, creating an integrated analytical framework.\nChapter 1: Burned Area Data\nExtract MODIS MCD64A1 data, apply quality filters, aggregate temporally and spatially, handle missing data, and validate against alternative fire products.\nChapter 2: Vegetation Classification\nClassify burned pixels into Forest (Humid Tropical, Other), Savanna, and Organic Soil categories using MODIS land cover and auxiliary datasets.\nChapter 3: Fuel Biomass\nAssign IPCC default fuel consumption values based on vegetation type and climate zone stratification, calculate total burned biomass.\nChapter 4: Emission Factors\nApply IPCC emission factors, compute CH₄, N₂O, and CO₂ emissions, handle CO₂ reporting exclusions for non-stand-replacing fires.\nChapter 5: Peatland Fires\nSpecial treatment of Histosol fires, IPCC Wetlands Supplement methodology, regional uncertainty assessment and SE Asia validation.\nChapter 6: Google Earth Engine\nComplete GEE scripts for automated processing, batch export strategies, computational optimization, and reproducible workflows.\nChapter 7: QA/QC & Validation\nCross-validation with UNFCCC data, uncertainty propagation, sensitivity analysis, and documentation for NGHGI reporting.\nChapter 8: Reporting Formats\nFAOSTAT database structure, CRF table formatting, time series visualization, and transparent documentation of methods and assumptions.\n\nLast Updated: 2025-11-04\nSuggested Citation: Murphy, S (2025). IPCC Forest Fire Activity Data & Emissions Factors: Methodological Guide for Deriving Burned Area and Emissions Estimates.\n\n\n\n\n\n\n\nAndreae, M. O., & Merlet, P. (2001). Emission of trace gases and aerosols from biomass burning. Global Biogeochemical Cycles, 15(4), 955–966.\n\n\nEUROSTAT. (n.d.). Geographic information system of the european commission.\n\n\nFAO, G. (2012). Global ecological zones for FAO forest reporting: 2010 update. FAO: Rome, Italy.\n\n\nGiglio, L., Hall, J. V., Humber, M., Argueta, F., Boschetti, L., & Roy, D. (2024). Collection 2 VIIRS burned area product user’s guide version 1.1. NASA EOSDIS Land Processes Distributed Active Archive Center. DOI: Https://Doi. Org/10.5067/VIIRS/VNP64A1, 2.\n\n\nGiglio, L., Randerson, J., Van der Werf, G., Kasibhatla, P., Collatz, G., Morton, D., & DeFries, R. (2010). Assessing variability and long-term trends in burned area by merging multiple satellite fire products. Biogeosciences (Online), 7(3), 1171–1186.\n\n\nIPCC. (n.d.). 2013 revised supplementary methods and good practice guidance arising from the kyoto protocol.\n\n\nIPCC. (2006). Chapter 3: Consistent representation of lands. In 2006 IPCC guidelines for national greenhouse gas inventories 3.1 (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2006gl/pdf/4_Volume4/V4_03_Ch3_Representation.pdf\n\n\nIPCC. (2014). 2013 supplement to the 2006 IPCC guidelines for national greenhouse gas inventories: Wetlands iii. Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/wetlands/pdf/Wetlands_Supplement_Entire_Report.pdf\n\n\nIPCC. (2019). Chapter 2: Generic methodologies applicable to multiple land-use categories. In 2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf\n\n\nRossi, S., Tubiello, F. N., Prosperi, P., Salvatore, M., Jacobs, H., Biancalani, R., House, J. I., & Boschetti, L. (2016). FAOSTAT estimates of greenhouse gas emissions from biomass and peat fires. Climatic Change, 135(3), 699–711.\n\n\nSulla-Menashe, D., Friedl, M. A., et al. (2018). User guide to collection 6 MODIS land cover (MCD12Q1 and MCD12C1) product. Usgs: Reston, Va, Usa, 1, 18.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "IPCC Fire Emissions",
    "section": "",
    "text": "Note to self: 2025 wishlist↩︎\nSection 2.6: URL to page number here↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "01-burn-area/index.html",
    "href": "01-burn-area/index.html",
    "title": "\n1  Burn Area\n",
    "section": "",
    "text": "Overview\nThis chapter provides detailed workflows for detecting, processing, and validating burned areas using MODIS MCD64A1 Collection 6.1 data within the Google Earth Engine (GEE) platform. The methodology implements IPCC Tier 1 requirements while incorporating multi-source validation using the forestdata package and alternative remote sensing products.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#overview",
    "href": "01-burn-area/index.html#overview",
    "title": "\n1  Burn Area\n",
    "section": "",
    "text": "Environmental Setup\n\neasypackages::packages(\n  \"bslib\", \n  \"cols4all\", \"covr\", \"cowplot\", \n  \"dendextend\", \"digest\",\"DiagrammeR\",\"dtwclust\", \"downlit\", \n  \"e1071\", \"exactextractr\",\"elevatr\", \n  \"FNN\", \"future\", \"forestdata\",\n  \"gdalcubes\", \"gdalUtilities\", \"geojsonsf\", \"geos\", \"ggplot2\", \"ggstats\", \n  \"ggspatial\", \"ggmap\", \"ggplotify\", \"ggpubr\", \"ggrepel\", \"giscoR\", \n  \"hdf5r\", \"httr\", \"httr2\", \"htmltools\",\n  \"jsonlite\", \n  \"kohonen\", \n  \"leaflet.providers\", \"leafem\", \"libgeos\",\"luz\",\"lwgeom\", \"leaflet\", \"leafgl\",\n  \"mapedit\", \"mapview\", \"maptiles\", \"methods\", \"mgcv\", \n  \"ncdf4\", \"nnet\", \n  \"openxlsx\", \"parallel\", \"plotly\", \n  \"randomForest\", \"rasterVis\", \"raster\", \"Rcpp\", \"RcppArmadillo\", \n  \"RcppCensSpatial\",\"rayshader\", \"RcppEigen\", \"RcppParallel\", \n  \"RColorBrewer\", \"reactable\", \"rgl\", \"rsconnect\",\"RStoolbox\", \"rts\", \n  \"s2\", \"sf\", \"scales\", \"sits\",\"spdep\", \"stars\", \"stringr\",\"supercells\", \n  \"terra\", \"testthat\", \"tidyverse\", \"tidyterra\",\"tools\", \n  \"tmap\", \"tmaptools\", \"terrainr\", \n  \"xgboost\",\n  prompt = F)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-framework",
    "href": "01-burn-area/index.html#sec-ba-framework",
    "title": "\n1  Burn Area\n",
    "section": "\n1.1 FAOSTAT Framework",
    "text": "1.1 FAOSTAT Framework\nThe FAOSTAT burned area workflow follows a pixel-to-country aggregation approach:\n\nPixel-level detection: Monthly MODIS MCD64A1 burned area product (500m resolution)\nQuality filtering: Retain only pixels with uncertainty &lt; 20%\nTemporal aggregation: Monthly observations &gt;&gt; annual burned area totals\nSpatial aggregation: Pixel sums &gt;&gt; country-level statistics via FAO GAUL boundaries\nValidation: Cross-comparison with alternative products and country reports\n\n\n1.1.1 Activity Data\nActivity Data (A) in Equation 2.27 represents:\n\\[\nA = \\sum_{i=1}^{n} \\text{Burned Area}_i \\quad \\text{(hectares)}\n\\]\nWhere:\n\n\n\\(i\\) = individual pixels detected as burned\n\n\\(n\\) = total number of burned pixels meeting quality criteria\nPixel area = 0.25 km² (500m × 500m) = 25 hectares at equator\n\nSpatial Resolution Considerations:\n\nNominal 500m resolution\nActual ground distance varies by latitude: \\(d = 500 \\times \\cos(\\text{latitude})\\)\n\nArea calculations corrected using pixel-specific latitude\n\n1.1.2 Temporal Coverage\n\n2001-2024: Direct MODIS MCD64A1 Collection 6.1 observations\n1996-2000: Earlier FAOSTAT estimates (Rossi et al., 2016) using:\nMODIS Collection 5 data - ATSR World Fire Atlas - TRMM/VIRS fire product\n1990-1995: Gap-filled using averaged values: \\[\n\\text{BA}_{1990-1995} = \\frac{1}{7} \\sum_{y=1996}^{2002} \\text{BA}_y\n\\]\n\n\nRationale: Pre-MODIS era requires reconstruction; averaging reduces bias from anomalous years.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-gee-access",
    "href": "01-burn-area/index.html#sec-ba-gee-access",
    "title": "\n1  Burn Area\n",
    "section": "\n1.2 Earth Engine: MCD64A1",
    "text": "1.2 Earth Engine: MCD64A1\n\nImage Collection: MODIS/061/MCD64A1\n\nBands:\n\n\nBurnDate: Day of year (DOY) when burn detected (1-366, 0 = unburned)\n\nBurn_Date_Uncertainty: Percentage uncertainty (0-100%)\n\nQA: Quality assurance flags\n\nFirst_Day: First day of observation period\n\nLast_Day: Last day of observation period\n\n\nTemporal Resolution: Monthly composites (2001-present)\nSpatial Resolution: 500m\nProjection: Sinusoidal (SR-ORG:6974)\nAlgorithm: Decision tree classifier using MODIS daily surface reflectance (Giglio et al., 2018)\n\n\n\nlibrary(rgee)\nlibrary(sf)\nlibrary(terra)\n\n# Initialize Google Earth Engine\nee_Initialize(user = \"your.email@domain.com\")\n\n# Define area of interest (example: Portugal)\naoi &lt;- ee$Geometry$Rectangle(c(-9.5, 36.9, -6.2, 42.2))\n\n# Load MCD64A1 collection\nmcd64 &lt;- ee$ImageCollection(\"MODIS/061/MCD64A1\")\n\n# Filter by location and time\nburned_area &lt;- mcd64$\n  filterBounds(aoi)$\n  filterDate(\"2023-01-01\", \"2023-12-31\")\n\n# Check collection size\nprint(paste(\"Images in collection:\", burned_area$size()$getInfo()))\n\n\n1.2.0.1 Multi-Criteria Filtering\n\n# Define quality filter function\nfilterQuality &lt;- function(image) {\n  # Extract bands\n  burnDate &lt;- image$select(\"BurnDate\")\n  uncertainty &lt;- image$select(\"Burn_Date_Uncertainty\")\n  qa &lt;- image$select(\"QA\")\n  \n  # Create masks\n  # 1. Valid burn date (1-366)\n  validBurn &lt;- burnDate$gt(0)$And(burnDate$lte(366))\n  \n  # 2. Uncertainty less than 20%\n  lowUncertainty &lt;- uncertainty$lt(20)\n  \n  # 3. QA indicates good quality (bit 0 = 0)\n  goodQuality &lt;- qa$bitwiseAnd(1)$eq(0)\n  \n  # Combine masks\n  finalMask &lt;- validBurn$And(lowUncertainty)$And(goodQuality)\n  \n  # Apply mask and return\n  return(image$updateMask(finalMask))\n}\n\n# Apply quality filter to collection\nmcd64_filtered &lt;- burned_area$map(filterQuality)\n\n# Verify filtering effect\nprint(paste(\"Filtered images:\", mcd64_filtered$size()$getInfo()))\n\n\n1.2.1 Quality Assurance Flags\nThe QA band uses bit flags to encode quality information:\n\n\nBit\nDescription\nValues\n\n\n\n0\nLand/Water\n0=Land, 1=Water\n\n\n1-2\nData Quality\n00=Good, 01=Fair, 10=Poor, 11=No data\n\n\n3\nDirection of spread\n0=Unknown, 1=Known\n\n\n\nRecommended QA filtering:\n\n# Extract quality information\nextractQA &lt;- function(image) {\n  qa &lt;- image$select(\"QA\")\n  \n  # Bit 0: Land/Water\n  landWater &lt;- qa$bitwiseAnd(1)\n  \n  # Bits 1-2: Data quality (shift right 1, mask with 3)\n  dataQuality &lt;- qa$rightShift(1)$bitwiseAnd(3)\n  \n  # Add as separate bands\n  return(image$\n    addBands(landWater$rename(\"land_water\"))$\n    addBands(dataQuality$rename(\"data_quality\"))\n  )\n}\n\n# Apply QA extraction\nmcd64_qa &lt;- mcd64_filtered$map(extractQA)\n\n\n1.2.2 FAOSTAT Quality Criteria\nPrimary criterion: Burn_Date_Uncertainty &lt; 20%\nRationale: MCD64A1 uncertainty estimates commission/omission error probability\n\n20% threshold balances omission (missing fires) vs. commission (false detections)\nGiglio et al. (2018) validation shows:\n\nUncertainty &lt; 20%: Commission ~15%, Omission ~30%\nUncertainty &gt; 50%: Commission ~40%, Omission ~50%\n\n\n\nImplementation:\n\napplyFAOSTATFilter &lt;- function(image) {\n  uncertainty &lt;- image$select(\"Burn_Date_Uncertainty\")\n  burnDate &lt;- image$select(\"BurnDate\")\n  \n  # FAOSTAT criteria\n  mask &lt;- uncertainty$lt(20)$And(burnDate$gt(0))\n  \n  return(image$updateMask(mask))\n}\n\n# Apply to collection\nmcd64_faostat &lt;- burned_area$map(applyFAOSTATFilter)\n\n\n1.2.3 Uncertainty Quantification\nSources of Uncertainty\n1. Detection Limitations:\n\nSmall fires (&lt; 500m): Often missed\nRapidly growing vegetation: Burn scar obscured within days\nDense canopy: Surface fires undetected\nCloud persistence: Reduces observation frequency\n\n2. Classification Errors:\n\nShadows misclassified as burned\nBare soil confusion with ash deposits\nAgricultural harvesting vs. burning\nWater level changes in wetlands\n\n3. Temporal Precision:\n\nBurn date accuracy: ±8 days median (Giglio et al., 2018)\n\nMulti-day fires: Only initial detection recorded\nSlow-spreading fires: May span multiple pixels/dates\n\n1.2.3.1 Validation Data\nActive Fire Products (MCD14ML, MYD14):\n\n# Load MODIS active fire product\nactiveFire &lt;- ee$ImageCollection(\"MODIS/061/MOD14A1\")$\n  filterBounds(aoi)$\n  filterDate(\"2023-01-01\", \"2023-12-31\")$\n  select(\"FireMask\")\n\n# Extract fire pixels (values 7-9 indicate fire)\nfirePixels &lt;- activeFire$map(function(img) {\n  return(img$gte(7)$selfMask())\n})\n\n# Reduce to annual maximum (any fire detection)\nannualFireMask &lt;- firePixels$max()\n\n# Compare with burned area\nburnedMask &lt;- mcd64_faostat$\n  select(\"BurnDate\")$\n  max()$\n  gt(0)\n\n# Calculate agreement\nagreement &lt;- burnedMask$And(annualFireMask)\nbaOnly &lt;- burnedMask$And(annualFireMask$Not())\nafOnly &lt;- annualFireMask$And(burnedMask$Not())\n\n# Export for analysis\nMap$addLayer(agreement, list(palette = \"green\"), \"Agreement\")\nMap$addLayer(baOnly, list(palette = \"blue\"), \"BA only\")\nMap$addLayer(afOnly, list(palette = \"red\"), \"AF only\")\n\nLandsat-based Products (30m resolution): Higher resolution reference for validation, though less frequent temporal coverage.\n\n# Example: Landsat 8 NBR differencing\n# (Note: Requires custom burn severity calculation)\n\n# Load pre-fire Landsat image\nprefire &lt;- ee$ImageCollection(\"LANDSAT/LC08/C02/T1_L2\")$\n  filterBounds(aoi)$\n  filterDate(\"2023-06-01\", \"2023-06-30\")$\n  median()\n\n# Load post-fire Landsat image  \npostfire &lt;- ee$ImageCollection(\"LANDSAT/LC08/C02/T1_L2\")$\n  filterBounds(aoi)$\n  filterDate(\"2023-08-01\", \"2023-08-31\")$\n  median()\n\n# Calculate NBR (Normalized Burn Ratio)\ncalculateNBR &lt;- function(img) {\n  nir &lt;- img$select(\"SR_B5\")\n  swir &lt;- img$select(\"SR_B7\")\n  nbr &lt;- nir$subtract(swir)$divide(nir$add(swir))$rename(\"NBR\")\n  return(nbr)\n}\n\nnbr_pre &lt;- calculateNBR(prefire)\nnbr_post &lt;- calculateNBR(postfire)\n\n# Calculate dNBR (difference)\ndnbr &lt;- nbr_pre$subtract(nbr_post)\n\n# Threshold for burned areas (dNBR &gt; 0.1 indicates likely burn)\nlandsat_burn &lt;- dnbr$gt(0.1)\n\n# Resample MODIS to Landsat resolution for comparison\nmodis_burn_resampled &lt;- burnedMask$\n  reproject(crs = \"EPSG:32629\", scale = 30)  # Adjust CRS for AOI\n\n# Calculate confusion matrix\n# (Export both layers and analyze in R)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-temporal-agg",
    "href": "01-burn-area/index.html#sec-ba-temporal-agg",
    "title": "\n1  Burn Area\n",
    "section": "\n1.3 Temporal Aggregation",
    "text": "1.3 Temporal Aggregation\n\n1.3.1 Annualization\n\n# Function to create binary burned/unburned\nbinaryBurn &lt;- function(image) {\n  burned &lt;- image$select(\"BurnDate\")$gt(0)\n  return(burned$\n    rename(\"burned\")$\n    copyProperties(image, list(\"system:time_start\"))\n  )\n}\n\n# Convert to binary\nmcd64_binary &lt;- mcd64_faostat$map(binaryBurn)\n\n# Reduce to annual maximum (any pixel burned at any time = burned)\nannual_burned_2023 &lt;- mcd64_binary$\n  filterDate(\"2023-01-01\", \"2023-12-31\")$\n  max()$\n  selfMask()\n\n# Visualize\nvis_params &lt;- list(\n  palette = c(\"yellow\", \"orange\", \"red\"),\n  min = 0,\n  max = 1\n)\n\nMap$centerObject(aoi, zoom = 7)\nMap$addLayer(annual_burned_2023, vis_params, \"2023 Burned Area\")\n\n\n1.3.1.1 Multiple Burns Accounting\n\n\n\n\n\n\nChallenge: A pixel can burn multiple times per year.\n\n\n\n\n\nFAOSTAT approach: Count pixel as burned once per year (conservative).\nAlternative: Track number of burns per pixel:\n\n\n\n\n# Count number of times each pixel burned\nburnCount &lt;- mcd64_binary$\n  filterDate(\"2023-01-01\", \"2023-12-31\")$\n  sum()$\n  rename(\"burn_count\")\n\n# Classify burn frequency\nfrequency_classes &lt;- burnCount$\n  where(burnCount$eq(0), 0)$  # Unburned\n  where(burnCount$eq(1), 1)$  # Burned once\n  where(burnCount$gte(2), 2)  # Burned multiple times\n\nMap$addLayer(\n  frequency_classes, \n  list(min = 0, max = 2, palette = c(\"white\", \"orange\", \"red\")),\n  \"Burn Frequency\"\n)\n\n# For IPCC Tier 1: Use binary (burned/not burned)\n# For Tier 2+: Consider multiple burns in fuel consumption\n\n\n1.3.2 Time Series Construction\n\n1.3.2.1 Burned Area Stack\n\n# Define years of interest\nyears &lt;- seq(2001, 2023, 1)\n\n# Function to get annual burned area for a given year\ngetAnnualBurn &lt;- function(year) {\n  # Filter collection to year\n  year_collection &lt;- mcd64_faostat$\n    filter(ee$Filter$calendarRange(year, year, \"year\"))\n  \n  # Convert to binary and reduce to max\n  annual_burn &lt;- year_collection$\n    map(binaryBurn)$\n    max()$\n    unmask(0)  # Fill unburned pixels with 0\n  \n  # Set year property\n  return(annual_burn$\n    set(\"year\", year)$\n    set(\"system:time_start\", ee$Date$fromYMD(year, 1, 1)$millis())\n  )\n}\n\n# Create collection of annual burned areas\nannual_collection &lt;- ee$ImageCollection(\n  lapply(years, function(y) getAnnualBurn(y))\n)\n\n# Example: Calculate total area burned per year\n# (Will aggregate spatially in next section)\n\n\n1.3.2.2 Trend Analysis\n\n# Linear trend over time series\n# Note: This is a simplified pixel-wise trend\n# For country-level trends, aggregate first (see next section)\n\n# Add year band to each image\naddYearBand &lt;- function(image) {\n  year &lt;- ee$Number(image$get(\"year\"))\n  yearBand &lt;- ee$Image$constant(year)$toFloat()$rename(\"year\")\n  return(image$addBands(yearBand))\n}\n\nannual_with_year &lt;- annual_collection$map(addYearBand)\n\n# Linear regression: burned ~ year\nregression &lt;- annual_with_year$\n  select(c(\"year\", \"burned\"))$\n  reduce(ee$Reducer$linearFit())\n\n# Extract slope (trend)\ntrend &lt;- regression$select(\"scale\")\n\n# Visualize increasing/decreasing trends\ntrend_vis &lt;- list(\n  min = -0.05,\n  max = 0.05,\n  palette = c(\"blue\", \"white\", \"red\")\n)\n\nMap$addLayer(trend, trend_vis, \"Burn Trend (2001-2023)\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-spatial-agg",
    "href": "01-burn-area/index.html#sec-ba-spatial-agg",
    "title": "\n1  Burn Area\n",
    "section": "\n1.4 Spatial Aggregation",
    "text": "1.4 Spatial Aggregation\n\n1.4.1 Country-Level Summaries\n\n1.4.1.1 Using FAO GAUL Boundaries\n\n# Load FAO GAUL country boundaries (Admin Level 0)\ncountries &lt;- ee$FeatureCollection(\"FAO/GAUL/2015/level0\")\n\n# Select specific country (example: Portugal)\nportugal &lt;- countries$filter(ee$Filter$eq(\"ADM0_NAME\", \"Portugal\"))\n\n# Calculate burned area for 2023\nburned_2023 &lt;- annual_burned_2023\n\n# Zonal statistics: sum of burned pixels\nburnedArea_ha &lt;- burned_2023$\n  multiply(ee$Image$pixelArea()$divide(10000))$  # Convert m² to hectares\n  reduceRegions(\n    collection = portugal,\n    reducer = ee$Reducer$sum(),\n    scale = 500,\n    crs = \"SR-ORG:6974\"  # MCD64A1 native projection\n  )\n\n# Extract result\nresult &lt;- burnedArea_ha$getInfo()\nprint(paste(\"Burned area (ha):\", result$features[[1]]$properties$sum))\n\n\n1.4.1.2 Batch Processing for All Countries\n\n# Function to calculate burned area for a single country\ncalculateCountryBA &lt;- function(country_name, year) {\n  # Filter country\n  country &lt;- countries$filter(ee$Filter$eq(\"ADM0_NAME\", country_name))\n  \n  # Get annual burned area\n  annual_burn &lt;- getAnnualBurn(year)\n  \n  # Convert to area (hectares)\n  burn_area_ha &lt;- annual_burn$\n    multiply(ee$Image$pixelArea()$divide(10000))\n  \n  # Reduce by region\n  stats &lt;- burn_area_ha$reduceRegions(\n    collection = country,\n    reducer = ee$Reducer$sum(),\n    scale = 500\n  )\n  \n  # Add metadata\n  return(stats$map(function(f) {\n    return(f$\n      set(\"year\", year)$\n      set(\"country\", country_name)\n  }))\n}\n\n# Process multiple countries and years\ncountry_list &lt;- c(\"Portugal\", \"Spain\", \"France\", \"Greece\")\nyear_list &lt;- c(2020, 2021, 2022, 2023)\n\n# Create tasks (run in parallel in GEE)\n# Note: For production, export to Google Drive or Asset\n\nfor (country in country_list) {\n  for (year in year_list) {\n    result &lt;- calculateCountryBA(country, year)\n    \n    # Export task\n    task &lt;- ee$batch$Export$table$toDrive(\n      collection = result,\n      description = paste0(country, \"_\", year, \"_BA\"),\n      folder = \"IPCC_Fire_Emissions\",\n      fileFormat = \"CSV\"\n    )\n    \n    task$start()\n    print(paste(\"Started task:\", country, year))\n  }\n}\n\n\n1.4.2 Sub-National Aggregation\n\n# Load Admin Level 1 (provinces/states)\nadmin1 &lt;- ee$FeatureCollection(\"FAO/GAUL/2015/level1\")\n\n# Filter to country\nportugal_admin1 &lt;- admin1$filter(ee$Filter$eq(\"ADM0_NAME\", \"Portugal\"))\n\n# Calculate burned area by province\nprovincial_BA &lt;- burned_2023$\n  multiply(ee$Image$pixelArea()$divide(10000))$\n  reduceRegions(\n    collection = portugal_admin1,\n    reducer = ee$Reducer$sum(),\n    scale = 500\n  )\n\n# Convert to sf object for analysis in R\nprovincial_BA_sf &lt;- ee_as_sf(provincial_BA)\n\n# Visualize\nlibrary(ggplot2)\nggplot(provincial_BA_sf) +\n  geom_sf(aes(fill = sum)) +\n  scale_fill_viridis_c(name = \"Burned Area (ha)\") +\n  labs(title = \"Burned Area by Province - Portugal 2023\") +\n  theme_minimal()\n\n\n1.4.3 Area Calculation Corrections\nLatitude correction for pixel area:\n\n# Standard approach: Use ee.Image.pixelArea()\n# This automatically accounts for latitude\n\n# Manual calculation (for understanding):\ncalculatePixelArea &lt;- function(image) {\n  # Get latitude for each pixel\n  lat &lt;- ee$Image$pixelLonLat()$select(\"latitude\")\n  \n  # Convert to radians\n  lat_rad &lt;- lat$multiply(pi / 180)\n  \n  # Pixel height (constant in sinusoidal projection)\n  pixel_height_m &lt;- 463.3127  # meters at equator for 500m product\n  \n  # Pixel width varies with latitude\n  pixel_width_m &lt;- pixel_height_m$multiply(lat_rad$cos())\n  \n  # Area in m²\n  pixel_area_m2 &lt;- pixel_height_m$multiply(pixel_width_m)\n  \n  return(pixel_area_m2)\n}\n\n# Compare with built-in function\npixel_area_builtin &lt;- ee$Image$pixelArea()\npixel_area_manual &lt;- calculatePixelArea()\n\n# They should match (built-in is more accurate)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-validation",
    "href": "01-burn-area/index.html#sec-ba-validation",
    "title": "\n1  Burn Area\n",
    "section": "\n1.5 Multi-Source Validation",
    "text": "1.5 Multi-Source Validation\n\n1.5.1 GLAD Comparison\nUsing forestdata package for complementary validation:\n\nlibrary(forestdata)\nlibrary(terra)\nlibrary(sf)\n\n# Define area of interest in R\nportugal_sf &lt;- st_read(\"path/to/portugal_boundary.gpkg\")\nportugal_bbox &lt;- st_bbox(portugal_sf)\n\n# Download GLAD land cover change (2000-2020)\nglad_change &lt;- fd_forest_glad(\n  lon = mean(c(portugal_bbox[\"xmin\"], portugal_bbox[\"xmax\"])),\n  lat = mean(c(portugal_bbox[\"ymin\"], portugal_bbox[\"ymax\"])),\n  model = \"landcover-change\",\n  year = 2020  # Ignored for change product\n)\n\n# Download MODIS burned area from GEE (from previous sections)\n# Export annual_burned_2023 to R\nmodis_burn_2023 &lt;- ee_as_rast(\n  annual_burned_2023,\n  region = aoi,\n  scale = 500\n)\n\n# Resample GLAD to MODIS resolution for comparison\nglad_change_500m &lt;- resample(glad_change, modis_burn_2023, method = \"near\")\n\n# Crop to same extent\nglad_crop &lt;- crop(glad_change_500m, modis_burn_2023)\nmodis_crop &lt;- crop(modis_burn_2023, glad_change_500m)\n\n# Analyze agreement\n# GLAD change codes: Extract relevant change types\n# (Consult GLAD documentation for specific codes)\n\n# Example: Extract forest loss pixels\nglad_forest_loss &lt;- glad_crop == 2  # Adjust code based on GLAD legend\n\n# Calculate confusion matrix\nlibrary(caret)\nconfusion &lt;- confusionMatrix(\n  data = as.factor(as.vector(modis_crop)),\n  reference = as.factor(as.vector(glad_forest_loss))\n)\n\nprint(confusion)\n\n\n1.5.2 ESRI-LULC Comparison\n\nlibrary(forestdata)\n\n# Portugal is in UTM zone 29N\nesri_2022 &lt;- fd_landcover_esri(utm_code = \"29N\", year = 2022)\nesri_2023 &lt;- fd_landcover_esri(utm_code = \"29N\", year = 2023)\n\n# Detect land cover changes between years\nesri_change &lt;- esri_2023 - esri_2022\n\n# Focus on transitions to \"bare ground\" class (potential fire)\n# (Check ESRI legend for bare ground class code)\nbare_ground_code &lt;- 8  # Example - verify from ESRI documentation\n\nesri_to_bare &lt;- (esri_2022 != bare_ground_code) & \n                (esri_2023 == bare_ground_code)\n\n# Resample to MODIS resolution\nesri_change_500m &lt;- aggregate(\n  esri_to_bare, \n  fact = 50,  # 10m to 500m = factor of 50\n  fun = mean  # Proportion of 10m pixels that changed\n)\n\n# Overlay with MODIS burned area\n# High agreement expected in fire-affected forests\n# Disagreement may indicate:\n#   - MODIS missed small fires (ESRI detected)\n#   - ESRI detected non-fire disturbances (logging, etc.)\n\n\n1.5.3 Country Data Comparison\n\n# Example: Load country-reported burned area\n# (Would typically come from UNFCCC National Inventory Reports)\n\ncountry_reported &lt;- data.frame(\n  year = 2020:2023,\n  reported_ba_ha = c(45000, 52000, 38000, 61000),  # Example data\n  source = \"National Forest Inventory\"\n)\n\n# Calculate FAOSTAT burned area from GEE results\n# (Assuming you've exported multi-year results)\nfaostat_ba &lt;- data.frame(\n  year = 2020:2023,\n  faostat_ba_ha = c(42000, 49000, 36000, 58000)  # From GEE exports\n)\n\n# Merge and compare\ncomparison &lt;- merge(country_reported, faostat_ba, by = \"year\")\ncomparison$difference_ha &lt;- comparison$reported_ba_ha - comparison$faostat_ba_ha\ncomparison$percent_diff &lt;- (comparison$difference_ha / comparison$reported_ba_ha) * 100\n\n# Visualize\nlibrary(ggplot2)\nggplot(comparison, aes(x = year)) +\n  geom_line(aes(y = reported_ba_ha, color = \"Country Reported\"), linewidth = 1) +\n  geom_line(aes(y = faostat_ba_ha, color = \"FAOSTAT\"), linewidth = 1) +\n  geom_point(aes(y = reported_ba_ha, color = \"Country Reported\"), size = 3) +\n  geom_point(aes(y = faostat_ba_ha, color = \"FAOSTAT\"), size = 3) +\n  scale_color_manual(values = c(\"Country Reported\" = \"blue\", \"FAOSTAT\" = \"red\")) +\n  labs(\n    title = \"Burned Area Comparison: Country Reports vs. FAOSTAT\",\n    subtitle = \"Portugal 2020-2023\",\n    x = \"Year\",\n    y = \"Burned Area (hectares)\",\n    color = \"Source\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n# Statistical assessment\ncor_test &lt;- cor.test(comparison$reported_ba_ha, comparison$faostat_ba_ha)\nprint(paste(\"Correlation:\", round(cor_test$estimate, 3)))\nprint(paste(\"P-value:\", cor_test$p.value))",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-uncertainty-assessment",
    "href": "01-burn-area/index.html#sec-ba-uncertainty-assessment",
    "title": "\n1  Burn Area\n",
    "section": "\n1.6 Uncertainty Reporting",
    "text": "1.6 Uncertainty Reporting\n\n1.6.1 Quantifying Total Uncertainty\nFollowing IPCC guidelines, uncertainty in burned area activity data combines:\n\\[\nU_{total}^2 = U_{detection}^2 + U_{classification}^2 + U_{area}^2\n\\]\nWhere:\n\n\n\\(U_{detection}\\) = Omission/commission errors in fire detection\n\n\\(U_{classification}\\) = Land cover misclassification affecting fire-prone area\n\n\\(U_{area}\\) = Geometric/projection errors in area calculation\n\nTypical values for MODIS MCD64A1:\n\nDetection uncertainty: ±25-35% (varies by biome)\nClassification uncertainty: ±10-15% (from MCD12Q1 validation)\nArea uncertainty: ±2-5% (projection and edge effects)\n\nCombined uncertainty: Approximately ±30% for global Tier 1 applications\n\n1.6.2 Sensitivity Analysis\n\n# Test multiple uncertainty thresholds\nthresholds &lt;- c(10, 15, 20, 25, 30)\n\nsensitivity_results &lt;- data.frame(\n  threshold = numeric(),\n  burned_area_ha = numeric(),\n  pixel_count = numeric()\n)\n\nfor (thresh in thresholds) {\n  # Apply threshold\n  filtered &lt;- mcd64$\n    filterDate(\"2023-01-01\", \"2023-12-31\")$\n    map(function(img) {\n      mask &lt;- img$select(\"Burn_Date_Uncertainty\")$lt(thresh)$\n        And(img$select(\"BurnDate\")$gt(0))\n      return(img$updateMask(mask))\n    })\n  \n  # Calculate burned area\n  result &lt;- filtered$\n    select(\"BurnDate\")$\n    max()$\n    multiply(ee$Image$pixelArea()$divide(10000))$\n    reduceRegion(\n      reducer = ee$Reducer$sum(),\n      geometry = aoi,\n      scale = 500,\n      maxPixels = 1e9\n    )\n  \n  # Store results\n  sensitivity_results &lt;- rbind(\n    sensitivity_results,\n    data.frame(\n      threshold = thresh,\n      burned_area_ha = result$getInfo()$BurnDate,\n      pixel_count = NA  # Could calculate separately\n    )\n  )\n}\n\n# Visualize sensitivity\nggplot(sensitivity_results, aes(x = threshold, y = burned_area_ha)) +\n  geom_line(linewidth = 1, color = \"darkred\") +\n  geom_point(size = 3, color = \"darkred\") +\n  geom_vline(xintercept = 20, linetype = \"dashed\", color = \"blue\") +\n  annotate(\"text\", x = 20, y = max(sensitivity_results$burned_area_ha) * 0.9,\n           label = \"FAOSTAT threshold\", hjust = -0.1) +\n  labs(\n    title = \"Sensitivity of Burned Area to Quality Threshold\",\n    x = \"Uncertainty Threshold (%)\",\n    y = \"Burned Area (hectares)\"\n  ) +\n  theme_minimal()\n\n\n1.6.3 Documenting Uncertainty for NGHGI\nRequired documentation for Tier 1:\n\nData source and version: MODIS MCD64A1 Collection 6.1\nQuality criteria applied: Uncertainty &lt; 20%\nSpatial coverage: Percentage of country with valid observations\nTemporal coverage: Months with cloud-free observations\nEstimated uncertainty: ±30% (or country-specific if available)\nValidation results: Comparison with independent data sources\n\nExample uncertainty table for NGHGI report:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "01-burn-area/index.html#sec-ba-workflow-summary",
    "href": "01-burn-area/index.html#sec-ba-workflow-summary",
    "title": "\n1  Burn Area\n",
    "section": "\n1.7 Reproducible Workflow",
    "text": "1.7 Reproducible Workflow\n\n1.7.1 Complete Processing Pipeline\n\n# ============================================================\n# IPCC Tier 1 Burned Area Processing Pipeline\n# MODIS MCD64A1 Collection 6.1\n# ============================================================\n\nlibrary(rgee)\nlibrary(sf)\nlibrary(terra)\nlibrary(tidyverse)\n\n# Initialize\nee_Initialize()\n\n# 1. DEFINE PARAMETERS ----------------------------------------\ncountry_name &lt;- \"Portugal\"\nyear_start &lt;- 2020\nyear_end &lt;- 2023\nuncertainty_threshold &lt;- 20\n\n# 2. LOAD SPATIAL DATA ----------------------------------------\n# Country boundary\ncountries &lt;- ee$FeatureCollection(\"FAO/GAUL/2015/level0\")\naoi &lt;- countries$filter(ee$Filter$eq(\"ADM0_NAME\", country_name))\n\n# Burned area collection\nmcd64 &lt;- ee$ImageCollection(\"MODIS/061/MCD64A1\")\n\n# 3. QUALITY FILTERING ----------------------------------------\nfilterQuality &lt;- function(image) {\n  uncertainty &lt;- image$select(\"Burn_Date_Uncertainty\")\n  burnDate &lt;- image$select(\"BurnDate\")\n  mask &lt;- uncertainty$lt(uncertainty_threshold)$And(burnDate$gt(0))\n  return(image$updateMask(mask))\n}\n\n# 4. TEMPORAL AGGREGATION -------------------------------------\ngetAnnualBurn &lt;- function(year) {\n  annual &lt;- mcd64$\n    filter(ee$Filter$calendarRange(year, year, \"year\"))$\n    filterBounds(aoi)$\n    map(filterQuality)$\n    select(\"BurnDate\")$\n    max()$\n    gt(0)$\n    selfMask()\n  \n  return(annual$\n    set(\"year\", year)$\n    set(\"system:time_start\", ee$Date$fromYMD(year, 1, 1)$millis()))\n}\n\nyears &lt;- seq(year_start, year_end, 1)\nannual_collection &lt;- ee$ImageCollection(lapply(years, getAnnualBurn))\n\n# 5. SPATIAL AGGREGATION --------------------------------------\ncalculateBA &lt;- function(image) {\n  year &lt;- image$get(\"year\")\n  area_ha &lt;- image$\n    multiply(ee$Image$pixelArea()$divide(10000))$\n    reduceRegion(\n      reducer = ee$Reducer$sum(),\n      geometry = aoi,\n      scale = 500,\n      maxPixels = 1e9\n    )\n  \n  return(ee$Feature(NULL, list(\n    year = year,\n    country = country_name,\n    burned_area_ha = area_ha$get(\"BurnDate\")\n  ))\n}\n\nresults &lt;- annual_collection$map(calculateBA)\n\n# 6. EXPORT RESULTS -------------------------------------------\n# To Google Drive\ntask &lt;- ee$batch$Export$table$toDrive(\n  collection = results,\n  description = paste0(country_name, \"_BA_\", year_start, \"_\", year_end),\n  folder = \"IPCC_Fire_Emissions\",\n  fileFormat = \"CSV\"\n)\n\ntask$start()\nprint(paste(\"Export started:\", task$id))\n\n# Or get directly in R (for small areas)\nresults_df &lt;- ee_as_sf(results) %&gt;%\n  st_drop_geometry() %&gt;%\n  as.data.frame()\n\nprint(results_df)\n\n# 7. VISUALIZATION --------------------------------------------\nggplot(results_df, aes(x = year, y = burned_area_ha)) +\n  geom_line(color = \"darkred\", linewidth = 1) +\n  geom_point(color = \"darkred\", size = 3) +\n  labs(\n    title = paste(\"Annual Burned Area -\", country_name),\n    subtitle = paste(\"MODIS MCD64A1 Collection 6.1 |\", year_start, \"-\", year_end),\n    x = \"Year\",\n    y = \"Burned Area (hectares)\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(size = 10, color = \"gray40\")\n  )\n\n\n1.7.2 Data Export Formats\nFor NGHGI Reporting:\n\n# Create IPCC-compatible output table\nnghgi_output &lt;- results_df %&gt;%\n  mutate(\n    Category = \"4.C Forest Land\",\n    Subcategory = \"Fires on Forest Land\",\n    Activity_Data_Unit = \"ha\",\n    Data_Source = \"MODIS MCD64A1 Collection 6.1\",\n    Quality_Tier = \"Tier 1\",\n    Uncertainty_Percent = 30\n  ) %&gt;%\n  rename(\n    Year = year,\n    Country = country,\n    Burned_Area_ha = burned_area_ha\n  )\n\n# Export\nwrite.csv(\n  nghgi_output,\n  file = paste0(country_name, \"_BurnedArea_NGHGI_\", Sys.Date(), \".csv\"),\n  row.names = FALSE\n)\n\n\n1.7.3 Quality Control Checklist\nPre-processing:\n\nGEE authentication successful\nAOI geometry valid (no self-intersections)\nDate range covers complete years\nImage collection not empty\n\nProcessing:\n\nQuality filter applied (uncertainty &lt; 20%)\nTemporal aggregation complete (12 months per year)\nSpatial aggregation uses correct boundaries (EUROSTAT, n.d.)\n\nArea calculation accounts for projection\n\nPost-processing:\n\nNo missing years in time series\nBurned area values reasonable (order of magnitude check)\nComparison with previous estimates (if available)\nValidation with independent data\nUncertainty quantified and documented\n\nReporting:\n\nData source and version documented\nMethods transparent and reproducible\nCode archived in version control\nResults exported in standard format\nMetadata complete (CRS, resolution, quality flags)\n\n\n\n\n\n\n\n\nEUROSTAT. (n.d.). Geographic information system of the european commission.\n\n\nGiglio, L., Boschetti, L., Roy, D. P., Humber, M. L., & Justice, C. O. (2018). The collection 6 MODIS burned area mapping algorithm and product. Remote Sensing of Environment, 217, 72–85.\n\n\nRossi, S., Tubiello, F. N., Prosperi, P., Salvatore, M., Jacobs, H., Biancalani, R., House, J. I., & Boschetti, L. (2016). FAOSTAT estimates of greenhouse gas emissions from biomass and peat fires. Climatic Change, 135(3), 699–711.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html",
    "href": "02-veg-classes/index.html",
    "title": "\n2  Burn Area\n",
    "section": "",
    "text": "Overview\nThis chapter describes the classification of burned areas into IPCC-compliant vegetation categories using MODIS Land Cover (MCD12Q1) and auxiliary datasets. The classification determines which emission factors and fuel consumption values apply to each burned pixel, directly impacting greenhouse gas emission estimates.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#overview",
    "href": "02-veg-classes/index.html#overview",
    "title": "\n2  Burn Area\n",
    "section": "",
    "text": "2.0.1 IPCC Vegetation Categories\nFAOSTAT implements three primary fire categories aligned with IPCC 2006 Guidelines (Climate Change, 2006):\n1. Forest Fires:\n\nHumid Tropical Forest: Fires in tropical moist ecological zones\nOther Forest: All remaining forest types (boreal, temperate, tropical dry)\n\n2. Savanna Fires (Grassland):\n\nGrassland\nSavanna\nWoody Savanna\nOpen Shrubland\nClosed Shrubland\n\n3. Fires in Organic Soils:\n\nPeatland fires (Histosols classification)\nIndependent of overlying vegetation\n\n2.0.2 Classification Decision Tree\n\n2.0.3 Vegetation Reporting Requirements\nFollowing IPCC guidelines:\n\n\nVegetation Type\nCO₂\nCH₄\nN₂O\nRationale\n\n\n\nForest Fires\n❌\n✅\n✅\nCO₂ in carbon stock changes\n\n\nSavanna Fires\n❌\n✅\n✅\nAssumes annual CO₂ balance\n\n\nOrganic Soil Fires\n✅\n✅\n❌\nPer Wetlands Supplement\n\n\n\nKey principle: CO₂ from non-stand-replacing fires assumed balanced by regrowth within one year (IPCC 2019, Section 2.4).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-modis",
    "href": "02-veg-classes/index.html#sec-veg-modis",
    "title": "\n2  Burn Area\n",
    "section": "\n2.1 MODIS Land Cover Classification",
    "text": "2.1 MODIS Land Cover Classification\n\n2.1.1 MCD12Q1 IGBP Classification Scheme\n\n2.1.1.1 Product Overview\n\nGEE Asset: MODIS/061/MCD12Q1\n\nSpatial Resolution: 500m\nTemporal Resolution: Annual (2001-present)\nClassification System: Land Cover Type 1 - IGBP (International Geosphere-Biosphere Programme)\n\nAlgorithm: Supervised classification using Random Forest trained on reference sites\nOverall Accuracy: ~75% globally (Sulla-Menashe et al., 2018)\n\n\n\n\n2.1.2 IGBP Burnable Classes\nForest Classes (1-5):\n\n\n\n\n\n\n\n\nClass\nName\nIPCC Category\nFuel Consumption (t ha⁻¹)\n\n\n\n1\nEvergreen Needleleaf Forests\nOther Forest\n41.0 (mean)\n\n\n2\nEvergreen Broadleaf Forests\nHumid Tropical Forest\n119.6 (mean)\n\n\n3\nDeciduous Needleleaf Forests\nOther Forest\n41.0 (mean)\n\n\n4\nDeciduous Broadleaf Forests\nOther/Tropical (zone-dependent)\n69.4-119.6\n\n\n5\nMixed Forests\nOther Forest\n50.4 (mean)\n\n\n\nGrassland/Savanna Classes (6-10):\n\n\nClass\nName\nIPCC Category\nFuel Consumption (t ha⁻¹)\n\n\n\n6\nClosed Shrublands\nSavanna (Shrubland)\n14.3 (mean)\n\n\n7\nOpen Shrublands\nSavanna (Shrubland)\n14.3 (mean)\n\n\n8\nWoody Savannas\nSavanna (Woody)\n2.6-4.6 (season)\n\n\n9\nSavannas\nSavanna\n2.1-10.0 (season)\n\n\n10\nGrasslands\nSavanna (Grassland)\n2.1-10.0 (season)\n\n\n\nExcluded Classes:\n\n\nClass\nName\nReason for Exclusion\n\n\n\n0\nWater\nNot burnable\n\n\n11\nPermanent Wetlands\nHandled separately if Histosol\n\n\n12\nCroplands\nAgricultural fires (separate category)\n\n\n13\nUrban and Built-up\nFire prevention/suppression active\n\n\n14\nCropland/Natural Vegetation Mosaics\nAmbiguous, often excluded\n\n\n15\nPermanent Snow and Ice\nNot burnable\n\n\n16\nBarren\nInsufficient fuel\n\n\n17\nUnclassified\nNo data\n\n\n\n2.1.3 Earth Engine: MCD12Q1\n\nlibrary(rgee)\nee_Initialize()\n\n# Load land cover collection\nlandCover &lt;- ee$ImageCollection(\"MODIS/061/MCD12Q1\")\n\n# Select IGBP classification (Type 1)\nigbp &lt;- landCover$select(\"LC_Type1\")\n\n# Get land cover for specific year (example: 2023)\nlc_2023 &lt;- igbp$\n  filterDate(\"2023-01-01\", \"2023-12-31\")$\n  first()\n\n# Visualize\nlc_vis &lt;- list(\n  min = 1,\n  max = 17,\n  palette = c(\n    '05450a', '086a10', '54a708', '78d203', '009900',  # Forests 1-5\n    'c6b044', 'dcd159', 'dade48', 'fbff13', 'b6ff05',  # Savanna/Grass 6-10\n    'c24f44', 'a5a5a5', 'ff6d4c', '69fff8', 'f9ffa4',  # Other 11-15\n    '1c0dff', 'ffffff'                                   # Barren/Unclass 16-17\n  )\n)\n\nMap$addLayer(lc_2023, lc_vis, \"IGBP Land Cover 2023\")\n\n\n2.1.4 Land Cover Validation and Uncertainty\nKnown Classification Issues:\n\nWoody Savanna vs. Open Forest: Confusion in transition zones\nGrassland vs. Cropland: Agricultural areas misclassified\nSeasonal Deciduous Forests: May shift between forest/savanna\nTemporal Lag: Land use changes not immediately reflected\n\nRegional Accuracy (Sulla-Menashe & Friedl, 2022):\n\n\n\n\n\n\n\n\nRegion\nOverall Accuracy\nForest Accuracy\nSavanna Accuracy\n\n\n\nAfrica\n73%\n68%\n78%\n\n\nSouth America\n77%\n82%\n71%\n\n\nEurope\n79%\n86%\n65%\n\n\nAsia\n74%\n75%\n73%\n\n\nNorth America\n81%\n88%\n74%",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-forest",
    "href": "02-veg-classes/index.html#sec-veg-forest",
    "title": "\n2  Burn Area\n",
    "section": "\n2.2 Forest Fire Classification",
    "text": "2.2 Forest Fire Classification\n\n2.2.1 Forest Type Identification\n\n# Define forest classes (IGBP 1-5)\nFOREST_CLASSES &lt;- c(1, 2, 3, 4, 5)\n\n# Function to extract forest mask\nextractForest &lt;- function(lc_image) {\n  lc &lt;- lc_image$select(\"LC_Type1\")\n  \n  # Create forest mask\n  forest_mask &lt;- lc$eq(1)$  # Evergreen Needleleaf\n    Or(lc$eq(2))$           # Evergreen Broadleaf\n    Or(lc$eq(3))$           # Deciduous Needleleaf\n    Or(lc$eq(4))$           # Deciduous Broadleaf\n    Or(lc$eq(5))            # Mixed Forests\n  \n  return(forest_mask$rename(\"forest_mask\"))\n}\n\n# Apply to land cover\nforest_mask_2023 &lt;- extractForest(lc_2023)\n\n# Overlay with burned area (from Chapter 1)\n# Assuming annual_burned_2023 is available from Chapter 1\nforest_fires_2023 &lt;- annual_burned_2023$\n  updateMask(forest_mask_2023)\n\n# Visualize\nMap$addLayer(\n  forest_fires_2023,\n  list(palette = \"red\"),\n  \"Forest Fires 2023\"\n)\n\n\n2.2.2 Humid Tropical Forest Delineation\n\n2.2.2.1 FAO-FRA Global Ecological Zones\nDataset: FAO-FRA Global Ecological Zones 2010 Update\nTropical Moist Zones (for Humid Tropical Forest):\n\nTropical rainforest\nTropical moist deciduous forest\nTropical mountain systems (in moist zones)\n\nImplementation:\n\n# Note: FAO-FRA zones not directly in GEE\n# Alternative 1: Use climate proxy (precipitation + temperature)\n# Alternative 2: Upload FAO zones as asset\n\n# METHOD 1: Climate-based proxy\n# Load WorldClim precipitation\nprecip &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio12\")  # Annual precip\n\n# Load temperature\ntemp &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio01\")  # Annual mean temp\n\n# Define tropical moist criteria (simplified)\n# Tropical: Mean annual temp &gt; 18°C\n# Moist: Annual precip &gt; 1500mm\ntropical &lt;- temp$gt(180)  # WorldClim temp in °C * 10\nmoist &lt;- precip$gt(1500)\n\nhumid_tropical_mask &lt;- tropical$And(moist)\n\n# Combine with forest mask\nhumid_tropical_forest &lt;- forest_mask_2023$And(humid_tropical_mask)\n\n# Other forest = all forests NOT in humid tropical zones\nother_forest &lt;- forest_mask_2023$And(humid_tropical_mask$Not())\n\n# Overlay with burned areas\nhtf_fires_2023 &lt;- annual_burned_2023$updateMask(humid_tropical_forest)\nother_fires_2023 &lt;- annual_burned_2023$updateMask(other_forest)\n\n# Visualize\nMap$addLayer(htf_fires_2023, list(palette = \"darkred\"), \"Humid Tropical Fires\")\nMap$addLayer(other_fires_2023, list(palette = \"orange\"), \"Other Forest Fires\")\n\n\n# If FAO-FRA zones uploaded as asset\n# (User would need to upload this manually)\n\n# Load FAO zones (example path)\nfao_zones &lt;- ee$FeatureCollection(\"users/your_username/FAO_FRA_EcoZones\")\n\n# Filter to tropical moist zones\ntropical_moist_zones &lt;- fao_zones$filter(\n  ee$Filter$inList(\"GEZ_NAME\", list(\n    \"Tropical rainforest\",\n    \"Tropical moist deciduous forest\",\n    \"Tropical mountain systems\"\n  ))\n)\n\n# Rasterize to match MODIS resolution\ntropical_moist_raster &lt;- tropical_moist_zones$\n  reduceToImage(\n    properties = list(\"GEZ_CODE\"),\n    reducer = ee$Reducer$first()\n  )$\n  reproject(crs = lc_2023$projection(), scale = 500)\n\n# Create mask\nhumid_tropical_mask_fao &lt;- tropical_moist_raster$gt(0)\n\n# Apply to forest fires\nhtf_fires_fao &lt;- annual_burned_2023$\n  updateMask(forest_mask_2023)$\n  updateMask(humid_tropical_mask_fao)\n\n\n2.2.3 Forest Fire Area Calculation\n\n# Define area of interest (from Chapter 1)\n# Assuming 'aoi' is defined (e.g., country boundary)\n\n# Function to calculate area\ncalculateForestFireArea &lt;- function(fire_image, mask, name) {\n  area_ha &lt;- fire_image$\n    updateMask(mask)$\n    multiply(ee$Image$pixelArea()$divide(10000))$\n    reduceRegion(\n      reducer = ee$Reducer$sum(),\n      geometry = aoi,\n      scale = 500,\n      maxPixels = 1e9\n    )\n  \n  return(ee$Feature(NULL, list(\n    fire_type = name,\n    area_ha = area_ha$get(\"burned\")\n  )))\n}\n\n# Calculate areas\nhtf_area &lt;- calculateForestFireArea(\n  annual_burned_2023, \n  humid_tropical_forest,\n  \"Humid Tropical Forest\"\n)\n\nother_forest_area &lt;- calculateForestFireArea(\n  annual_burned_2023,\n  other_forest,\n  \"Other Forest\"\n)\n\n# Combine results\nforest_fire_stats &lt;- ee$FeatureCollection(list(\n  htf_area,\n  other_forest_area\n))\n\n# Export or retrieve\nforest_results &lt;- ee_as_sf(forest_fire_stats) %&gt;%\n  st_drop_geometry() %&gt;%\n  as.data.frame()\n\nprint(forest_results)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-savanna",
    "href": "02-veg-classes/index.html#sec-veg-savanna",
    "title": "\n2  Burn Area\n",
    "section": "\n2.3 Savanna Fire Classification",
    "text": "2.3 Savanna Fire Classification\n\n2.3.1 Grassland and Woody Vegetation Types\n\n# Define savanna/grassland classes\nSAVANNA_CLASSES &lt;- list(\n  grassland = 10,\n  savanna = 9,\n  woody_savanna = 8,\n  open_shrubland = 7,\n  closed_shrubland = 6\n)\n\n# Extract each vegetation type\nextractSavannaType &lt;- function(lc_image, class_value, class_name) {\n  mask &lt;- lc_image$select(\"LC_Type1\")$eq(class_value)\n  return(mask$rename(class_name))\n}\n\n# Create masks for each type\ngrassland_mask &lt;- extractSavannaType(lc_2023, 10, \"grassland\")\nsavanna_mask &lt;- extractSavannaType(lc_2023, 9, \"savanna\")\nwoody_savanna_mask &lt;- extractSavannaType(lc_2023, 8, \"woody_savanna\")\nopen_shrub_mask &lt;- extractSavannaType(lc_2023, 7, \"open_shrubland\")\nclosed_shrub_mask &lt;- extractSavannaType(lc_2023, 6, \"closed_shrubland\")\n\n# Combined savanna mask (all types)\nsavanna_all_mask &lt;- grassland_mask$\n  Or(savanna_mask)$\n  Or(woody_savanna_mask)$\n  Or(open_shrub_mask)$\n  Or(closed_shrub_mask)\n\n# Overlay with burned areas\nsavanna_fires_2023 &lt;- annual_burned_2023$updateMask(savanna_all_mask)\n\n# Visualize\nMap$addLayer(\n  savanna_fires_2023,\n  list(palette = \"yellow\"),\n  \"Savanna Fires 2023\"\n)\n\n\n2.3.2 Climate Zone Stratification\nRationale: Fuel consumption varies by climate (IPCC Table 2.4)\nIPCC Climate Zones:\n\nBoreal (Cold)\nTemperate (Warm/Cool)\nTropical (Wet/Moist/Dry/Montane)\n\n\n# Load JRC Climate Zones (IPCC-based)\n# Note: May need to upload as asset if not in GEE catalog\n\n# Alternative: Use temperature/precipitation proxies\n# Load WorldClim data\nbio01 &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio01\")  # Annual mean temp\nbio12 &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio12\")  # Annual precip\n\n# Define climate zones (simplified)\n# Tropical: MAT &gt; 18°C\ntropical_zone &lt;- bio01$gt(180)\n\n# Boreal: MAT &lt; 0°C\nboreal_zone &lt;- bio01$lt(0)\n\n# Temperate: Everything else\ntemperate_zone &lt;- bio01$gte(0)$And(bio01$lte(180))\n\n# Apply to savanna fires\nsavanna_tropical &lt;- savanna_fires_2023$updateMask(tropical_zone)\nsavanna_temperate &lt;- savanna_fires_2023$updateMask(temperate_zone)\nsavanna_boreal &lt;- savanna_fires_2023$updateMask(boreal_zone)\n\n# Visualize climate-stratified fires\nMap$addLayer(savanna_tropical, list(palette = \"red\"), \"Tropical Savanna Fires\")\nMap$addLayer(savanna_temperate, list(palette = \"orange\"), \"Temperate Savanna Fires\")\nMap$addLayer(savanna_boreal, list(palette = \"blue\"), \"Boreal Savanna Fires\")\n\n\n2.3.3 Seasonal Burn Patterns\nImportance: Fuel consumption differs between early/late dry season (IPCC Table 2.4)\n\nEarly dry season: Lower fuel consumption (2.6 t ha⁻¹ savanna woodland)\nLate dry season: Higher fuel consumption (4.6 t ha⁻¹ savanna woodland)\n\n\n# Extract burn month from burn date\nextractBurnMonth &lt;- function(mcd64_image) {\n  burn_date &lt;- mcd64_image$select(\"BurnDate\")\n  \n  # Get image date (represents the month)\n  img_date &lt;- ee$Date(mcd64_image$get(\"system:time_start\"))\n  month &lt;- img_date$get(\"month\")\n  \n  # Create month band\n  month_band &lt;- ee$Image$constant(month)$\n    updateMask(burn_date$gt(0))$\n    rename(\"burn_month\")\n  \n  return(burn_date$addBands(month_band))\n}\n\n# Apply to monthly collection (from Chapter 1)\nmcd64_with_months &lt;- mcd64_faostat$  # From Chapter 1\n  filterDate(\"2023-01-01\", \"2023-12-31\")$\n  map(extractBurnMonth)\n\n# Extract months as separate images\nmonth_composite &lt;- mcd64_with_months$\n  select(\"burn_month\")$\n  max()  # Takes the latest month if pixel burned multiple times\n\n# Define seasons (example for Southern Hemisphere savanna)\n# Early dry season: May-July (months 5-7)\n# Late dry season: August-October (months 8-10)\n\nearly_season &lt;- month_composite$gte(5)$And(month_composite$lte(7))\nlate_season &lt;- month_composite$gte(8)$And(month_composite$lte(10))\n\n# Apply to savanna fires\nsavanna_early &lt;- savanna_fires_2023$updateMask(early_season)\nsavanna_late &lt;- savanna_fires_2023$updateMask(late_season)\n\n# Calculate areas\nearly_area &lt;- savanna_early$\n  multiply(ee$Image$pixelArea()$divide(10000))$\n  reduceRegion(reducer = ee$Reducer$sum(), geometry = aoi, scale = 500)\n\nlate_area &lt;- savanna_late$\n  multiply(ee$Image$pixelArea()$divide(10000))$\n  reduceRegion(reducer = ee$Reducer$sum(), geometry = aoi, scale = 500)\n\nprint(paste(\"Early season:\", early_area$getInfo()$burned, \"ha\"))\nprint(paste(\"Late season:\", late_area$getInfo()$burned, \"ha\"))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-organic",
    "href": "02-veg-classes/index.html#sec-veg-organic",
    "title": "\n2  Burn Area\n",
    "section": "\n2.4 Organic Soil Fire Classification",
    "text": "2.4 Organic Soil Fire Classification\n\n2.4.1 Histosols Identification\n\nDataset: Harmonized World Soil Database (HWSD v1.2)\nHistosols: Organic soils with &gt; 20-30% organic matter by weight\nDetection Challenge: Fires in organic soils independent of surface land cover\n\n\n# Note: HWSD not directly in GEE\n# Two approaches:\n# 1. Upload HWSD as asset\n# 2. Use existing peatland datasets in GEE\n\n# APPROACH 1: Using Global Peatland Dataset\n# (Example: Several peatland datasets exist in GEE catalog)\n\n# Search for peatland/wetland datasets\n# Example using a hypothetical peatland layer\n# Actual implementation depends on available datasets\n\n# For FAOSTAT methodology: Upload HWSD Histosols layer\n# (User action required)\n\n# APPROACH 2: Simplified proxy using permanent wetlands + tropical\nwetlands_mask &lt;- lc_2023$select(\"LC_Type1\")$eq(11)  # Permanent wetlands\n\n# Focus on Southeast Asia (where validated)\n# Define Southeast Asia bounding box\nsea_bbox &lt;- ee$Geometry$Rectangle([95, -10, 141, 20])\n\n# Peatland proxy: Wetlands in SE Asia lowlands\nelevation &lt;- ee$Image(\"USGS/SRTMGL1_003\")\nlowlands &lt;- elevation$lt(100)  # &lt; 100m elevation\n\norganic_soil_mask &lt;- wetlands_mask$\n  And(lowlands)$\n  clip(sea_bbox)\n\n# Overlay with burned areas\norganic_fires_2023 &lt;- annual_burned_2023$\n  updateMask(organic_soil_mask)\n\n# Visualize\nMap$addLayer(\n  organic_fires_2023,\n  list(palette = \"brown\"),\n  \"Organic Soil Fires 2023 (SE Asia)\"\n)\n\n\n2.4.2 Regional Constraints\nFAOSTAT approach (per methodology guide):\n\n“Due to the current lack of evidence for other regions of the world, we set to 0 all the country values outside Southeastern Asia.”\n\nSoutheast Asian Countries (non-zero organic soil fires):\n\nIndonesia\nMalaysia\nBrunei Darussalam\n(Potentially: Philippines, Thailand, Vietnam - check FAOSTAT regional definition)\n\n\n# Load country boundaries\ncountries &lt;- ee$FeatureCollection(\"FAO/GAUL/2015/level0\")\n\n# Define Southeast Asia countries\nSEA_COUNTRIES &lt;- c(\n  \"Indonesia\",\n  \"Malaysia\",\n  \"Brunei Darussalam\"\n  # Add others as per FAOSTAT definition\n)\n\n# Filter to SE Asia\nsea_countries &lt;- countries$filter(\n  ee$Filter$inList(\"ADM0_NAME\", SEA_COUNTRIES)\n)\n\n# Clip organic fires to SE Asia only\norganic_fires_sea &lt;- organic_fires_2023$clip(sea_countries)\n\n# All organic fires outside SE Asia = 0 (per FAOSTAT)\n# (Achieved by clipping to SE Asia only)\n\n# Calculate area\norganic_area_sea &lt;- organic_fires_sea$\n  multiply(ee$Image$pixelArea()$divide(10000))$\n  reduceRegions(\n    collection = sea_countries,\n    reducer = ee$Reducer$sum(),\n    scale = 500\n  )\n\n# Results\norganic_results &lt;- ee_as_sf(organic_area_sea) %&gt;%\n  st_drop_geometry() %&gt;%\n  select(ADM0_NAME, sum) %&gt;%\n  rename(country = ADM0_NAME, area_ha = sum)\n\nprint(organic_results)\n\n\n2.4.3 Uncertainty in Organic Soil Classification\nHigh uncertainty sources (IPCC 2014 Wetlands Supplement):\n\nDetection limitations:\n\n\nSmoldering fires difficult to detect via optical remote sensing\nDense canopy obscures ground fires\n\n\nSoil classification uncertainty:\n\n\nHWSD spatial resolution (~1km) coarser than fire detection (500m)\nOrganic soil depth variable within pixels\nDrainage status unknown (drained vs. undrained)\n\n\nFire depth uncertainty:\n\n\nSurface burn vs. deep peat burn\nFuel consumption highly variable: 41 ± 1.4 t ha⁻¹ (IPCC Table 2.6)\n\nFAOSTAT approach: Conservative reporting (SE Asia only) until more validation data available",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-validation",
    "href": "02-veg-classes/index.html#sec-veg-validation",
    "title": "\n2  Burn Area\n",
    "section": "\n2.5 Multi-Source Validation of Vegetation Classification",
    "text": "2.5 Multi-Source Validation of Vegetation Classification\n\n2.5.1 GLAD Forest Height for Forest/Non-Forest Validation\n\nlibrary(forestdata)\nlibrary(terra)\n\n# Download GLAD forest height (example: Portugal)\nglad_height &lt;- fd_forest_glad(\n  lon = -7.8,\n  lat = 42.7,\n  model = \"height\",\n  year = 2020\n)\n\n# Forest threshold: &gt; 5m height (per IPCC definition)\nglad_forest_mask &lt;- glad_height &gt; 5\n\n# Resample MODIS to GLAD resolution (30m) for comparison\n# (Or aggregate GLAD to MODIS 500m)\nglad_forest_500m &lt;- aggregate(\n  glad_forest_mask,\n  fact = round(500 / 30),  # ~17x aggregation\n  fun = mean  # Proportion of 30m pixels that are forest\n)\n\n# Export MODIS forest from GEE for comparison\nmodis_forest_mask_r &lt;- ee_as_rast(\n  forest_mask_2023,\n  region = ee$Geometry$Point(c(-7.8, 42.7))$buffer(50000),  # 50km radius\n  scale = 500\n)\n\n# Compare classifications\nlibrary(caret)\n# Ensure same extent and resolution\nglad_crop &lt;- crop(glad_forest_500m, modis_forest_mask_r)\nmodis_crop &lt;- crop(modis_forest_mask_r, glad_forest_500m)\n\n# Confusion matrix\nconfusion &lt;- confusionMatrix(\n  data = as.factor(as.vector(modis_crop &gt; 0)),\n  reference = as.factor(as.vector(glad_crop &gt; 0.5))  # &gt;50% forest in aggregated pixel\n)\n\nprint(confusion)\n\n# Kappa statistic\nprint(paste(\"Cohen's Kappa:\", round(confusion$overall[\"Kappa\"], 3)))\n\n\n2.5.2 ESRI Land Cover for High-Resolution Validation\n\nlibrary(forestdata)\n\n# Download ESRI land cover (10m resolution)\nesri_lc_2023 &lt;- fd_landcover_esri(utm_code = \"29N\", year = 2023)\n\n# ESRI legend (verify from documentation):\n# 1 = Water\n# 2 = Trees\n# 3 = Grass\n# 4 = Flooded Vegetation\n# 5 = Crops\n# 6 = Scrub/Shrub\n# 7 = Built Area\n# 8 = Bare Ground\n# 9 = Snow/Ice\n# 10 = Clouds\n\n# Extract forest (Trees class)\nesri_forest &lt;- esri_lc_2023 == 2\n\n# Extract savanna (Grass + Scrub/Shrub)\nesri_savanna &lt;- (esri_lc_2023 == 3) | (esri_lc_2023 == 6)\n\n# Aggregate to MODIS resolution\nesri_forest_500m &lt;- aggregate(\n  esri_forest,\n  fact = 50,  # 10m to 500m\n  fun = mean\n)\n\nesri_savanna_500m &lt;- aggregate(\n  esri_savanna,\n  fact = 50,\n  fun = mean\n)\n\n# Calculate agreement with MODIS\n# (Code similar to GLAD validation above)\n\n# Overlay with burned areas\n# Areas of disagreement may indicate:\n# - MODIS misclassification\n# - ESRI misclassification\n# - Actual mixed pixels (forest edge, mosaic)\n\n\n2.5.3 EU-Trees4F Species Distribution\n\nlibrary(forestdata)\n\n# Download species distribution for key European forest types\n# Example: Pinus pinaster (Maritime Pine) - fire-prone species\n\npinus_pinaster &lt;- fd_forest_eutrees4f(\n  species = \"Pinus pinaster\",\n  period = \"2005\",\n  type = \"prob\",\n  distrib = \"nat\"\n)\n\n# High probability areas should align with \"Other Forest\" classification\n# (Pinus pinaster = Evergreen Needleleaf in Portugal/Spain)\n\n# Overlay with MODIS forest fires\n# Expect fires in areas with:\n# - High Pinus pinaster probability\n# - MODIS Evergreen Needleleaf classification (class 1)\n# - Mediterranean climate zone\n\n# This validates:\n# 1. MODIS correctly classifies needleleaf forests\n# 2. These forests are burning (expected for fire-adapted species)\n# 3. Climate stratification is appropriate\n\n\n2.5.4 Chorological Maps for Forest Type Verification\n\nlibrary(forestdata)\nlibrary(sf)\n\n# Download chorological maps for dominant European tree species\nquercus_suber &lt;- fd_forest_chorological(\n  species = \"Quercus suber\",  # Cork Oak\n  range = \"nat\"\n)\n\npinus_pinaster &lt;- fd_forest_chorological(\n  species = \"Pinus pinaster\",  # Maritime Pine\n  range = \"nat\"\n)\n\n# Plot species ranges\nplot(quercus_suber$geometry, col = \"green\", main = \"Cork Oak Native Range\")\nplot(pinus_pinaster$geometry, col = \"blue\", add = TRUE)\n\n# Overlay with MODIS forest classification\n# Cork Oak (broadleaf evergreen) should align with IGBP class 2\n# Maritime Pine (needleleaf evergreen) should align with IGBP class 1\n\n# Extract MODIS classification within species ranges\n# (Requires converting MODIS to vector or resampling species to raster)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-workflow",
    "href": "02-veg-classes/index.html#sec-veg-workflow",
    "title": "\n2  Burn Area\n",
    "section": "\n2.6 Complete Vegetation Classification Workflow",
    "text": "2.6 Complete Vegetation Classification Workflow\n\n2.6.1 Integrated Processing Pipeline\n\n# ============================================================\n# IPCC Tier 1 Vegetation Classification Pipeline\n# Integrates: MCD64A1 + MCD12Q1 + FAO Zones + HWSD\n# ============================================================\n\nlibrary(rgee)\nlibrary(sf)\nlibrary(tidyverse)\n\nee_Initialize()\n\n# 1. LOAD INPUTS ----------------------------------------------\n# Burned area (from Chapter 1)\nyear &lt;- 2023\nmcd64 &lt;- ee$ImageCollection(\"MODIS/061/MCD64A1\")$\n  filterDate(paste0(year, \"-01-01\"), paste0(year, \"-12-31\"))\n\n# Land cover\nlc &lt;- ee$ImageCollection(\"MODIS/061/MCD12Q1\")$\n  filterDate(paste0(year, \"-01-01\"), paste0(year, \"-12-31\"))$\n  first()$\n  select(\"LC_Type1\")\n\n# Country boundary\ncountries &lt;- ee$FeatureCollection(\"FAO/GAUL/2015/level0\")\ncountry_name &lt;- \"Portugal\"\naoi &lt;- countries$filter(ee$Filter$eq(\"ADM0_NAME\", country_name))\n\n# 2. PROCESS BURNED AREA --------------------------------------\n# Quality filter and annual aggregation (from Chapter 1)\nfilterQuality &lt;- function(img) {\n  mask &lt;- img$select(\"Burn_Date_Uncertainty\")$lt(20)$\n    And(img$select(\"BurnDate\")$gt(0))\n  return(img$updateMask(mask))\n}\n\nannual_burn &lt;- mcd64$\n  map(filterQuality)$\n  select(\"BurnDate\")$\n  max()$\n  gt(0)$\n  selfMask()\n\n# 3. CLASSIFY VEGETATION TYPES --------------------------------\n\n# 3a. Forest Fires\nforest_mask &lt;- lc$gte(1)$And(lc$lte(5))\n\n# Humid Tropical Forest (using climate proxy)\ntemp &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio01\")\nprecip &lt;- ee$Image(\"WORLDCLIM/V1/BIO\")$select(\"bio12\")\nhumid_tropical &lt;- temp$gt(180)$And(precip$gt(1500))\n\nhtf_fires &lt;- annual_burn$\n  updateMask(forest_mask)$\n  updateMask(humid_tropical)\n\nother_forest_fires &lt;- annual_burn$\n  updateMask(forest_mask)$\n  updateMask(humid_tropical$Not())\n\n# 3b. Savanna Fires\nsavanna_mask &lt;- lc$gte(6)$And(lc$lte(10))\nsavanna_fires &lt;- annual_burn$updateMask(savanna_mask)\n\n# 3c. Organic Soil Fires (SE Asia only in FAOSTAT)\n# Skip if not in SE Asia, or implement if needed\n\n# 4. CALCULATE AREAS ------------------------------------------\ncalculateArea &lt;- function(image, name) {\n  area &lt;- image$\n    multiply(ee$Image$pixelArea()$divide(10000))$\n    reduceRegion(\n      reducer = ee$Reducer$sum(),\n      geometry = aoi,\n      scale = 500,\n      maxPixels = 1e9\n    )\n  \n  return(ee$Feature(NULL, list(\n    fire_type = name,\n    area_ha = area$get(\"burned\"),\n    year = year,\n    country = country_name\n  )))\n}\n\nresults &lt;- ee$FeatureCollection(list(\n  calculateArea(htf_fires, \"Humid_Tropical_Forest\"),\n  calculateArea(other_forest_fires, \"Other_Forest\"),\n  calculateArea(savanna_fires, \"Savanna\")\n))\n\n# 5. EXPORT RESULTS -------------------------------------------\nresults_df &lt;- ee_as_sf(results) %&gt;%\n  st_drop_geometry() %&gt;%\n  as.data.frame()\n\nprint(results_df)\n\n# Save to file\nwrite.csv(\n  results_df,\n  paste0(country_name, \"_VegetationClassification_\", year, \".csv\"),\n  row.names = FALSE\n)\n\n# 6. VISUALIZE ------------------------------------------------\nMap$centerObject(aoi, zoom = 7)\nMap$addLayer(htf_fires, list(palette = \"darkred\"), \"Humid Tropical Forest Fires\")\nMap$addLayer(other_forest_fires, list(palette = \"orange\"), \"Other Forest Fires\")\nMap$addLayer(savanna_fires, list(palette = \"yellow\"), \"Savanna Fires\")\n\n\n2.6.2 Output Format for Chapter 3\nRequired outputs for fuel biomass calculation (Chapter 3):",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-qc",
    "href": "02-veg-classes/index.html#sec-veg-qc",
    "title": "\n2  Burn Area\n",
    "section": "\n2.7 Quality Control and Uncertainty",
    "text": "2.7 Quality Control and Uncertainty\n\n2.7.1 Classification Uncertainty Assessment\nSources of uncertainty:\n\nLand cover classification error: ±10-15% (MCD12Q1 validation)\nBurned area overlay error: ±2-5% (geometric registration)\nEcological zone delineation: ±5-10% (climate proxy vs. official zones)\nTemporal mismatch: Land cover annual vs. monthly burns\n\nTotal uncertainty (quadrature): \\[\nU_{classification}^2 = U_{landcover}^2 + U_{overlay}^2 + U_{ecozone}^2\n\\]\nTypical result: ±15-20% uncertainty in vegetation type assignment\n\n2.7.2 QC Checklist\nPre-classification:\n\nBurned area and land cover from same year\nLand cover projection matches burned area\nAll forest classes (1-5) included in forest mask\nAll savanna classes (6-10) included in savanna mask\n\nClassification:\n\nMutually exclusive categories (no pixel in multiple categories)\nComplete coverage (all burned pixels classified)\nClimate zones applied correctly\nOrganic soils restricted to validated regions\n\nPost-classification:\n\nArea totals match Chapter 1 burned area\nNo negative or unrealistic values\nResults comparable to previous years (if available)\nValidation with independent data completed",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-summary",
    "href": "02-veg-classes/index.html#sec-veg-summary",
    "title": "\n2  Burn Area\n",
    "section": "\n2.8 Chapter Summary and Next Steps",
    "text": "2.8 Chapter Summary and Next Steps\n\n2.8.1 Key Takeaways\n\nMODIS MCD12Q1 IGBP classification provides globally consistent vegetation types\nThree IPCC fire categories: Forest (Humid Tropical + Other), Savanna, Organic Soils\nClimate stratification required for accurate fuel consumption assignment\nValidation using forestdata products (GLAD, ESRI, EU-Trees4F) reduces uncertainty\nUncertainty ~±15-20% in vegetation classification acceptable for Tier 1\n\n2.8.2 Progression to Chapter 3\nChapter 3: Fuel Biomass Consumption will use vegetation classifications to:\n\nAssign IPCC default fuel consumption values (Table 2.4) by vegetation type\nApply climate-dependent stratification\nCalculate total burned biomass: \\(A \\times M_B\\) (Activity Data × Fuel Biomass)\nPrepare for emission factor application (Chapter 4)\n\nCritical linkage: Each vegetation type carries forward:\n\nArea burned (hectares) by vegetation type\nClimate zone (for fuel consumption stratification)\nSeasonal information (early/late dry season for savannas)\nGeographic location (for validation and reporting)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "02-veg-classes/index.html#sec-veg-references",
    "href": "02-veg-classes/index.html#sec-veg-references",
    "title": "\n2  Burn Area\n",
    "section": "\n2.9 References",
    "text": "2.9 References\nFAO (2012). Global ecological zones for FAO forest reporting: 2010 Update. Forest Resources Assessment Working Paper 179. FAO, Rome, Italy.\nIPCC (2006). 2006 IPCC Guidelines for National Greenhouse Gas Inventories, Volume 4: Agriculture, Forestry and Other Land Use. IGES, Japan.\nIPCC (2014). 2013 Supplement to the 2006 IPCC Guidelines for National Greenhouse Gas Inventories: Wetlands. IPCC, Switzerland.\nLoveland, T.R., & Belward, A.S. (1997). The IGBP-DIS global 1km land cover data set, DISCover: First results. International Journal of Remote Sensing, 18(15), 3289-3295.\nSulla-Menashe, D., & Friedl, M.A. (2022). User Guide to Collection 6 MODIS Land Cover (MCD12Q1 and MCD12C1) Product. NASA LP DAAC.\n\n\n\n\n\n\nClimate Change, I. P. on. (2006). Chapter 2: Generic methodologies applicable to multiple land-use categories. Guidelines for national greenhouse gas inventories volume 4. Agriculture, forestry and other land use.\n\n\nSulla-Menashe, D., Friedl, M. A., et al. (2018). User guide to collection 6 MODIS land cover (MCD12Q1 and MCD12C1) product. Usgs: Reston, Va, Usa, 1, 18.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Burn Area</span>"
    ]
  },
  {
    "objectID": "references/index.html",
    "href": "references/index.html",
    "title": "Appendix A — References",
    "section": "",
    "text": "Andreae, M. O., & Merlet, P. (2001). Emission of trace gases and\naerosols from biomass burning. Global Biogeochemical Cycles,\n15(4), 955–966.\n\n\nClimate Change, I. P. on. (2006). Chapter 2: Generic methodologies\napplicable to multiple land-use categories. Guidelines for national\ngreenhouse gas inventories volume 4. Agriculture, forestry and other\nland use.\n\n\nEUROSTAT. (n.d.). Geographic information system of the european\ncommission.\n\n\nFAO, G. (2012). Global ecological zones for FAO forest reporting: 2010\nupdate. FAO: Rome, Italy.\n\n\nGiglio, L., Boschetti, L., Roy, D. P., Humber, M. L., & Justice, C.\nO. (2018). The collection 6 MODIS burned area mapping algorithm and\nproduct. Remote Sensing of Environment, 217, 72–85.\n\n\nGiglio, L., Hall, J. V., Humber, M., Argueta, F., Boschetti, L., &\nRoy, D. (2024). Collection 2 VIIRS burned area product user’s guide\nversion 1.1. NASA EOSDIS Land Processes Distributed Active Archive\nCenter. DOI: Https://Doi. Org/10.5067/VIIRS/VNP64A1, 2.\n\n\nGiglio, L., Randerson, J., Van der Werf, G., Kasibhatla, P., Collatz,\nG., Morton, D., & DeFries, R. (2010). Assessing variability and\nlong-term trends in burned area by merging multiple satellite fire\nproducts. Biogeosciences (Online), 7(3), 1171–1186.\n\n\nIPCC. (n.d.). 2013 revised supplementary methods and good practice\nguidance arising from the kyoto protocol.\n\n\nIPCC. (2006). Chapter 3: Consistent representation of lands. In 2006\nIPCC guidelines for national greenhouse gas inventories 3.1\n(Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental\nPanel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2006gl/pdf/4_Volume4/V4_03_Ch3_Representation.pdf\n\n\nIPCC. (2014). 2013 supplement to the 2006 IPCC guidelines for\nnational greenhouse gas inventories: Wetlands iii.\nIntergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/wetlands/pdf/Wetlands_Supplement_Entire_Report.pdf\n\n\nIPCC. (2019). Chapter 2: Generic methodologies applicable to multiple\nland-use categories. In 2019 refinement to the 2006 IPCC guidelines\nfor national greenhouse gas inventories (Agriculture, Forestry and\nOther Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf\n\n\nRossi, S., Tubiello, F. N., Prosperi, P., Salvatore, M., Jacobs, H.,\nBiancalani, R., House, J. I., & Boschetti, L. (2016). FAOSTAT\nestimates of greenhouse gas emissions from biomass and peat fires.\nClimatic Change, 135(3), 699–711.\n\n\nSulla-Menashe, D., Friedl, M. A., et al. (2018). User guide to\ncollection 6 MODIS land cover (MCD12Q1 and MCD12C1) product. Usgs:\nReston, Va, Usa, 1, 18.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>References</span>"
    ]
  }
]